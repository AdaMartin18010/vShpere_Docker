# æœºå¯†è®¡ç®—æŠ€æœ¯è¯¦è§£

## ğŸ“‹ ç›®å½•

- [æœºå¯†è®¡ç®—æŠ€æœ¯è¯¦è§£](#æœºå¯†è®¡ç®—æŠ€æœ¯è¯¦è§£)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [æ¦‚è¿°](#æ¦‚è¿°)
    - [ä»€ä¹ˆæ˜¯æœºå¯†è®¡ç®—](#ä»€ä¹ˆæ˜¯æœºå¯†è®¡ç®—)
    - [æ ¸å¿ƒä»·å€¼](#æ ¸å¿ƒä»·å€¼)
    - [æŠ€æœ¯æ ‡å‡†](#æŠ€æœ¯æ ‡å‡†)
  - [æ ¸å¿ƒæ¦‚å¿µ](#æ ¸å¿ƒæ¦‚å¿µ)
    - [å¯ä¿¡æ‰§è¡Œç¯å¢ƒ (TEE)](#å¯ä¿¡æ‰§è¡Œç¯å¢ƒ-tee)
    - [è¿œç¨‹è®¤è¯ (Remote Attestation)](#è¿œç¨‹è®¤è¯-remote-attestation)
    - [å†…å­˜åŠ å¯†](#å†…å­˜åŠ å¯†)
  - [Intel TDX](#intel-tdx)
    - [Trust Domain Extensionsæ¦‚è¿°](#trust-domain-extensionsæ¦‚è¿°)
    - [æ¶æ„è®¾è®¡](#æ¶æ„è®¾è®¡)
    - [TDXå·¥ä½œæµç¨‹](#tdxå·¥ä½œæµç¨‹)
    - [TDXæ€§èƒ½ä¼˜åŒ–](#tdxæ€§èƒ½ä¼˜åŒ–)
  - [AMD SEV-SNP](#amd-sev-snp)
    - [Secure Encrypted Virtualizationæ¦‚è¿°](#secure-encrypted-virtualizationæ¦‚è¿°)
    - [æ¶æ„è®¾è®¡1](#æ¶æ„è®¾è®¡1)
    - [SEV-SNPéƒ¨ç½²](#sev-snpéƒ¨ç½²)
    - [SEV-SNP vs TDXå¯¹æ¯”](#sev-snp-vs-tdxå¯¹æ¯”)
  - [æœºå¯†å®¹å™¨](#æœºå¯†å®¹å™¨)
    - [Confidential Containers (CoCo)æ¦‚è¿°](#confidential-containers-cocoæ¦‚è¿°)
    - [CoCoæ¶æ„](#cocoæ¶æ„)
    - [Kubernetesé›†æˆ](#kubernetesé›†æˆ)
    - [é•œåƒåŠ å¯†](#é•œåƒåŠ å¯†)
  - [åº”ç”¨åœºæ™¯](#åº”ç”¨åœºæ™¯)
    - [é‡‘èæœåŠ¡](#é‡‘èæœåŠ¡)
    - [åŒ»ç–—å¥åº·](#åŒ»ç–—å¥åº·)
    - [AI/ML](#aiml)
    - [äº‘åŸç”Ÿåº”ç”¨](#äº‘åŸç”Ÿåº”ç”¨)
  - [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)
    - [æ€§èƒ½ä¼˜åŒ–](#æ€§èƒ½ä¼˜åŒ–)
    - [å®‰å…¨åŠ å›º](#å®‰å…¨åŠ å›º)
    - [ç›‘æ§å’Œè°ƒè¯•](#ç›‘æ§å’Œè°ƒè¯•)
  - [å‚è€ƒèµ„æ–™](#å‚è€ƒèµ„æ–™)
    - [å®˜æ–¹æ–‡æ¡£](#å®˜æ–¹æ–‡æ¡£)
    - [æŠ€æœ¯åšå®¢](#æŠ€æœ¯åšå®¢)
    - [ç¤¾åŒºèµ„æº](#ç¤¾åŒºèµ„æº)
    - [æ ‡å‡†å’Œè§„èŒƒ](#æ ‡å‡†å’Œè§„èŒƒ)

---

## æ¦‚è¿°

### ä»€ä¹ˆæ˜¯æœºå¯†è®¡ç®—

æœºå¯†è®¡ç®—ï¼ˆConfidential Computingï¼‰æ˜¯ä¸€ç§é€šè¿‡ç¡¬ä»¶çº§åŠ å¯†ä¿æŠ¤ä½¿ç”¨ä¸­æ•°æ®ï¼ˆData-in-Useï¼‰çš„æŠ€æœ¯ã€‚
ä¸ä¼ ç»Ÿçš„é™æ€æ•°æ®åŠ å¯†ï¼ˆData-at-Restï¼‰å’Œä¼ è¾“æ•°æ®åŠ å¯†ï¼ˆData-in-Transitï¼‰ä¸åŒï¼Œæœºå¯†è®¡ç®—ç¡®ä¿æ•°æ®åœ¨å¤„ç†è¿‡ç¨‹ä¸­ä¹Ÿä¿æŒåŠ å¯†çŠ¶æ€ã€‚

### æ ¸å¿ƒä»·å€¼

**æ•°æ®å®‰å…¨ä¸‰æ€**:

- âœ… Data-at-Rest: å­˜å‚¨åŠ å¯† âœ“
- âœ… Data-in-Transit: ä¼ è¾“åŠ å¯† âœ“
- â­ Data-in-Use: **å¤„ç†åŠ å¯†** (æœºå¯†è®¡ç®—çš„æ ¸å¿ƒ)

**å…³é”®ä¼˜åŠ¿**:

- ğŸ” ç¡¬ä»¶çº§åŠ å¯†ä¿æŠ¤
- ğŸ›¡ï¸ é˜²æ­¢äº‘æä¾›å•†è®¿é—®
- ğŸ”’ éš”ç¦»æ•æ„Ÿå·¥ä½œè´Ÿè½½
- âœ… æ»¡è¶³åˆè§„è¦æ±‚
- ğŸŒ æ”¯æŒè·¨åŸŸæ•°æ®å…±äº«

### æŠ€æœ¯æ ‡å‡†

**æœºå¯†è®¡ç®—è”ç›Ÿ (CCC)**:

- æˆç«‹æ—¶é—´: 2019å¹´
- åˆ›å§‹æˆå‘˜: Intel, Microsoft, Google, IBM, é˜¿é‡Œå·´å·´ç­‰
- å®˜ç½‘: [confidentialcomputing.io](https://confidentialcomputing.io/)

---

## æ ¸å¿ƒæ¦‚å¿µ

### å¯ä¿¡æ‰§è¡Œç¯å¢ƒ (TEE)

**Trusted Execution Environment**:

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         åº”ç”¨ç¨‹åºå±‚                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  æ™®é€šåº”ç”¨     â”‚  â”‚  TEEåº”ç”¨    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         æ“ä½œç³»ç»Ÿå±‚                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  æ™®é€šOS      â”‚  â”‚  å®‰å…¨OS      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         ç¡¬ä»¶å±‚                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  æ™®é€šå†…å­˜     â”‚  â”‚  éš”ç¦»å†…å­˜   â”‚  â”‚
â”‚  â”‚  (æ˜æ–‡)      â”‚  â”‚  (åŠ å¯†)     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**TEEå…³é”®ç‰¹æ€§**:

- æ•°æ®éš”ç¦»: ç¡¬ä»¶çº§å†…å­˜åŠ å¯†
- ä»£ç éš”ç¦»: ç‹¬ç«‹æ‰§è¡Œç¯å¢ƒ
- è¿œç¨‹è®¤è¯: å¯éªŒè¯çš„æ‰§è¡Œè¯æ˜
- å¯†å°å­˜å‚¨: åŠ å¯†çš„æ•°æ®æŒä¹…åŒ–

### è¿œç¨‹è®¤è¯ (Remote Attestation)

**å·¥ä½œæµç¨‹**:

```mermaid
sequenceDiagram
    participant Client as å®¢æˆ·ç«¯
    participant TEE as TEEç¯å¢ƒ
    participant Verifier as éªŒè¯æœåŠ¡å™¨
    
    Client->>TEE: 1. è¯·æ±‚è®¤è¯
    TEE->>TEE: 2. ç”Ÿæˆåº¦é‡æŠ¥å‘Š
    TEE->>Verifier: 3. æäº¤åº¦é‡æŠ¥å‘Š
    Verifier->>Verifier: 4. éªŒè¯æŠ¥å‘Šç­¾å
    Verifier->>Client: 5. è¿”å›éªŒè¯ç»“æœ
    Client->>TEE: 6. å»ºç«‹å®‰å…¨é€šé“
```

**åº¦é‡å†…å®¹**:

- CPUå‹å·å’Œå›ºä»¶ç‰ˆæœ¬
- TEEè½¯ä»¶æ ˆç‰ˆæœ¬
- åº”ç”¨ç¨‹åºä»£ç å“ˆå¸Œ
- é…ç½®å‚æ•°
- å®‰å…¨çŠ¶æ€

### å†…å­˜åŠ å¯†

**åŠ å¯†æ¨¡å¼**:

| æŠ€æœ¯ | ç²’åº¦ | æ€§èƒ½å½±å“ | å®‰å…¨çº§åˆ« |
|------|------|---------|---------|
| **TME** (Total Memory Encryption) | å…¨ç³»ç»Ÿ | ~3-5% | åŸºç¡€ |
| **MKTME** (Multi-Key TME) | å¤šå¯†é’¥åŸŸ | ~5-8% | ä¸­çº§ |
| **TDX/SEV-SNP** | æ¯è™šæ‹Ÿæœº | ~8-15% | é«˜çº§ |

---

## Intel TDX

### Trust Domain Extensionsæ¦‚è¿°

**ç‰ˆæœ¬å†å²**:

- TDX 1.0: 2023å¹´Q4
- TDX 1.5: 2024å¹´Q2
- **TDX 2.0**: 2025å¹´Q1 (æœ€æ–°)

**æ ¸å¿ƒç‰¹æ€§**:

```yaml
æŠ€æœ¯è§„æ ¼:
  CPUè¦æ±‚: Intel Sapphire Rapids (ç¬¬4ä»£è‡³å¼º) æˆ–æ›´é«˜
  åŠ å¯†å¼•æ“: AES-XTS-128
  å¯†é’¥ç®¡ç†: æ¯TDç‹¬ç«‹å¯†é’¥
  æ€§èƒ½æŸå¤±: 8-12%
  
æ”¯æŒåŠŸèƒ½:
  - å®Œå…¨å†…å­˜åŠ å¯†
  - CPUçŠ¶æ€åŠ å¯†
  - I/Oæ•°æ®ä¿æŠ¤
  - è¿œç¨‹è®¤è¯
  - å®‰å…¨è¿ç§» (TDX 2.0æ–°å¢)
```

### æ¶æ„è®¾è®¡

**Trust Domainæ¶æ„**:

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Host VMM (Hypervisor)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  TD 1           â”‚  TD 2        â”‚  TD 3  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â” â”‚
â”‚ â”‚ App     â”‚     â”‚ â”‚ App      â”‚ â”‚ â”‚App â”‚ â”‚
â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ â”œâ”€â”€â”€â”€â”¤ â”‚
â”‚ â”‚ Guest OSâ”‚     â”‚ â”‚ Guest OS â”‚ â”‚ â”‚OS  â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         TDX Module (å›ºä»¶å±‚)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         Intel CPU (ç¡¬ä»¶åŠ å¯†)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ ¸å¿ƒç»„ä»¶**:

1. **TDX Module**:
   - è¿è¡Œåœ¨CPUçš„SEAMæ¨¡å¼
   - ç®¡ç†TDç”Ÿå‘½å‘¨æœŸ
   - å¤„ç†åŠ å¯†å’Œè§£å¯†
   - æä¾›è¿œç¨‹è®¤è¯æœåŠ¡

2. **Secure EPT (SEPT)**:
   - åŠ å¯†çš„é¡µè¡¨
   - é˜²æ­¢VMMçª¥æ¢
   - ç¡®ä¿å†…å­˜éš”ç¦»

3. **TDå¯†é’¥ç®¡ç†**:
   - æ¯ä¸ªTDç‹¬ç«‹å¯†é’¥
   - ç¡¬ä»¶éšæœºç”Ÿæˆ
   - å¯†é’¥ä¸ç¦»å¼€CPU

### TDXå·¥ä½œæµç¨‹

**VMå¯åŠ¨æµç¨‹**:

```bash
# 1. åˆ›å»ºTrust Domain
tdx-tool create-td \
  --cpus 4 \
  --memory 8G \
  --image ubuntu-22.04-confidential.qcow2

# 2. TDé…ç½®
tdx-tool configure-td \
  --td-id td-001 \
  --attestation-enabled \
  --secure-boot

# 3. å¯åŠ¨TD
tdx-tool start-td --td-id td-001

# 4. è·å–è®¤è¯æŠ¥å‘Š
tdx-tool get-quote --td-id td-001 --output quote.dat

# 5. éªŒè¯æŠ¥å‘Š
tdx-tool verify-quote --quote quote.dat --policy policy.json
```

### TDXæ€§èƒ½ä¼˜åŒ–

**ä¼˜åŒ–æŠ€å·§**:

```yaml
CPUé…ç½®:
  - å¯ç”¨ç¡¬ä»¶åŠ é€Ÿ: ç¡®ä¿BIOSä¸­TME/TDXå·²å¯ç”¨
  - CPUäº²å’Œæ€§: ç»‘å®šTDåˆ°ç‰¹å®šç‰©ç†æ ¸å¿ƒ
  - NUMAä¼˜åŒ–: TDå†…å­˜åˆ†é…åœ¨åŒä¸€NUMAèŠ‚ç‚¹

å†…å­˜ä¼˜åŒ–:
  - ä½¿ç”¨å¤§é¡µ: 2MBæˆ–1GBé¡µæå‡æ€§èƒ½
  - é¢„åˆ†é…å†…å­˜: é¿å…è¿è¡Œæ—¶åˆ†é…å¼€é”€
  - å‡å°‘å†…å­˜äº¤æ¢: ç¦ç”¨TDçš„swap

I/Oä¼˜åŒ–:
  - ä½¿ç”¨virtioè®¾å¤‡: å‡å°‘è™šæ‹ŸåŒ–å¼€é”€
  - SR-IOV: ç›´é€šç½‘å¡æå‡ç½‘ç»œæ€§èƒ½
  - æ‰¹é‡I/O: å‡å°‘VM exitæ¬¡æ•°
```

**æ€§èƒ½åŸºå‡†**:

```yaml
æµ‹è¯•ç¯å¢ƒ:
  CPU: Intel Xeon Platinum 8380 (Ice Lake)
  å†…å­˜: 256GB DDR4-3200
  OS: Ubuntu 22.04 + TDXæ”¯æŒ

åŸºå‡†æµ‹è¯•ç»“æœ:
  è®¡ç®—å¯†é›†å‹:
    åŠ å¯†å½±å“: 8-10%
    é€‚ç”¨åœºæ™¯: æ•°æ®åˆ†æã€AIæ¨ç†
  
  å†…å­˜å¯†é›†å‹:
    åŠ å¯†å½±å“: 10-15%
    é€‚ç”¨åœºæ™¯: æ•°æ®åº“ã€ç¼“å­˜
  
  I/Oå¯†é›†å‹:
    åŠ å¯†å½±å“: 5-8%
    é€‚ç”¨åœºæ™¯: WebæœåŠ¡ã€APIç½‘å…³
```

---

## AMD SEV-SNP

### Secure Encrypted Virtualizationæ¦‚è¿°

**ç‰ˆæœ¬æ¼”è¿›**:

- SEV: 2016å¹´ (å†…å­˜åŠ å¯†)
- SEV-ES: 2020å¹´ (+ CPUå¯„å­˜å™¨åŠ å¯†)
- **SEV-SNP**: 2022å¹´ (+ å®Œæ•´æ€§ä¿æŠ¤)

**SEV-SNPç‰¹æ€§**:

```yaml
æŠ€æœ¯è§„æ ¼:
  CPUè¦æ±‚: AMD EPYC Milan (ç¬¬3ä»£) æˆ–æ›´é«˜
  åŠ å¯†å¼•æ“: AES-128
  å®Œæ•´æ€§ä¿æŠ¤: VMPL (è™šæ‹Ÿæœºæƒé™çº§åˆ«)
  æ€§èƒ½æŸå¤±: 5-10%

å…³é”®èƒ½åŠ›:
  - å†…å­˜åŠ å¯†
  - å®Œæ•´æ€§ä¿æŠ¤ (é˜²å›æ»šæ”»å‡»)
  - è¿œç¨‹è®¤è¯
  - å®‰å…¨åµŒå¥—è™šæ‹ŸåŒ–
  - å®æ—¶è¿ç§»æ”¯æŒ
```

### æ¶æ„è®¾è®¡1

**SEV-SNPæ¶æ„**:

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Hypervisor (KVM)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  VM 1 (SEV-SNP)  â”‚  VM 2 (SEV-SNP)      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚ â”‚ VMPL0   â”‚      â”‚ â”‚ VMPL0    â”‚         â”‚
â”‚ â”‚ (Guest) â”‚      â”‚ â”‚ (Guest)  â”‚         â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         AMD PSP (Platform Security)     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         AMD EPYC CPU                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  SME (Secure Memory Encryption)â”‚     â”‚
â”‚  â”‚  + RMP (Reverse Map Table)     â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ ¸å¿ƒæœºåˆ¶**:

1. **Reverse Map Table (RMP)**:
   - è·Ÿè¸ªæ¯ä¸ªç‰©ç†é¡µçš„æ‰€æœ‰è€…
   - é˜²æ­¢Hypervisoré‡æ˜ å°„
   - ç¡¬ä»¶å¼ºåˆ¶æ‰§è¡Œ

2. **VMPL (VM Privilege Levels)**:

   ```text
   VMPL0: Guest OS (æœ€é«˜æƒé™)
   VMPL1: Guestå®‰å…¨æœåŠ¡
   VMPL2: ä¿ç•™
   VMPL3: Hypervisor (æœ€ä½æƒé™)
   ```

3. **å®Œæ•´æ€§ä¿æŠ¤**:
   - æ¯ä¸ªé¡µé¢æœ‰128ä½MACæ ‡ç­¾
   - é˜²æ­¢é‡æ”¾æ”»å‡»
   - é˜²æ­¢æ•°æ®ç¯¡æ”¹

### SEV-SNPéƒ¨ç½²

**QEMU/KVMé…ç½®**:

```xml
<!-- SEV-SNP VMé…ç½® -->
<domain type='kvm'>
  <name>sev-snp-vm</name>
  <memory unit='GiB'>8</memory>
  <vcpu>4</vcpu>
  
  <!-- SEV-SNPé…ç½® -->
  <launchSecurity type='sev'>
    <cbitpos>51</cbitpos>
    <reducedPhysBits>1</reducedPhysBits>
    <policy>0x0003</policy>
    <snp enabled='yes'/>
    <attestation>
      <enabled>yes</enabled>
      <report-server>https://attestation.example.com</report-server>
    </attestation>
  </launchSecurity>
  
  <devices>
    <disk type='file' device='disk'>
      <driver name='qemu' type='qcow2'/>
      <source file='/var/lib/libvirt/images/sev-snp.qcow2'/>
      <target dev='vda' bus='virtio'/>
    </disk>
    
    <interface type='network'>
      <source network='default'/>
      <model type='virtio'/>
    </interface>
  </devices>
</domain>
```

**å‘½ä»¤è¡Œå¯åŠ¨**:

```bash
# å¯åŠ¨SEV-SNP VM
qemu-system-x86_64 \
  -enable-kvm \
  -machine q35,confidential-guest-support=sev0 \
  -object sev-snp-guest,id=sev0,cbitpos=51,reduced-phys-bits=1 \
  -cpu EPYC-v4 \
  -smp 4 \
  -m 8G \
  -drive file=ubuntu-22.04-sev.qcow2,if=virtio \
  -netdev user,id=net0 \
  -device virtio-net-pci,netdev=net0 \
  -nographic

# è·å–è®¤è¯æŠ¥å‘Š
sev-guest-get-report \
  --output report.bin \
  --nonce $(openssl rand -hex 32)

# éªŒè¯æŠ¥å‘Š
sev-guest-verify-report \
  --report report.bin \
  --vcek-cert vcek.pem
```

### SEV-SNP vs TDXå¯¹æ¯”

| ç»´åº¦ | AMD SEV-SNP | Intel TDX |
|------|-------------|-----------|
| **CPUè¦æ±‚** | EPYC Milan+ | Sapphire Rapids+ |
| **åŠ å¯†ç²’åº¦** | æ¯VM | æ¯TD |
| **å®Œæ•´æ€§ä¿æŠ¤** | âœ… RMP + MAC | âœ… SEPT |
| **æ€§èƒ½å½±å“** | 5-10% | 8-12% |
| **åµŒå¥—è™šæ‹ŸåŒ–** | âœ… æ”¯æŒ | âš ï¸ æœ‰é™æ”¯æŒ |
| **å®æ—¶è¿ç§»** | âœ… æ”¯æŒ | ğŸš§ å¼€å‘ä¸­ |
| **ç”Ÿæ€æˆç†Ÿåº¦** | é«˜ (5å¹´+) | ä¸­ (2å¹´+) |
| **äº‘ä¾›åº”å•†** | Azure, GCP, AWS | Azure, Alibaba |

---

## æœºå¯†å®¹å™¨

### Confidential Containers (CoCo)æ¦‚è¿°

**é¡¹ç›®ä¿¡æ¯**:

- ç»„ç»‡: CNCF Sandbox Project
- åˆ›å»ºæ—¶é—´: 2021å¹´
- æœ€æ–°ç‰ˆæœ¬: v0.8.0 (2024å¹´Q4)
- GitHub: [github.com/confidential-containers](https://github.com/confidential-containers)

**æ¶æ„æ„¿æ™¯**:

```text
ä¼ ç»Ÿå®¹å™¨:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å®¹å™¨åº”ç”¨           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   å®¹å™¨è¿è¡Œæ—¶         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Host OS (å¯è§æ•°æ®) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

æœºå¯†å®¹å™¨:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å®¹å™¨åº”ç”¨           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Guest OS (TEEå†…)  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   å®¹å™¨è¿è¡Œæ—¶ (TEEå¤–) â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Host OS (æ•°æ®åŠ å¯†) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### CoCoæ¶æ„

**ç»„ä»¶æ¶æ„**:

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Kubernetesé›†ç¾¤                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Pod (æœºå¯†å®¹å™¨)                         â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚  â”‚
â”‚  â”‚  â”‚Container1â”‚  â”‚Container2â”‚           â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚  â”‚
â”‚  â”‚         â†“                              â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚  â”‚
â”‚  â”‚  â”‚  kata-runtime (shim)     â”‚         â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Kata Containers (TEEå†…)               â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  â”‚  Guest OS (åŠ å¯†)                â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  - containerd-shim-kata-v2    â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  - Agent                       â”‚   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚           Host OS + CRI-O/containerd         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚           TEE (TDX/SEV-SNP/SGX)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ ¸å¿ƒç»„ä»¶**:

1. **Kata Containers**:
   - è½»é‡çº§VMä½œä¸ºå®¹å™¨éš”ç¦»
   - æ”¯æŒTDX/SEV-SNP TEE
   - å…¼å®¹OCIæ ‡å‡†

2. **Attestation Service**:
   - è¿œç¨‹è®¤è¯éªŒè¯
   - ç­–ç•¥å¼•æ“
   - å¯†é’¥ç®¡ç†

3. **Image Security**:
   - é•œåƒåŠ å¯†
   - ç­¾åéªŒè¯
   - å®‰å…¨æ‹‰å–

### Kubernetesé›†æˆ

**éƒ¨ç½²CoCo**:

```yaml
# 1. å®‰è£…operator
kubectl apply -f https://raw.githubusercontent.com/confidential-containers/operator/main/config/release/operator.yaml

# 2. é…ç½®CoCoè¿è¡Œæ—¶
apiVersion: confidentialcontainers.org/v1beta1
kind: CcRuntime
metadata:
  name: ccruntime-sample
spec:
  runtimeName: kata
  ccNodeSelector:
    matchLabels:
      node.kubernetes.io/cc-capable: "true"
  config:
    teeType: tdx  # æˆ– sev, sgx
    attestation:
      enabled: true
      server: "https://attestation.example.com"
    imageEncryption:
      enabled: true
      kbs: "https://kbs.example.com"

# 3. åˆ›å»ºRuntimeClass
apiVersion: node.k8s.io/v1
kind: RuntimeClass
metadata:
  name: kata-cc
handler: kata
overhead:
  podFixed:
    memory: "256Mi"
    cpu: "250m"
scheduling:
  nodeSelector:
    node.kubernetes.io/cc-capable: "true"
```

**éƒ¨ç½²æœºå¯†Pod**:

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: confidential-nginx
  labels:
    app: nginx
    confidential: "true"
spec:
  runtimeClassName: kata-cc
  containers:
  - name: nginx
    image: docker.io/library/nginx:encrypted
    ports:
    - containerPort: 80
    env:
    - name: CC_IMAGE_KEY_PROVIDER
      value: "attestation-agent"
    resources:
      requests:
        memory: "512Mi"
        cpu: "500m"
      limits:
        memory: "1Gi"
        cpu: "1000m"
    securityContext:
      runAsNonRoot: true
      runAsUser: 101
  
  # è®¤è¯é…ç½®
  initContainers:
  - name: attestation-init
    image: ghcr.io/confidential-containers/attestation-agent:latest
    command: ["/bin/attestation-agent", "init"]
    volumeMounts:
    - name: attestation-data
      mountPath: /run/attestation
  
  volumes:
  - name: attestation-data
    emptyDir: {}
```

### é•œåƒåŠ å¯†

**åŠ å¯†å®¹å™¨é•œåƒ**:

```bash
# 1. ç”ŸæˆåŠ å¯†å¯†é’¥
openssl rand -out image-key.bin 32

# 2. åŠ å¯†é•œåƒ
skopeo copy \
  --encryption-key provider:attestation-agent:kbs:///default/image-key \
  docker://nginx:latest \
  docker://registry.example.com/nginx:encrypted

# 3. é…ç½®KBS (Key Broker Service)
cat <<EOF | kubectl apply -f -
apiVersion: v1
kind: Secret
metadata:
  name: image-encryption-key
  namespace: coco-system
type: Opaque
data:
  key: $(base64 -w0 image-key.bin)
EOF

# 4. éªŒè¯åŠ å¯†é•œåƒ
cosign verify \
  --key cosign.pub \
  registry.example.com/nginx:encrypted
```

---

## åº”ç”¨åœºæ™¯

### é‡‘èæœåŠ¡

**åœºæ™¯**: å¤šæ–¹æ•°æ®åˆ†æ

```yaml
éœ€æ±‚:
  - å¤šå®¶é“¶è¡Œå…±äº«å®¢æˆ·æ•°æ®è¿›è¡Œé£é™©åˆ†æ
  - æ•°æ®ä¸èƒ½è¢«äº‘æä¾›å•†è®¿é—®
  - éœ€è¦è¯æ˜è®¡ç®—ç¯å¢ƒå¯ä¿¡

è§£å†³æ–¹æ¡ˆ:
  - ä½¿ç”¨TDX/SEV-SNPåˆ›å»ºå¯ä¿¡è®¡ç®—ç¯å¢ƒ
  - è¿œç¨‹è®¤è¯ç¡®ä¿ç¯å¢ƒå®Œæ•´æ€§
  - åŠ å¯†æ•°æ®è¾“å…¥å’Œè¾“å‡º
  - å®¡è®¡æ—¥å¿—ä¸å¯ç¯¡æ”¹

æŠ€æœ¯æ ˆ:
  - TEE: Intel TDX
  - ç¼–æ’: Kubernetes + CoCo
  - è®¤è¯: Intel Attestation Service
  - åŠ å¯†: AES-256-GCM
```

### åŒ»ç–—å¥åº·

**åœºæ™¯**: åŸºå› æ•°æ®åˆ†æ

```yaml
éœ€æ±‚:
  - æ•æ„ŸåŸºå› æ•°æ®å¤„ç†
  - ç¬¦åˆHIPAA/GDPRåˆè§„
  - é˜²æ­¢æ•°æ®æ³„éœ²

è§£å†³æ–¹æ¡ˆ:
  - SEV-SNP VMè¿è¡Œåˆ†æå·¥ä½œè´Ÿè½½
  - åŠ å¯†å­˜å‚¨å’Œä¼ è¾“
  - è®¿é—®æ§åˆ¶å’Œå®¡è®¡
  - å®šæœŸè®¤è¯æ£€æŸ¥

æŠ€æœ¯æ ˆ:
  - TEE: AMD SEV-SNP
  - å¹³å°: Azure Confidential VM
  - æ•°æ®åº“: Encrypted PostgreSQL
  - åˆ†æ: Encrypted Spark
```

### AI/ML

**åœºæ™¯**: æ¨¡å‹è®­ç»ƒå’Œæ¨ç†

```yaml
éœ€æ±‚:
  - ä¿æŠ¤è®­ç»ƒæ•°æ®éšç§
  - ä¿æŠ¤æ¨¡å‹IP
  - éªŒè¯æ¨¡å‹å®Œæ•´æ€§

è§£å†³æ–¹æ¡ˆ:
  - æœºå¯†å®¹å™¨è¿è¡Œè®­ç»ƒä»»åŠ¡
  - GPUè™šæ‹ŸåŒ– + TEE
  - æ¨¡å‹åŠ å¯†å­˜å‚¨
  - æ¨ç†ç»“æœå¯éªŒè¯

æŠ€æœ¯æ ˆ:
  - TEE: Intel TDX
  - GPU: NVIDIA H100 + CCæ”¯æŒ
  - æ¡†æ¶: TensorFlow + Confidential Computing
  - ç¼–æ’: Kubernetes + CoCo
```

### äº‘åŸç”Ÿåº”ç”¨

**åœºæ™¯**: å¤šç§Ÿæˆ·SaaSå¹³å°

```yaml
éœ€æ±‚:
  - ç§Ÿæˆ·æ•°æ®å¼ºéš”ç¦»
  - é˜²æ­¢è·¨ç§Ÿæˆ·æ”»å‡»
  - åˆè§„å®¡è®¡

è§£å†³æ–¹æ¡ˆ:
  - æ¯ç§Ÿæˆ·ç‹¬ç«‹TEE
  - æœºå¯†å®¹å™¨éƒ¨ç½²åº”ç”¨
  - é›¶ä¿¡ä»»ç½‘ç»œ
  - æŒç»­è®¤è¯

æŠ€æœ¯æ ˆ:
  - TEE: TDX/SEV-SNPæ··åˆ
  - å®¹å™¨: CoCo + Kata
  - æœåŠ¡ç½‘æ ¼: Istio + mTLS
  - ç›‘æ§: Prometheus + åŠ å¯†æŒ‡æ ‡
```

---

## æœ€ä½³å®è·µ

### æ€§èƒ½ä¼˜åŒ–

**1. é€‰æ‹©åˆé€‚çš„TEEç±»å‹**:

```yaml
å·¥ä½œè´Ÿè½½ç‰¹å¾åŒ¹é…:
  è®¡ç®—å¯†é›†å‹:
    - ä¼˜é€‰: Intel TDX
    - åŸå› : æ›´å¥½çš„CPUæ€§èƒ½
  
  å†…å­˜å¯†é›†å‹:
    - ä¼˜é€‰: AMD SEV-SNP
    - åŸå› : æ›´ä½çš„å†…å­˜åŠ å¯†å¼€é”€
  
  I/Oå¯†é›†å‹:
    - ä¼˜é€‰: AMD SEV-SNP
    - åŸå› : æ›´æˆç†Ÿçš„I/Oè™šæ‹ŸåŒ–
  
  GPUåŠ é€Ÿ:
    - ä¼˜é€‰: Intel TDX + NVIDIA CC
    - åŸå› : æ›´å¥½çš„GPUè™šæ‹ŸåŒ–æ”¯æŒ
```

**2. èµ„æºé…ç½®ä¼˜åŒ–**:

```yaml
CPUé…ç½®:
  # é¿å…è¿‡åº¦è®¢é˜…
  vcpus_per_physical_cpu: 1-2
  # CPUäº²å’Œæ€§
  cpu_pinning: true
  # NUMAå¯¹é½
  numa_aware: true

å†…å­˜é…ç½®:
  # ä½¿ç”¨å¤§é¡µ
  huge_pages: 2MBæˆ–1GB
  # é¢„åˆ†é…å†…å­˜
  prealloc: true
  # ç¦ç”¨å†…å­˜æ°”çƒ
  balloon: false

å­˜å‚¨é…ç½®:
  # ä½¿ç”¨virtio-blk
  disk_driver: virtio-blk
  # å¯ç”¨direct I/O
  cache: none
  direct_io: true
```

**3. å‡å°‘VM Exit**:

```yaml
ä¼˜åŒ–æªæ–½:
  - ä½¿ç”¨virtioåŠè™šæ‹ŸåŒ–è®¾å¤‡
  - æ‰¹é‡I/Oæ“ä½œ
  - ç¦ç”¨ä¸å¿…è¦çš„è™šæ‹ŸåŒ–ç‰¹æ€§
  - ä½¿ç”¨SR-IOVç›´é€š

ç›‘æ§VM Exit:
  perf kvm stat live
```

### å®‰å…¨åŠ å›º

**1. è®¤è¯ç­–ç•¥**:

```json
{
  "version": "1.0",
  "attestation_policy": {
    "tee_type": "tdx",
    "min_tcb_level": {
      "sgx_tcb": "0xFFFFFFFFFFFFFFFF",
      "tdx_tcb": "0x03000000"
    },
    "allowed_measurements": [
      "sha384:abcd1234...",
      "sha384:efgh5678..."
    ],
    "enforce_debug_disabled": true,
    "require_secure_boot": true
  },
  "runtime_policy": {
    "max_memory": "16GB",
    "max_cpus": 8,
    "allowed_devices": ["virtio-net", "virtio-blk"],
    "network_policy": {
      "allow_egress": ["10.0.0.0/8"],
      "deny_egress": ["0.0.0.0/0"]
    }
  }
}
```

**2. å¯†é’¥ç®¡ç†**:

```yaml
Key Broker Service (KBS)é…ç½®:
  backend: HashiCorp Vault
  
  key_hierarchy:
    root_key:
      type: HSM-backed
      rotation: 90å¤©
    
    image_keys:
      type: AES-256-GCM
      per_image: true
      rotation: 30å¤©
    
    attestation_keys:
      type: ECDSA P-384
      per_workload: true
      ephemeral: true

  access_control:
    authentication:
      - method: attestation-based
        require: valid_quote
      - method: OIDC
        provider: https://oidc.example.com
    
    authorization:
      - resource: image_keys/*
        action: read
        condition: attestation.tcb_level >= required_level
```

**3. ç½‘ç»œéš”ç¦»**:

```yaml
# Kubernetes NetworkPolicy
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: cc-workload-isolation
spec:
  podSelector:
    matchLabels:
      confidential: "true"
  policyTypes:
  - Ingress
  - Egress
  ingress:
  - from:
    - podSelector:
        matchLabels:
          access: "allowed"
    ports:
    - protocol: TCP
      port: 443
  egress:
  - to:
    - podSelector:
        matchLabels:
          type: "kbs"
    ports:
    - protocol: TCP
      port: 8080
  - to:
    - namespaceSelector:
        matchLabels:
          name: attestation-service
    ports:
    - protocol: TCP
      port: 443
```

### ç›‘æ§å’Œè°ƒè¯•

**1. æ€§èƒ½ç›‘æ§**:

```yaml
# PrometheusæŒ‡æ ‡
metrics:
  - tee_vm_creation_duration_seconds
  - tee_attestation_duration_seconds
  - tee_memory_encrypted_bytes
  - tee_vm_exit_count
  - tee_cpu_utilization_percent

# Grafanaä»ªè¡¨æ¿
dashboard:
  panels:
    - TEE VMæ€§èƒ½
    - è®¤è¯æˆåŠŸç‡
    - åŠ å¯†å¼€é”€
    - èµ„æºåˆ©ç”¨ç‡
```

**2. æ—¥å¿—å®¡è®¡**:

```yaml
æ—¥å¿—æ”¶é›†:
  - è®¤è¯äº‹ä»¶
  - å¯†é’¥è®¿é—®
  - VMç”Ÿå‘½å‘¨æœŸ
  - å®‰å…¨å‘Šè­¦

æ—¥å¿—å­˜å‚¨:
  backend: Encrypted Elasticsearch
  retention: 90å¤©
  integrity: SHA-256å“ˆå¸Œé“¾

å‘Šè­¦è§„åˆ™:
  - è®¤è¯å¤±è´¥ > 5æ¬¡/åˆ†é’Ÿ
  - æœªæˆæƒå¯†é’¥è®¿é—®
  - TEEå®Œæ•´æ€§æ£€æŸ¥å¤±è´¥
  - å¼‚å¸¸ç½‘ç»œæµé‡
```

**3. è°ƒè¯•å·¥å…·**:

```bash
# TDXè°ƒè¯•
tdx-tool debug --td-id td-001
  --dump-memory
  --trace-vm-exits

# SEV-SNPè°ƒè¯•
sevtool --platform-status
sevtool --guest-status --vm-id vm-123

# CoCoè°ƒè¯•
kubectl logs -n coco-system kata-runtime-xxxxx
kubectl describe ccruntime ccruntime-sample
```

---

## å‚è€ƒèµ„æ–™

### å®˜æ–¹æ–‡æ¡£

**Intel TDX**:

- [Intel TDX Whitepaper](https://www.intel.com/content/www/us/en/developer/articles/technical/intel-trust-domain-extensions.html)
- [TDX Virtual Firmware Design Guide](https://software.intel.com/content/www/us/en/develop/download/intel-tdx-virtual-firmware-design-guide.html)
- [TDX Module Specification](https://www.intel.com/content/www/us/en/developer/articles/technical/intel-trust-domain-extensions.html)

**AMD SEV-SNP**:

- [AMD SEV-SNP Whitepaper](https://www.amd.com/system/files/TechDocs/SEV-SNP-strengthening-vm-isolation-with-integrity-protection-and-more.pdf)
- [SEV-SNP API Specification](https://www.amd.com/system/files/TechDocs/56860.pdf)
- [SEV-SNP Firmware ABI Specification](https://www.amd.com/system/files/TechDocs/56421.pdf)

**Confidential Computing Consortium**:

- [CCC Homepage](https://confidentialcomputing.io/)
- [CCC GitHub](https://github.com/confidential-computing)
- [Technical Analysis of Confidential Computing](https://confidentialcomputing.io/wp-content/uploads/sites/85/2021/03/confidentialcomputing_outreach_whitepaper-8-5x11-1.pdf)

**Confidential Containers**:

- [CoCo GitHub](https://github.com/confidential-containers)
- [CoCo Documentation](https://confidentialcontainers.org/)
- [CoCo Architecture](https://github.com/confidential-containers/documentation/blob/main/architecture.md)

### æŠ€æœ¯åšå®¢

- [Microsoft Azure Confidential Computing](https://azure.microsoft.com/en-us/solutions/confidential-compute/)
- [Google Cloud Confidential VMs](https://cloud.google.com/confidential-computing)
- [Red Hat: Confidential Containers](https://www.redhat.com/en/blog/confidential-containers)
- [IBM: Confidential Computing Explained](https://www.ibm.com/cloud/learn/confidential-computing)

### ç¤¾åŒºèµ„æº

- [CNCF Confidential Containers WG](https://github.com/cncf/tag-security/tree/main/supply-chain-security/compromises)
- [Kata Containers Community](https://katacontainers.io/)
- [OpenStack with Confidential Computing](https://wiki.openstack.org/wiki/Confidential_Computing)

### æ ‡å‡†å’Œè§„èŒƒ

- [TCG DICE (Device Identifier Composition Engine)](https://trustedcomputinggroup.org/work-groups/dice-architectures/)
- [IETF RATS (Remote ATtestation procedureS)](https://datatracker.ietf.org/wg/rats/about/)
- [ISO/IEC 11889 (TPM Specification)](https://www.iso.org/standard/66510.html)

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2025-10-19  
**ç»´æŠ¤è€…**: è™šæ‹ŸåŒ–å®¹å™¨åŒ–æŠ€æœ¯çŸ¥è¯†åº“é¡¹ç›®ç»„

**ä¸‹ä¸€æ­¥é˜…è¯»**:

- [02_æœºå¯†è®¡ç®—å®è·µæŒ‡å—](./02_æœºå¯†è®¡ç®—å®è·µæŒ‡å—.md)
- [03_æœºå¯†è®¡ç®—æ€§èƒ½è°ƒä¼˜](./03_æœºå¯†è®¡ç®—æ€§èƒ½è°ƒä¼˜.md)
- [04_æœºå¯†è®¡ç®—å®‰å…¨æœ€ä½³å®è·µ](./04_æœºå¯†è®¡ç®—å®‰å…¨æœ€ä½³å®è·µ.md)
