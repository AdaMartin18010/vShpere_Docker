# 容器故障诊断速查表

## 目录

- [容器故障诊断速查表](#容器故障诊断速查表)
  - [目录](#目录)
  - [1. 事件-原因-处置对照表](#1-事件-原因-处置对照表)
  - [2. 通用排障 SOP](#2-通用排障-sop)
  - [3. 风险提示与最佳实践](#3-风险提示与最佳实践)

## 1. 事件-原因-处置对照表

| 事件/症状 | 常见原因 | 定位要点 | 处置建议 |
|---|---|---|---|
| 容器启动失败 | 镜像缺失/拉取失败、入口命令错误、权限不足 | `docker/podman logs`、`inspect`、镜像仓库可达性 | 修正镜像引用/凭证；校对入口命令与权限 |
| 重启频繁 | 健康检查失败、依赖不可达、资源不足 | 探针配置、下游可达、`stats`/cgroups 限额 | 调整探针阈值；补足依赖；修正 limits |
| CPU/内存飙升 | 资源泄漏、限额不当、突发流量 | 指标趋势、pprof/heap、HPA 策略 | 修复应用问题；调优资源与 HPA |
| 网络超时/5xx | 防火墙/策略、端口冲突、DNS 问题 | NetworkPolicy/iptables、端口占用、DNS 解析 | 放通策略；规避冲突；修复解析与缓存 |
| I/O 延迟高 | 存储驱动/底盘性能、跨 FS 绑定 | 驱动类型、`dmesg`、卷与路径检查 | 优选卷；避免跨 FS；容量与性能扩展 |

## 2. 通用排障 SOP

1) 收集上下文：事件与时间线、版本、近变更。
2) 复现场景：最小化重现与隔离变量。
3) 三视角排查：计算（CPU/内存）、网络（连通/延迟/策略）、存储（IOPS/延迟/容量）。
4) 变更控制：小步快跑、可回滚；记录证据。

## 3. 风险提示与最佳实践

- 风险：生产环境直接操作；请先在预发验证并备份关键数据。
- 最佳实践：落地 Runbook；建立“告警→事件→处置”闭环与复盘机制。
