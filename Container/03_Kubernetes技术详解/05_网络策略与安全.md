# 网络策略与安全

## 目录

- [网络策略与安全](#网络策略与安全)
  - [目录](#目录)
  - [1. NetworkPolicy 模型](#1-networkpolicy-模型)
  - [2. CNI 与策略实现差异](#2-cni-与策略实现差异)
  - [3. Pod/节点安全基线](#3-pod节点安全基线)
  - [4. 服务暴露与零信任](#4-服务暴露与零信任)
  - [5. 实践要点与 FAQ](#5-实践要点与-faq)
  - [6. 故障清单与排查](#6-故障清单与排查)
  - [7. 示例 YAML 与 SOP](#7-示例-yaml-与-sop)
  - [8. 证据留存对接 Artifacts（新增）](#8-证据留存对接-artifacts新增)
  - [相关文档](#相关文档)
    - [本模块相关](#本模块相关)
    - [其他模块相关](#其他模块相关)

## 1. NetworkPolicy 模型

- 选择器、入站/出站规则、命名空间隔离

## 2. CNI 与策略实现差异

- Calico/Cilium/Weave 等策略能力差异

## 3. Pod/节点安全基线

- 安全上下文、特权与能力控制、内核防护

## 4. 服务暴露与零信任

- Ingress/Gateway 与策略协同、mTLS、策略编排

## 5. 实践要点与 FAQ

- 常见策略样例与排障

（待补充：参考拓扑与对比矩阵）

## 6. 故障清单与排查

- 策略导致服务中断：逐步放开命名空间/选择器，启用观测与日志。
- CNI 策略不生效：确认实现差异与版本，核对 CRDs/控制器。
- 东西向 mTLS 问题：证书与信任域、SNI 与策略匹配。

## 7. 示例 YAML 与 SOP

```yaml
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: allow-web-egress-dns
  namespace: default
spec:
  podSelector:
    matchLabels:
      app: web
  policyTypes: [Egress]
  egress:
  - to:
    - namespaceSelector: {}
    ports:
    - protocol: UDP
      port: 53
```

## 8. 证据留存对接 Artifacts（新增）

- 留存目标：NetworkPolicy/PSA/Runtime 审计、事件与变更证据，支撑合规与回溯。
- 目录建议：见 `vShpere_VMware/09_安全与合规管理/Artifacts_Index.md` 中“Kubernetes 合规证据模板”。
- 最小清单：
  - `cluster/manifests/*.yaml`（RBAC/Quota/NetworkPolicy/PSA 基线）
  - `runtime/audit/audit-*.json`（apiserver 审计日志）
  - `runtime/policies/*.yaml`（NetworkPolicy/PodSecurity 等）
  - `cis/cis-benchmark-report.json`（CIS 基线结果）
- 标准锚点：版本与标准请参见《2025年技术标准最终对齐报告.md》；变更时仅更新该报告。

SOP：

- 校验策略命中：抓包/观察 DNS 解析、查看 CNI 控制器日志。
- 回滚策略：保留宽松基线策略，渐进式收紧。

---

## 相关文档

### 本模块相关

- [Kubernetes架构原理](./01_Kubernetes架构原理.md) - Kubernetes架构深度解析
- [Pod管理技术](./02_Pod管理技术.md) - Pod管理技术详解
- [服务发现与负载均衡](./03_服务发现与负载均衡.md) - 服务发现与负载均衡详解
- [存储管理技术](./04_存储管理技术.md) - 存储管理技术详解
- [监控与日志管理](./06_监控与日志管理.md) - 监控与日志管理详解
- [README.md](./README.md) - 本模块导航

### 其他模块相关

- [容器网络安全](../05_容器安全技术/05_容器网络安全.md) - 容器网络安全
- [Docker网络技术](../01_Docker技术详解/04_Docker网络技术.md) - Docker网络技术
- [容器编排技术](../04_容器编排技术/README.md) - 容器编排网络

---

**最后更新**: 2025年11月11日
**维护状态**: 持续更新
