# 网络策略与安全

## 目录

- [网络策略与安全](#网络策略与安全)
  - [1. NetworkPolicy 模型](#1-networkpolicy-模型)
  - [2. CNI 与策略实现差异](#2-cni-与策略实现差异)
  - [3. Pod/节点安全基线](#3-pod节点安全基线)
  - [4. 服务暴露与零信任](#4-服务暴露与零信任)
  - [5. 实践要点与 FAQ](#5-实践要点与-faq)
  - [6. 故障清单与排查](#6-故障清单与排查)
  - [7. 示例 YAML 与 SOP](#7-示例-yaml-与-sop)

- [网络策略与安全](#网络策略与安全)
  - [1. NetworkPolicy 模型](#1-networkpolicy-模型)
  - [2. CNI 与策略实现差异](#2-cni-与策略实现差异)
  - [3. Pod/节点安全基线](#3-pod节点安全基线)
  - [4. 服务暴露与零信任](#4-服务暴露与零信任)
  - [5. 实践要点与 FAQ](#5-实践要点与-faq)
  - [6. 故障清单与排查](#6-故障清单与排查)
  - [7. 示例 YAML 与 SOP](#7-示例-yaml-与-sop)

- [网络策略与安全](#网络策略与安全)
  - [目录](#目录)
  - [1. NetworkPolicy 模型](#1-networkpolicy-模型)
  - [2. CNI 与策略实现差异](#2-cni-与策略实现差异)
  - [3. Pod/节点安全基线](#3-pod节点安全基线)
  - [4. 服务暴露与零信任](#4-服务暴露与零信任)
  - [5. 实践要点与 FAQ](#5-实践要点与-faq)
  - [6. 故障清单与排查](#6-故障清单与排查)
  - [7. 示例 YAML 与 SOP](#7-示例-yaml-与-sop)

## 1. NetworkPolicy 模型

- 选择器、入站/出站规则、命名空间隔离

## 2. CNI 与策略实现差异

- Calico/Cilium/Weave 等策略能力差异

## 3. Pod/节点安全基线

- 安全上下文、特权与能力控制、内核防护

## 4. 服务暴露与零信任

- Ingress/Gateway 与策略协同、mTLS、策略编排

## 5. 实践要点与 FAQ

- 常见策略样例与排障

（待补充：参考拓扑与对比矩阵）

## 6. 故障清单与排查

- 策略导致服务中断：逐步放开命名空间/选择器，启用观测与日志。
- CNI 策略不生效：确认实现差异与版本，核对 CRDs/控制器。
- 东西向 mTLS 问题：证书与信任域、SNI 与策略匹配。

## 7. 示例 YAML 与 SOP

```yaml
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: allow-web-egress-dns
  namespace: default
spec:
  podSelector:
    matchLabels:
      app: web
  policyTypes: [Egress]
  egress:
  - to:
    - namespaceSelector: {}
    ports:
    - protocol: UDP
      port: 53
```

SOP：

- 校验策略命中：抓包/观察 DNS 解析、查看 CNI 控制器日志。
- 回滚策略：保留宽松基线策略，渐进式收紧。
