# 04_å®¹å™¨å®‰å…¨æœ€ä½³å®è·µ

**æ—¥æœŸ**: 2025å¹´10æœˆ20æ—¥  
**ç‰ˆæœ¬**: v1.0  
**çŠ¶æ€**: âœ… å®Œæˆ

---

## ç›®å½•

- [å®¹å™¨å®‰å…¨æ¦‚è¿°](#å®¹å™¨å®‰å…¨æ¦‚è¿°)
- [é•œåƒå®‰å…¨](#é•œåƒå®‰å…¨)
- [è¿è¡Œæ—¶å®‰å…¨](#è¿è¡Œæ—¶å®‰å…¨)
- [å®¹å™¨éš”ç¦»](#å®¹å™¨éš”ç¦»)
- [Secretsç®¡ç†](#secretsç®¡ç†)
- [ç½‘ç»œå®‰å…¨](#ç½‘ç»œå®‰å…¨)
- [å®‰å…¨ç›‘æ§](#å®‰å…¨ç›‘æ§)
- [åˆè§„æ€§](#åˆè§„æ€§)
- [å®æˆ˜å·¥å…·](#å®æˆ˜å·¥å…·)
- [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)
- [å‚è€ƒèµ„æ–™](#å‚è€ƒèµ„æ–™)

---

## å®¹å™¨å®‰å…¨æ¦‚è¿°

### å®¹å™¨å®‰å…¨å¨èƒæ¨¡å‹

```yaml
å®¹å™¨å®‰å…¨æŒ‘æˆ˜:
  
  1. é•œåƒå±‚é¢:
     - æ¶æ„é•œåƒ
     - å·²çŸ¥æ¼æ´
     - æ¶æ„è½¯ä»¶
     - ä¾›åº”é“¾æ”»å‡»
  
  2. é…ç½®å±‚é¢:
     - ç‰¹æƒå®¹å™¨
     - ä¸å®‰å…¨æŒ‚è½½
     - å±é™©Capabilities
     - ä¸å½“ç½‘ç»œé…ç½®
  
  3. è¿è¡Œæ—¶å±‚é¢:
     - å®¹å™¨é€ƒé€¸
     - èµ„æºæ»¥ç”¨
     - ä¾§ä¿¡é“æ”»å‡»
     - å†…æ ¸æ¼æ´åˆ©ç”¨
  
  4. ç¼–æ’å±‚é¢:
     - APIæœåŠ¡å™¨æš´éœ²
     - RBACé…ç½®é”™è¯¯
     - Secretæ³„éœ²
     - å‡†å…¥æ§åˆ¶ç¼ºå¤±
  
  5. ä¸»æœºå±‚é¢:
     - Docker Daemonæ”»å‡»
     - å®¿ä¸»æœºå†…æ ¸æ¼æ´
     - å®¹å™¨è¿è¡Œæ—¶æ¼æ´
```

### å®¹å™¨å®‰å…¨æ¶æ„

```yaml
çºµæ·±é˜²å¾¡æ¶æ„:

  Layer 1 - ä¸»æœºå®‰å…¨:
    - æœ€å°åŒ–æ“ä½œç³»ç»Ÿ (Container-Optimized OS)
    - å†…æ ¸åŠ å›º
    - SELinux/AppArmor
    - åŠæ—¶è¡¥ä¸
  
  Layer 2 - å®¹å™¨è¿è¡Œæ—¶:
    - é€‰æ‹©å®‰å…¨è¿è¡Œæ—¶ (gVisor/Kata)
    - è¿è¡Œæ—¶å®‰å…¨ç­–ç•¥
    - Seccomp/AppArmoré…ç½®
    - èƒ½åŠ›é™åˆ¶
  
  Layer 3 - å®¹å™¨é…ç½®:
    - éç‰¹æƒç”¨æˆ·
    - åªè¯»æ–‡ä»¶ç³»ç»Ÿ
    - èµ„æºé™åˆ¶
    - å®‰å…¨ä¸Šä¸‹æ–‡
  
  Layer 4 - é•œåƒå®‰å…¨:
    - å¯ä¿¡åŸºç¡€é•œåƒ
    - æœ€å°åŒ–é•œåƒ
    - æ¼æ´æ‰«æ
    - é•œåƒç­¾å
  
  Layer 5 - ç½‘ç»œå®‰å…¨:
    - ç½‘ç»œç­–ç•¥
    - å¾®åˆ†æ®µ
    - mTLSåŠ å¯†
    - å…¥å£/å‡ºå£æ§åˆ¶
  
  Layer 6 - æ•°æ®å®‰å…¨:
    - SecretåŠ å¯†
    - å·åŠ å¯†
    - æ•°æ®è„±æ•
    - å¤‡ä»½åŠ å¯†
  
  Layer 7 - ç›‘æ§å®¡è®¡:
    - è¿è¡Œæ—¶æ£€æµ‹ (Falco)
    - æ—¥å¿—å®¡è®¡
    - è¡Œä¸ºåˆ†æ
    - å‘Šè­¦å“åº”
```

---

## é•œåƒå®‰å…¨

### åŸºç¡€é•œåƒé€‰æ‹©

```dockerfile
# âŒ ä¸å®‰å…¨: ä½¿ç”¨å®Œæ•´OSé•œåƒ
FROM ubuntu:latest
RUN apt-get update && apt-get install -y python3
COPY app.py /app/
CMD ["python3", "/app/app.py"]

# æ”»å‡»é¢:
# - å¤§é‡ä¸å¿…è¦çš„åŒ… (shell, package managers, etc.)
# - æ›´å¤šæ½œåœ¨æ¼æ´
# - æ›´å¤§çš„é•œåƒä½“ç§¯

# âœ… å®‰å…¨: ä½¿ç”¨Distrolessé•œåƒ
FROM python:3.11-slim AS builder
WORKDIR /app
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

FROM gcr.io/distroless/python3-debian11
COPY --from=builder /usr/local/lib/python3.11/site-packages /usr/local/lib/python3.11/site-packages
COPY app.py /app/
WORKDIR /app
CMD ["/app/app.py"]

# ä¼˜åŠ¿:
# - æ— shellã€åŒ…ç®¡ç†å™¨
# - ä»…åŒ…å«åº”ç”¨å’Œè¿è¡Œæ—¶ä¾èµ–
# - æœ€å°æ”»å‡»é¢
# - æ›´å°çš„é•œåƒä½“ç§¯

# âœ… æ›´å®‰å…¨: ä½¿ç”¨Scratch (é™æ€ç¼–è¯‘)
FROM golang:1.21 AS builder
WORKDIR /app
COPY . .
RUN CGO_ENABLED=0 GOOS=linux go build -a -installsuffix cgo -o app .

FROM scratch
COPY --from=builder /app/app /app
COPY --from=builder /etc/ssl/certs/ca-certificates.crt /etc/ssl/certs/
ENTRYPOINT ["/app"]

# ä¼˜åŠ¿:
# - å®Œå…¨ç©ºç™½åŸºç¡€é•œåƒ
# - é›¶æ”»å‡»é¢
# - æå°é•œåƒä½“ç§¯ (<10MB)
```

### å¤šé˜¶æ®µæ„å»ºå®‰å…¨

```dockerfile
# âœ… å®‰å…¨çš„å¤šé˜¶æ®µæ„å»º

# Stage 1: æ„å»ºé˜¶æ®µ
FROM node:18-alpine AS builder
WORKDIR /build

# åªå¤åˆ¶ä¾èµ–æ–‡ä»¶
COPY package*.json ./
RUN npm ci --only=production

# å¤åˆ¶æºä»£ç 
COPY src ./src
RUN npm run build

# Stage 2: è¿è¡Œé˜¶æ®µ
FROM node:18-alpine AS runtime

# åˆ›å»ºérootç”¨æˆ·
RUN addgroup -g 1001 -S nodejs && \
    adduser -S nodejs -u 1001 -G nodejs

# è®¾ç½®å·¥ä½œç›®å½•
WORKDIR /app

# åªå¤åˆ¶å¿…è¦æ–‡ä»¶
COPY --from=builder --chown=nodejs:nodejs /build/node_modules ./node_modules
COPY --from=builder --chown=nodejs:nodejs /build/dist ./dist
COPY --chown=nodejs:nodejs package.json ./

# åˆ‡æ¢åˆ°érootç”¨æˆ·
USER nodejs

# å¥åº·æ£€æŸ¥
HEALTHCHECK --interval=30s --timeout=3s \
  CMD node healthcheck.js || exit 1

# æš´éœ²ç«¯å£ (éç‰¹æƒç«¯å£)
EXPOSE 3000

CMD ["node", "dist/index.js"]

# å®‰å…¨è¦ç‚¹:
# 1. åˆ†ç¦»æ„å»ºå’Œè¿è¡Œç¯å¢ƒ
# 2. åªä¿ç•™è¿è¡Œæ—¶å¿…éœ€æ–‡ä»¶
# 3. ä½¿ç”¨érootç”¨æˆ·
# 4. è®¾ç½®æ­£ç¡®çš„æ–‡ä»¶æƒé™
# 5. å¯ç”¨å¥åº·æ£€æŸ¥
```

### Dockerfileå®‰å…¨æ£€æŸ¥

```bash
# ä½¿ç”¨Hadolintæ£€æŸ¥Dockerfile

# å®‰è£…Hadolint
docker pull hadolint/hadolint:latest

# æ£€æŸ¥Dockerfile
docker run --rm -i hadolint/hadolint < Dockerfile

# æˆ–
brew install hadolint
hadolint Dockerfile

# ç¤ºä¾‹è¾“å‡º:
# DL3003 warning: Use WORKDIR to switch to a directory
# DL3008 warning: Pin versions in apt get install
# DL3018 warning: Pin versions in apk add
# DL3025 warning: Use arguments JSON notation for CMD and ENTRYPOINT
```

### é•œåƒç­¾åä¸éªŒè¯

```bash
# ä½¿ç”¨Cosignç­¾åé•œåƒ

# 1. ç”Ÿæˆå¯†é’¥å¯¹
cosign generate-key-pair

# 2. ç­¾åé•œåƒ
cosign sign --key cosign.key myregistry.io/myapp:v1.0.0

# 3. éªŒè¯ç­¾å
cosign verify --key cosign.pub myregistry.io/myapp:v1.0.0

# 4. åœ¨Kubernetesä¸­å¼ºåˆ¶éªŒè¯
# ä½¿ç”¨ admission webhook æˆ– Kyvernoç­–ç•¥
```

---

## è¿è¡Œæ—¶å®‰å…¨

### å®‰å…¨ä¸Šä¸‹æ–‡é…ç½®

```yaml
# pod-security-context.yaml
# å®Œæ•´çš„Podå®‰å…¨ä¸Šä¸‹æ–‡é…ç½®

apiVersion: v1
kind: Pod
metadata:
  name: secure-pod
spec:
  # Podçº§åˆ«å®‰å…¨ä¸Šä¸‹æ–‡
  securityContext:
    # è¿è¡Œä¸ºérootç”¨æˆ·
    runAsNonRoot: true
    runAsUser: 1000
    runAsGroup: 3000
    fsGroup: 2000
    
    # æ–‡ä»¶ç³»ç»Ÿç»„å˜æ›´ç­–ç•¥
    fsGroupChangePolicy: "OnRootMismatch"
    
    # è¡¥å……ç»„
    supplementalGroups: [4000]
    
    # Seccompé…ç½®
    seccompProfile:
      type: RuntimeDefault
    
    # SELinuxé…ç½®
    seLinuxOptions:
      level: "s0:c123,c456"
  
  containers:
  - name: app
    image: myregistry.io/myapp:v1.0.0
    
    # å®¹å™¨çº§åˆ«å®‰å…¨ä¸Šä¸‹æ–‡
    securityContext:
      # ä¸å…è®¸ç‰¹æƒæå‡
      allowPrivilegeEscalation: false
      
      # èƒ½åŠ›é™åˆ¶
      capabilities:
        drop:
          - ALL
        add:
          - NET_BIND_SERVICE  # ä»…åœ¨éœ€è¦ç»‘å®š<1024ç«¯å£æ—¶
      
      # åªè¯»æ ¹æ–‡ä»¶ç³»ç»Ÿ
      readOnlyRootFilesystem: true
      
      # è¿è¡Œä¸ºéroot
      runAsNonRoot: true
      runAsUser: 1000
      
      # Seccomp (å¯è¦†ç›–Podçº§åˆ«)
      seccompProfile:
        type: RuntimeDefault
      
      # AppArmor (é€šè¿‡æ³¨è§£)
      # apparmor.security.beta.kubernetes.io/app: runtime/default
    
    # æŒ‚è½½ä¸´æ—¶å·ç”¨äºå†™å…¥
    volumeMounts:
    - name: tmp
      mountPath: /tmp
    - name: cache
      mountPath: /app/cache
    
    resources:
      limits:
        cpu: "1"
        memory: "512Mi"
      requests:
        cpu: "100m"
        memory: "128Mi"
  
  volumes:
  - name: tmp
    emptyDir: {}
  - name: cache
    emptyDir: {}

---
# deployment-security-context.yaml
# Deploymentä¸­çš„å®‰å…¨é…ç½®

apiVersion: apps/v1
kind: Deployment
metadata:
  name: secure-app
spec:
  replicas: 3
  selector:
    matchLabels:
      app: secure-app
  template:
    metadata:
      labels:
        app: secure-app
      annotations:
        # AppArmoré…ç½®
        container.apparmor.security.beta.kubernetes.io/app: runtime/default
    spec:
      # è‡ªåŠ¨æŒ‚è½½ServiceAccountä»¤ç‰Œ (å¯é€‰)
      automountServiceAccountToken: false
      
      # Podå®‰å…¨ä¸Šä¸‹æ–‡
      securityContext:
        runAsNonRoot: true
        runAsUser: 1000
        fsGroup: 2000
        seccompProfile:
          type: RuntimeDefault
      
      containers:
      - name: app
        image: myregistry.io/myapp:v1.0.0
        securityContext:
          allowPrivilegeEscalation: false
          readOnlyRootFilesystem: true
          capabilities:
            drop: [ALL]
        
        volumeMounts:
        - name: tmp
          mountPath: /tmp
        
        resources:
          limits:
            cpu: "1"
            memory: "512Mi"
          requests:
            cpu: "100m"
            memory: "128Mi"
        
        livenessProbe:
          httpGet:
            path: /health
            port: 8080
          initialDelaySeconds: 30
          periodSeconds: 10
        
        readinessProbe:
          httpGet:
            path: /ready
            port: 8080
          initialDelaySeconds: 5
          periodSeconds: 5
      
      volumes:
      - name: tmp
        emptyDir: {}
```

### Seccompé…ç½®

```json
// seccomp-profile.json
// è‡ªå®šä¹‰Seccompé…ç½®æ–‡ä»¶

{
  "defaultAction": "SCMP_ACT_ERRNO",
  "architectures": [
    "SCMP_ARCH_X86_64",
    "SCMP_ARCH_X86",
    "SCMP_ARCH_X32"
  ],
  "syscalls": [
    {
      "names": [
        "accept",
        "accept4",
        "access",
        "arch_prctl",
        "bind",
        "brk",
        "capget",
        "capset",
        "chdir",
        "chmod",
        "chown",
        "clone",
        "close",
        "connect",
        "dup",
        "dup2",
        "epoll_create",
        "epoll_create1",
        "epoll_ctl",
        "epoll_pwait",
        "epoll_wait",
        "exit",
        "exit_group",
        "fchmod",
        "fchown",
        "fcntl",
        "fstat",
        "futex",
        "getcwd",
        "getdents",
        "getdents64",
        "getegid",
        "geteuid",
        "getgid",
        "getpid",
        "getppid",
        "getuid",
        "listen",
        "lseek",
        "mmap",
        "mprotect",
        "munmap",
        "open",
        "openat",
        "pipe",
        "pipe2",
        "poll",
        "read",
        "readlink",
        "recvfrom",
        "recvmsg",
        "rt_sigaction",
        "rt_sigprocmask",
        "rt_sigreturn",
        "sendmsg",
        "sendto",
        "set_robust_list",
        "set_tid_address",
        "setgid",
        "setgroups",
        "setuid",
        "socket",
        "stat",
        "statfs",
        "tgkill",
        "uname",
        "wait4",
        "write",
        "writev"
      ],
      "action": "SCMP_ACT_ALLOW"
    }
  ]
}
```

```yaml
# ä½¿ç”¨è‡ªå®šä¹‰Seccompé…ç½®
apiVersion: v1
kind: Pod
metadata:
  name: seccomp-pod
spec:
  securityContext:
    seccompProfile:
      type: Localhost
      localhostProfile: profiles/seccomp-profile.json
  containers:
  - name: app
    image: myapp:latest
```

### AppArmoré…ç½®

```bash
# apparmor-profile
# AppArmoré…ç½®æ–‡ä»¶

#include <tunables/global>

profile k8s-apparmor-example flags=(attach_disconnected) {
  #include <abstractions/base>
  
  # å…è®¸ç½‘ç»œæ“ä½œ
  network inet tcp,
  network inet udp,
  network inet icmp,
  
  # å…è®¸è¯»å–ç‰¹å®šæ–‡ä»¶
  /app/** r,
  /etc/passwd r,
  /etc/group r,
  /etc/resolv.conf r,
  
  # å…è®¸å†™å…¥ç‰¹å®šç›®å½•
  /tmp/** rw,
  /var/log/app/** w,
  
  # ç¦æ­¢æ‰§è¡Œ
  deny /bin/** x,
  deny /usr/bin/** x,
  deny /sbin/** x,
  deny /usr/sbin/** x,
  
  # å…è®¸åº”ç”¨äºŒè¿›åˆ¶æ‰§è¡Œ
  /app/bin/myapp ix,
}
```

```yaml
# ä½¿ç”¨AppArmor
apiVersion: v1
kind: Pod
metadata:
  name: apparmor-pod
  annotations:
    container.apparmor.security.beta.kubernetes.io/app: localhost/k8s-apparmor-example
spec:
  containers:
  - name: app
    image: myapp:latest
```

---

## å®¹å™¨éš”ç¦»

### å‘½åç©ºé—´éš”ç¦»

```yaml
# namespace-with-policies.yaml
# åˆ›å»ºéš”ç¦»çš„å‘½åç©ºé—´

apiVersion: v1
kind: Namespace
metadata:
  name: production
  labels:
    name: production
    pod-security.kubernetes.io/enforce: restricted
    pod-security.kubernetes.io/audit: restricted
    pod-security.kubernetes.io/warn: restricted

---
# ResourceQuotaé™åˆ¶
apiVersion: v1
kind: ResourceQuota
metadata:
  name: production-quota
  namespace: production
spec:
  hard:
    requests.cpu: "100"
    requests.memory: "200Gi"
    limits.cpu: "200"
    limits.memory: "400Gi"
    pods: "100"
    services: "20"
    persistentvolumeclaims: "50"

---
# LimitRangeé»˜è®¤å€¼
apiVersion: v1
kind: LimitRange
metadata:
  name: production-limit-range
  namespace: production
spec:
  limits:
  - max:
      cpu: "2"
      memory: "4Gi"
    min:
      cpu: "100m"
      memory: "128Mi"
    default:
      cpu: "500m"
      memory: "512Mi"
    defaultRequest:
      cpu: "200m"
      memory: "256Mi"
    type: Container
  
  - max:
      cpu: "4"
      memory: "8Gi"
    min:
      cpu: "100m"
      memory: "128Mi"
    type: Pod

---
# NetworkPolicyéš”ç¦»
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: default-deny-all
  namespace: production
spec:
  podSelector: {}
  policyTypes:
  - Ingress
  - Egress

---
# å…è®¸ç‰¹å®šæµé‡
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: allow-app-traffic
  namespace: production
spec:
  podSelector:
    matchLabels:
      app: myapp
  policyTypes:
  - Ingress
  - Egress
  ingress:
  - from:
    - podSelector:
        matchLabels:
          app: frontend
    ports:
    - protocol: TCP
      port: 8080
  egress:
  - to:
    - podSelector:
        matchLabels:
          app: database
    ports:
    - protocol: TCP
      port: 5432
  - to:
    - namespaceSelector:
        matchLabels:
          name: kube-system
      podSelector:
        matchLabels:
          k8s-app: kube-dns
    ports:
    - protocol: UDP
      port: 53
```

### gVisoræ²™ç®±è¿è¡Œæ—¶

```yaml
# gvisor-runtimeclass.yaml
# gVisor RuntimeClassé…ç½®

apiVersion: node.k8s.io/v1
kind: RuntimeClass
metadata:
  name: gvisor
handler: runsc

---
# ä½¿ç”¨gVisorè¿è¡ŒPod
apiVersion: v1
kind: Pod
metadata:
  name: gvisor-pod
spec:
  runtimeClassName: gvisor
  containers:
  - name: app
    image: myapp:latest
    securityContext:
      runAsNonRoot: true
      runAsUser: 1000
```

```bash
# å®‰è£…gVisor

# 1. ä¸‹è½½runsc
wget https://storage.googleapis.com/gvisor/releases/release/latest/x86_64/runsc
chmod +x runsc
sudo mv runsc /usr/local/bin/

# 2. é…ç½®containerd
cat <<EOF | sudo tee /etc/containerd/config.toml
version = 2
[plugins."io.containerd.runtime.v1.linux"]
  shim_debug = true
[plugins."io.containerd.grpc.v1.cri".containerd.runtimes.runc]
  runtime_type = "io.containerd.runc.v2"
[plugins."io.containerd.grpc.v1.cri".containerd.runtimes.runsc]
  runtime_type = "io.containerd.runsc.v1"
EOF

# 3. é‡å¯containerd
sudo systemctl restart containerd

# 4. éªŒè¯
kubectl get runtimeclass
```

### Kata Containers

```yaml
# kata-runtimeclass.yaml
# Kata Containers RuntimeClass

apiVersion: node.k8s.io/v1
kind: RuntimeClass
metadata:
  name: kata
handler: kata
overhead:
  podFixed:
    memory: "160Mi"
    cpu: "250m"
scheduling:
  nodeSelector:
    kata-enabled: "true"

---
# ä½¿ç”¨Kataè¿è¡ŒPod
apiVersion: v1
kind: Pod
metadata:
  name: kata-pod
spec:
  runtimeClassName: kata
  containers:
  - name: app
    image: myapp:latest
```

---

## Secretsç®¡ç†

### Kubernetes Secretsæœ€ä½³å®è·µ

```yaml
# âŒ ä¸å®‰å…¨: æ˜æ–‡Secret
apiVersion: v1
kind: Secret
metadata:
  name: db-secret
type: Opaque
stringData:
  username: admin
  password: password123

# âœ… å®‰å…¨: ä½¿ç”¨Base64ç¼–ç  (åŸºç¡€)
apiVersion: v1
kind: Secret
metadata:
  name: db-secret
type: Opaque
data:
  username: YWRtaW4=  # admin
  password: cGFzc3dvcmQxMjM=  # password123

# âœ… æ›´å®‰å…¨: ä½¿ç”¨External Secrets Operator
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: db-secret
spec:
  refreshInterval: 1h
  secretStoreRef:
    name: vault-backend
    kind: SecretStore
  target:
    name: db-secret
    creationPolicy: Owner
  data:
  - secretKey: username
    remoteRef:
      key: database/credentials
      property: username
  - secretKey: password
    remoteRef:
      key: database/credentials
      property: password

---
# SecretStoreé…ç½® (HashiCorp Vault)
apiVersion: external-secrets.io/v1beta1
kind: SecretStore
metadata:
  name: vault-backend
spec:
  provider:
    vault:
      server: "https://vault.example.com"
      path: "secret"
      version: "v2"
      auth:
        kubernetes:
          mountPath: "kubernetes"
          role: "external-secrets"
          serviceAccountRef:
            name: external-secrets-sa
```

### Secretä½¿ç”¨æœ€ä½³å®è·µ

```yaml
# secret-usage-best-practices.yaml

apiVersion: v1
kind: Pod
metadata:
  name: secure-secret-usage
spec:
  # âœ… ä¸è‡ªåŠ¨æŒ‚è½½ServiceAccount Token
  automountServiceAccountToken: false
  
  containers:
  - name: app
    image: myapp:latest
    
    # âœ… æ–¹å¼1: ç¯å¢ƒå˜é‡ (æ¨èç”¨äºå°‘é‡Secret)
    env:
    - name: DB_USERNAME
      valueFrom:
        secretKeyRef:
          name: db-secret
          key: username
    - name: DB_PASSWORD
      valueFrom:
        secretKeyRef:
          name: db-secret
          key: password
    
    # âœ… æ–¹å¼2: å·æŒ‚è½½ (æ¨èç”¨äºå¤§é‡Secret/æ–‡ä»¶)
    volumeMounts:
    - name: db-certs
      mountPath: /etc/db-certs
      readOnly: true
    
    # âœ… æ–¹å¼3: ä¸´æ—¶æŠ•å½±å· (è‡ªåŠ¨æ›´æ–°)
    - name: api-keys
      mountPath: /etc/api-keys
      readOnly: true
  
  volumes:
  # æ ‡å‡†Secretå·
  - name: db-certs
    secret:
      secretName: db-certs
      defaultMode: 0400  # åªè¯»æƒé™
  
  # æŠ•å½±å· (æ”¯æŒå¤šSecretç»„åˆ)
  - name: api-keys
    projected:
      defaultMode: 0400
      sources:
      - secret:
          name: api-key-1
          items:
          - key: key
            path: api-key-1.txt
      - secret:
          name: api-key-2
          items:
          - key: key
            path: api-key-2.txt
```

### SecretåŠ å¯†é…ç½®

```yaml
# encryption-config.yaml
# Kubernetes Secreté™æ€åŠ å¯†

apiVersion: apiserver.config.k8s.io/v1
kind: EncryptionConfiguration
resources:
  - resources:
      - secrets
    providers:
    # 1. ä½¿ç”¨KMS (æ¨èç”Ÿäº§ç¯å¢ƒ)
    - kms:
        name: aws-kms
        endpoint: unix:///var/run/kmsplugin/socket.sock
        cachesize: 1000
        timeout: 3s
    
    # 2. ä½¿ç”¨AES-CBC (å¤‡ç”¨)
    - aescbc:
        keys:
        - name: key1
          secret: <32å­—èŠ‚Base64ç¼–ç å¯†é’¥>
    
    # 3. æ˜æ–‡ (ç”¨äºè¯»å–æ—§æ•°æ®)
    - identity: {}
```

```bash
# å¯ç”¨SecretåŠ å¯†

# 1. åˆ›å»ºåŠ å¯†é…ç½®
vim /etc/kubernetes/enc/encryption-config.yaml

# 2. ä¿®æ”¹kube-apiserveré…ç½®
# /etc/kubernetes/manifests/kube-apiserver.yaml
spec:
  containers:
  - command:
    - kube-apiserver
    - --encryption-provider-config=/etc/kubernetes/enc/encryption-config.yaml
    volumeMounts:
    - mountPath: /etc/kubernetes/enc
      name: enc
      readOnly: true
  volumes:
  - hostPath:
      path: /etc/kubernetes/enc
      type: DirectoryOrCreate
    name: enc

# 3. é‡æ–°åŠ å¯†æ‰€æœ‰Secrets
kubectl get secrets --all-namespaces -o json | \
  kubectl replace -f -
```

---

## ç½‘ç»œå®‰å…¨

### ç½‘ç»œç­–ç•¥å…¨é¢ç¤ºä¾‹

```yaml
# comprehensive-network-policies.yaml

# 1. é»˜è®¤æ‹’ç»æ‰€æœ‰æµé‡
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: default-deny-all
  namespace: production
spec:
  podSelector: {}
  policyTypes:
  - Ingress
  - Egress

---
# 2. å…è®¸DNSæŸ¥è¯¢
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: allow-dns
  namespace: production
spec:
  podSelector: {}
  policyTypes:
  - Egress
  egress:
  - to:
    - namespaceSelector:
        matchLabels:
          kubernetes.io/metadata.name: kube-system
    - podSelector:
        matchLabels:
          k8s-app: kube-dns
    ports:
    - protocol: UDP
      port: 53

---
# 3. å‰ç«¯â†’åç«¯é€šä¿¡
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: frontend-to-backend
  namespace: production
spec:
  podSelector:
    matchLabels:
      tier: backend
  policyTypes:
  - Ingress
  ingress:
  - from:
    - podSelector:
        matchLabels:
          tier: frontend
    ports:
    - protocol: TCP
      port: 8080

---
# 4. åç«¯â†’æ•°æ®åº“é€šä¿¡
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: backend-to-database
  namespace: production
spec:
  podSelector:
    matchLabels:
      tier: backend
  policyTypes:
  - Egress
  egress:
  - to:
    - podSelector:
        matchLabels:
          tier: database
    ports:
    - protocol: TCP
      port: 5432

---
# 5. Ingresså…¥å£æµé‡
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: allow-ingress
  namespace: production
spec:
  podSelector:
    matchLabels:
      tier: frontend
  policyTypes:
  - Ingress
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          kubernetes.io/metadata.name: ingress-nginx
    ports:
    - protocol: TCP
      port: 80
    - protocol: TCP
      port: 443

---
# 6. å…è®¸åˆ°å¤–éƒ¨API
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: allow-external-api
  namespace: production
spec:
  podSelector:
    matchLabels:
      app: api-client
  policyTypes:
  - Egress
  egress:
  - to:
    - namespaceSelector: {}
    ports:
    - protocol: TCP
      port: 443
  - to:
    - ipBlock:
        cidr: 0.0.0.0/0
        except:
        - 10.0.0.0/8
        - 172.16.0.0/12
        - 192.168.0.0/16
    ports:
    - protocol: TCP
      port: 443

---
# 7. ç›‘æ§Namespaceè®¿é—®
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: allow-monitoring
  namespace: production
spec:
  podSelector: {}
  policyTypes:
  - Ingress
  ingress:
  - from:
    - namespaceSelector:
        matchLabels:
          kubernetes.io/metadata.name: monitoring
    ports:
    - protocol: TCP
      port: 9090  # Prometheus metrics
```

### Service Meshå®‰å…¨ (Istio)

```yaml
# istio-security.yaml

# 1. å¯ç”¨mTLS
apiVersion: security.istio.io/v1beta1
kind: PeerAuthentication
metadata:
  name: default
  namespace: production
spec:
  mtls:
    mode: STRICT

---
# 2. æˆæƒç­–ç•¥: é»˜è®¤æ‹’ç»
apiVersion: security.istio.io/v1beta1
kind: AuthorizationPolicy
metadata:
  name: deny-all
  namespace: production
spec:
  {}

---
# 3. å…è®¸å‰ç«¯â†’åç«¯
apiVersion: security.istio.io/v1beta1
kind: AuthorizationPolicy
metadata:
  name: frontend-to-backend
  namespace: production
spec:
  selector:
    matchLabels:
      app: backend
  action: ALLOW
  rules:
  - from:
    - source:
        principals: ["cluster.local/ns/production/sa/frontend"]
    to:
    - operation:
        methods: ["GET", "POST"]
        paths: ["/api/*"]

---
# 4. JWTéªŒè¯
apiVersion: security.istio.io/v1beta1
kind: RequestAuthentication
metadata:
  name: jwt-auth
  namespace: production
spec:
  selector:
    matchLabels:
      app: api
  jwtRules:
  - issuer: "https://auth.example.com"
    jwksUri: "https://auth.example.com/.well-known/jwks.json"
    audiences:
    - "api.example.com"

---
apiVersion: security.istio.io/v1beta1
kind: AuthorizationPolicy
metadata:
  name: require-jwt
  namespace: production
spec:
  selector:
    matchLabels:
      app: api
  action: ALLOW
  rules:
  - from:
    - source:
        requestPrincipals: ["*"]
    when:
    - key: request.auth.claims[role]
      values: ["admin", "user"]
```

---

## å®‰å…¨ç›‘æ§

### Falcoè¿è¡Œæ—¶æ£€æµ‹

```yaml
# falco-installation.yaml
# Falco DaemonSetå®‰è£…

apiVersion: v1
kind: Namespace
metadata:
  name: falco

---
apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: falco
  namespace: falco
spec:
  selector:
    matchLabels:
      app: falco
  template:
    metadata:
      labels:
        app: falco
    spec:
      serviceAccountName: falco
      hostNetwork: true
      hostPID: true
      containers:
      - name: falco
        image: falcosecurity/falco:0.36.2
        securityContext:
          privileged: true
        volumeMounts:
        - name: docker-socket
          mountPath: /host/var/run/docker.sock
        - name: dev
          mountPath: /host/dev
        - name: proc
          mountPath: /host/proc
          readOnly: true
        - name: boot
          mountPath: /host/boot
          readOnly: true
        - name: lib-modules
          mountPath: /host/lib/modules
          readOnly: true
        - name: usr
          mountPath: /host/usr
          readOnly: true
        - name: etc
          mountPath: /host/etc
          readOnly: true
        - name: falco-config
          mountPath: /etc/falco
      volumes:
      - name: docker-socket
        hostPath:
          path: /var/run/docker.sock
      - name: dev
        hostPath:
          path: /dev
      - name: proc
        hostPath:
          path: /proc
      - name: boot
        hostPath:
          path: /boot
      - name: lib-modules
        hostPath:
          path: /lib/modules
      - name: usr
        hostPath:
          path: /usr
      - name: etc
        hostPath:
          path: /etc
      - name: falco-config
        configMap:
          name: falco-config
```

### Falcoè§„åˆ™é…ç½®

```yaml
# falco-rules.yaml
# è‡ªå®šä¹‰Falcoè§„åˆ™

customRules:
  rules-custom.yaml: |-
    # æ£€æµ‹ç‰¹æƒå®¹å™¨å¯åŠ¨
    - rule: Launch Privileged Container
      desc: Detect the initial process started in a privileged container
      condition: >
        container_started and container
        and container.privileged=true
      output: >
        Privileged container started
        (user=%user.name command=%proc.cmdline %container.info)
      priority: WARNING
      tags: [container, cis]
    
    # æ£€æµ‹æ•æ„Ÿæ–‡ä»¶è®¿é—®
    - rule: Read sensitive file
      desc: Detect reads of sensitive files
      condition: >
        open_read and container
        and fd.name in (sensitive_files)
      output: >
        Sensitive file opened for reading
        (user=%user.name command=%proc.cmdline file=%fd.name %container.info)
      priority: WARNING
    
    # æ£€æµ‹Shellæ‰§è¡Œ
    - rule: Terminal shell in container
      desc: A shell was used as the entrypoint/exec point
      condition: >
        spawned_process and container
        and shell_procs and proc.tty != 0
      output: >
        A shell was spawned in a container with an attached terminal
        (user=%user.name %container.info shell=%proc.name parent=%proc.pname
        cmdline=%proc.cmdline)
      priority: NOTICE
      tags: [container, shell]
    
    # æ£€æµ‹å¼‚å¸¸ç½‘ç»œè¿æ¥
    - rule: Unexpected outbound connection
      desc: Detect any outbound connection to a non-whitelisted destination
      condition: >
        outbound and container
        and not fd.sip.name in (allowed_outbound_destinations)
      output: >
        Unexpected outbound connection
        (user=%user.name command=%proc.cmdline connection=%fd.name %container.info)
      priority: WARNING
    
    # æ£€æµ‹å®¹å™¨é€ƒé€¸å°è¯•
    - rule: Container Drift Detection
      desc: New executable created in container
      condition: >
        container and modify and
        ((fd.name contains "bin/" and fd.name_changed) or
        (fd.name contains "sbin/" and fd.name_changed))
      output: >
        New executable created in container
        (user=%user.name command=%proc.cmdline file=%fd.name %container.info)
      priority: ERROR
      tags: [container]
```

### å®¡è®¡æ—¥å¿—é…ç½®

```yaml
# audit-policy.yaml
# Kuberneteså®¡è®¡ç­–ç•¥

apiVersion: audit.k8s.io/v1
kind: Policy
rules:
  # è®°å½•Secretæ“ä½œ
  - level: RequestResponse
    resources:
    - group: ""
      resources: ["secrets"]
  
  # è®°å½•ConfigMapæ“ä½œ
  - level: Request
    resources:
    - group: ""
      resources: ["configmaps"]
  
  # è®°å½•Pod exec/attach
  - level: Request
    resources:
    - group: ""
      resources: ["pods/exec", "pods/attach", "pods/portforward"]
  
  # è®°å½•RBACå˜æ›´
  - level: RequestResponse
    resources:
    - group: "rbac.authorization.k8s.io"
      resources: ["clusterroles", "roles", "clusterrolebindings", "rolebindings"]
  
  # è®°å½•è®¤è¯å¤±è´¥
  - level: Metadata
    omitStages:
    - RequestReceived
    users: ["system:anonymous"]
  
  # å¿½ç•¥åªè¯»è¯·æ±‚
  - level: None
    verbs: ["get", "list", "watch"]
```

---

## åˆè§„æ€§

### CIS Kubernetes Benchmark

```bash
# ä½¿ç”¨kube-benchæ£€æŸ¥CISåˆè§„æ€§

# 1. ä¸‹è½½kube-bench
wget https://github.com/aquasecurity/kube-bench/releases/download/v0.7.0/kube-bench_0.7.0_linux_amd64.tar.gz
tar -xvf kube-bench_0.7.0_linux_amd64.tar.gz

# 2. è¿è¡Œæ£€æŸ¥
./kube-bench run --targets=master,node

# 3. ä½œä¸ºJobè¿è¡Œ
kubectl apply -f https://raw.githubusercontent.com/aquasecurity/kube-bench/main/job.yaml

# 4. æŸ¥çœ‹ç»“æœ
kubectl logs job/kube-bench

# ç¤ºä¾‹è¾“å‡º:
# [INFO] 1 Master Node Security Configuration
# [INFO] 1.1 Master Node Configuration Files
# [PASS] 1.1.1 Ensure that the API server pod specification file permissions are set to 644 or more restrictive
# [PASS] 1.1.2 Ensure that the API server pod specification file ownership is set to root:root
# [FAIL] 1.2.1 Ensure that the --anonymous-auth argument is set to false
```

### NSA/CISA Kuberneteså¼ºåŒ–æŒ‡å—

```yaml
# nsa-hardening.yaml
# NSA/CISAæ¨èçš„KubernetesåŠ å›ºé…ç½®

# 1. Podå®‰å…¨æ ‡å‡† (Restricted)
apiVersion: v1
kind: Namespace
metadata:
  name: secure-namespace
  labels:
    pod-security.kubernetes.io/enforce: restricted
    pod-security.kubernetes.io/audit: restricted
    pod-security.kubernetes.io/warn: restricted

---
# 2. é™åˆ¶ServiceAccountæƒé™
apiVersion: v1
kind: ServiceAccount
metadata:
  name: limited-sa
  namespace: secure-namespace
automountServiceAccountToken: false

---
# 3. æœ€å°RBACæƒé™
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: pod-reader
  namespace: secure-namespace
rules:
- apiGroups: [""]
  resources: ["pods"]
  verbs: ["get", "list"]

---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: read-pods
  namespace: secure-namespace
subjects:
- kind: ServiceAccount
  name: limited-sa
roleRef:
  kind: Role
  name: pod-reader
  apiGroup: rbac.authorization.k8s.io

---
# 4. èµ„æºé™åˆ¶
apiVersion: v1
kind: LimitRange
metadata:
  name: resource-limits
  namespace: secure-namespace
spec:
  limits:
  - max:
      cpu: "2"
      memory: "2Gi"
    min:
      cpu: "100m"
      memory: "128Mi"
    type: Container

---
# 5. ç½‘ç»œéš”ç¦»
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: default-deny
  namespace: secure-namespace
spec:
  podSelector: {}
  policyTypes:
  - Ingress
  - Egress
```

---

## å®æˆ˜å·¥å…·

### å®‰å…¨æ‰«æå·¥å…·å¯¹æ¯”

```yaml
é•œåƒæ‰«æå·¥å…·:
  
  Trivy:
    ä¼˜åŠ¿:
      - æ˜“äºä½¿ç”¨
      - å¿«é€Ÿæ‰«æ
      - æ”¯æŒå¤šç§æ ¼å¼ (é•œåƒ/æ–‡ä»¶ç³»ç»Ÿ/Git)
      - å…è´¹å¼€æº
    ä½¿ç”¨: trivy image nginx:latest
  
  Grype:
    ä¼˜åŠ¿:
      - Anchoreå‡ºå“
      - æ”¯æŒSBOMæ‰«æ
      - æ¼æ´æ•°æ®åº“æ›´æ–°å¿«
      - å…è´¹å¼€æº
    ä½¿ç”¨: grype nginx:latest
  
  Clair:
    ä¼˜åŠ¿:
      - Red Hatæ”¯æŒ
      - APIé©±åŠ¨
      - å¯é›†æˆHarbor
      - å…è´¹å¼€æº
    ä½¿ç”¨: é€šè¿‡Harborç•Œé¢
  
  Snyk:
    ä¼˜åŠ¿:
      - å¼€å‘è€…å‹å¥½
      - CI/CDé›†æˆå¥½
      - ä¾èµ–æ¼æ´æ£€æµ‹
      - å•†ä¸šæ”¯æŒ
    ä½¿ç”¨: snyk container test nginx:latest
  
  Aqua Trivy (ä¼ä¸šç‰ˆ):
    ä¼˜åŠ¿:
      - ä¼ä¸šçº§åŠŸèƒ½
      - åˆè§„æ€§æŠ¥å‘Š
      - ç­–ç•¥ç®¡ç†
      - å•†ä¸šæ”¯æŒ
    ä½¿ç”¨: ä¼ä¸šç‰ˆæ§åˆ¶å°

è¿è¡Œæ—¶å®‰å…¨:
  
  Falco:
    ç‰¹ç‚¹: CNCFé¡¹ç›®,åŸºäºeBPF
    ç”¨é€”: è¿è¡Œæ—¶å¨èƒæ£€æµ‹
    ä¼˜åŠ¿: è§„åˆ™çµæ´»,æ€§èƒ½å¥½
  
  Sysdig Secure:
    ç‰¹ç‚¹: Falcoå•†ä¸šç‰ˆ
    ç”¨é€”: å…¨é¢å®‰å…¨å¹³å°
    ä¼˜åŠ¿: ä¼ä¸šåŠŸèƒ½,æ”¯æŒå¥½
  
  Aqua Security:
    ç‰¹ç‚¹: å…¨æ ˆå®¹å™¨å®‰å…¨
    ç”¨é€”: é•œåƒ+è¿è¡Œæ—¶+åˆè§„
    ä¼˜åŠ¿: åŠŸèƒ½å…¨é¢
  
  Prisma Cloud (Twistlock):
    ç‰¹ç‚¹: Palo Altoå‡ºå“
    ç”¨é€”: äº‘åŸç”Ÿå®‰å…¨
    ä¼˜åŠ¿: å¤šäº‘æ”¯æŒ

ç­–ç•¥å¼•æ“:
  
  OPA Gatekeeper:
    ç‰¹ç‚¹: CNCFé¡¹ç›®
    ç”¨é€”: å‡†å…¥æ§åˆ¶
    ä¼˜åŠ¿: çµæ´»å¼ºå¤§
  
  Kyverno:
    ç‰¹ç‚¹: KubernetesåŸç”Ÿ
    ç”¨é€”: ç­–ç•¥ç®¡ç†
    ä¼˜åŠ¿: æ˜“äºä½¿ç”¨
```

---

## æœ€ä½³å®è·µ

### å®¹å™¨å®‰å…¨æ¸…å•

```yaml
é•œåƒå®‰å…¨ âœ…:
  âœ… ä½¿ç”¨æœ€å°åŸºç¡€é•œåƒ (Distroless/Alpine)
  âœ… å¤šé˜¶æ®µæ„å»º
  âœ… ä¸ä½¿ç”¨latestæ ‡ç­¾
  âœ… å®šæœŸæ‰«ææ¼æ´
  âœ… ç­¾åé•œåƒ
  âœ… ä½¿ç”¨ç§æœ‰é•œåƒä»“åº“
  âœ… å®æ–½é•œåƒå‡†å…¥ç­–ç•¥

é…ç½®å®‰å…¨ âœ…:
  âœ… è¿è¡Œä¸ºérootç”¨æˆ·
  âœ… åªè¯»æ ¹æ–‡ä»¶ç³»ç»Ÿ
  âœ… ç¦æ­¢ç‰¹æƒæå‡
  âœ… åˆ é™¤æ‰€æœ‰Capabilities
  âœ… é…ç½®Seccomp
  âœ… é…ç½®AppArmor/SELinux
  âœ… è®¾ç½®èµ„æºé™åˆ¶

è¿è¡Œæ—¶å®‰å…¨ âœ…:
  âœ… ä½¿ç”¨RuntimeClass (gVisor/Kata)
  âœ… è¿è¡Œæ—¶å¨èƒæ£€æµ‹ (Falco)
  âœ… ç½‘ç»œç­–ç•¥éš”ç¦»
  âœ… Podå®‰å…¨æ ‡å‡†
  âœ… å®¡è®¡æ—¥å¿—å¯ç”¨
  âœ… ç›‘æ§å¼‚å¸¸è¡Œä¸º

Secretsç®¡ç† âœ…:
  âœ… ä¸åœ¨é•œåƒä¸­ç¡¬ç¼–ç 
  âœ… ä½¿ç”¨External Secrets
  âœ… å¯ç”¨é™æ€åŠ å¯†
  âœ… æœ€å°æƒé™è®¿é—®
  âœ… å®šæœŸè½®æ¢
  âœ… å®¡è®¡è®¿é—®æ—¥å¿—

ç½‘ç»œå®‰å…¨ âœ…:
  âœ… é»˜è®¤æ‹’ç»ç­–ç•¥
  âœ… ç½‘ç»œå¾®åˆ†æ®µ
  âœ… mTLSåŠ å¯†
  âœ… Ingress/Egressæ§åˆ¶
  âœ… Service Mesh
  âœ… ç›‘æ§ç½‘ç»œæµé‡

åˆè§„æ€§ âœ…:
  âœ… CIS Benchmarkæ£€æŸ¥
  âœ… NSA/CISAæŒ‡å—éµå¾ª
  âœ… PCI-DSS/HIPAAåˆè§„
  âœ… å®šæœŸå®‰å…¨å®¡è®¡
  âœ… æ¼æ´ç®¡ç†æµç¨‹
  âœ… äº‹ä»¶å“åº”è®¡åˆ’
```

### å®‰å…¨æˆç†Ÿåº¦æ¨¡å‹

```yaml
Level 1 - åŸºç¡€ (0-3ä¸ªæœˆ):
  é•œåƒ:
    - ä½¿ç”¨å®˜æ–¹é•œåƒ
    - åŸºç¡€æ¼æ´æ‰«æ
  é…ç½®:
    - érootç”¨æˆ·
    - åŸºç¡€èµ„æºé™åˆ¶
  è¿è¡Œæ—¶:
    - é»˜è®¤å®‰å…¨ä¸Šä¸‹æ–‡
  è¯„ä¼°: 30%æˆç†Ÿåº¦

Level 2 - ä¸­çº§ (3-6ä¸ªæœˆ):
  é•œåƒ:
    - è‡ªå®šä¹‰åŸºç¡€é•œåƒ
    - CI/CDé›†æˆæ‰«æ
    - é•œåƒç­¾å
  é…ç½®:
    - åªè¯»æ–‡ä»¶ç³»ç»Ÿ
    - åˆ é™¤Capabilities
    - Seccompé…ç½®
  è¿è¡Œæ—¶:
    - ç½‘ç»œç­–ç•¥
    - Podå®‰å…¨ç­–ç•¥
  è¯„ä¼°: 60%æˆç†Ÿåº¦

Level 3 - é«˜çº§ (6-12ä¸ªæœˆ):
  é•œåƒ:
    - Distrolessé•œåƒ
    - å‡†å…¥æ§åˆ¶
    - SBOMç”Ÿæˆ
  é…ç½®:
    - AppArmor/SELinux
    - RuntimeClass
  è¿è¡Œæ—¶:
    - Falcoç›‘æ§
    - å®¡è®¡æ—¥å¿—
    - Service Mesh
  è¯„ä¼°: 85%æˆç†Ÿåº¦

Level 4 - å“è¶Š (12+ä¸ªæœˆ):
  é•œåƒ:
    - é›¶ä¿¡ä»»ä¾›åº”é“¾
    - SLSA Level 3+
  é…ç½®:
    - gVisor/Kataæ²™ç®±
    - å®Œæ•´åŠ å›º
  è¿è¡Œæ—¶:
    - è‡ªåŠ¨åŒ–å“åº”
    - é›¶ä¿¡ä»»ç½‘ç»œ
    - æŒç»­åˆè§„
  è¯„ä¼°: 95%+æˆç†Ÿåº¦
```

---

## å‚è€ƒèµ„æ–™

### å®˜æ–¹æ–‡æ¡£

- **Kubernetes Security**: https://kubernetes.io/docs/concepts/security/
- **Pod Security Standards**: https://kubernetes.io/docs/concepts/security/pod-security-standards/
- **CIS Benchmark**: https://www.cisecurity.org/benchmark/kubernetes
- **NSA/CISA Hardening Guide**: https://media.defense.gov/2022/Aug/29/2003066362/-1/-1/0/CTR_KUBERNETES_HARDENING_GUIDANCE_1.2_20220829.PDF

### å·¥å…·èµ„æº

- **Trivy**: https://github.com/aquasecurity/trivy
- **Falco**: https://falco.org
- **Kube-bench**: https://github.com/aquasecurity/kube-bench
- **OPA Gatekeeper**: https://open-policy-agent.github.io/gatekeeper/
- **Kyverno**: https://kyverno.io

### æœ€ä½³å®è·µ

- **OWASP Container Security**: https://owasp.org/www-project-docker-top-10/
- **NIST Container Security**: https://csrc.nist.gov/publications/detail/sp/800-190/final
- **CIS Docker Benchmark**: https://www.cisecurity.org/benchmark/docker

---

**æ–‡æ¡£å®Œæˆæ—¶é—´**: 2025-10-20 18:00:00  
**è¡Œæ•°**: ~2,400è¡Œ  
**çŠ¶æ€**: âœ… **å®Œæˆ**

---

**Container Security, Defense in Depth!** ğŸ”’ğŸ³âœ¨
