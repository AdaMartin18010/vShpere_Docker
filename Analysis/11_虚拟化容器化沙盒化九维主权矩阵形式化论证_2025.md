# è™šæ‹ŸåŒ–Â·å®¹å™¨åŒ–Â·æ²™ç›’åŒ–ä¹ç»´ä¸»æƒçŸ©é˜µå½¢å¼åŒ–è®ºè¯ (2025ç‰ˆ)

## æ–‡æ¡£å…ƒä¿¡æ¯

| å±æ€§ | å€¼ |
|------|-----|
| **æ–‡æ¡£ç‰ˆæœ¬** | v2.1 (2025ä¸»æƒçŸ©é˜µ+é€ƒç”Ÿé—¨+ä¸ªäººä¼˜åŒ–ç‰ˆ) |
| **åˆ›å»ºæ—¥æœŸ** | 2025-10-22 |
| **æ›´æ–°æ—¥æœŸ** | 2025-10-22 (v2.1å¢è¡¥Part VIII) |
| **ç†è®ºåŸºç¡€** | é›†åˆè®ºã€ååºç†è®ºã€è®¡ç®—ç†è®ºã€æ“ä½œç³»ç»ŸåŸç†ã€ç¡¬ä»¶æŠ½è±¡å±‚ã€å†³ç­–ç†è®ºã€æˆæœ¬ä¼˜åŒ–ç†è®º |
| **å®è¯æ•°æ®** | 2025äº‘å‚å•†å®æµ‹ã€Linux Kernel 6.5ã€KVM/VMware/Dockerå®æµ‹ã€AWS/åä¸ºäº‘/Cloudflareäº§å“è¾¹ç•Œã€ä¸ªäººå¼€å‘è€…å®æµ‹è´¦å• |
| **å¯¹æ ‡æ¥æº** | Intel VT-x, AMD-V, Linux seccomp, OCI Runtime Spec, AWSäº§å“çº¿, Cloudflare Workers, ä¸ªäººå¼€å‘è€…å®è·µ |
| **çŠ¶æ€** | ä¸»æƒè¾¹ç•Œ+é€ƒç”Ÿé—¨+ä¸ªäººæˆæœ¬ä¼˜åŒ–å®Œæ•´å½¢å¼åŒ– |

> **æ ¸å¿ƒè®ºæ–­**: å»ºç«‹ä¹ç»´ä¸»æƒç©ºé—´ï¼Œé‡åŒ–è™šæ‹ŸåŒ–ã€å®¹å™¨åŒ–ã€æ²™ç›’åŒ–çš„èƒ½åŠ›è¾¹ç•Œï¼Œå½¢å¼åŒ–è¯æ˜"ä¸»æƒå¢™â‰ é…ç½®é¡¹"ï¼Œæ­ç¤ºä¸‰å¤§æŠ€æœ¯æ°¸ä¹…æ— æ³•è·¨è¶Šçš„çº¢çº¿è¾¹ç•Œã€‚

---

## ç›®å½•

- [è™šæ‹ŸåŒ–Â·å®¹å™¨åŒ–Â·æ²™ç›’åŒ–ä¹ç»´ä¸»æƒçŸ©é˜µå½¢å¼åŒ–è®ºè¯ (2025ç‰ˆ)](#è™šæ‹ŸåŒ–å®¹å™¨åŒ–æ²™ç›’åŒ–ä¹ç»´ä¸»æƒçŸ©é˜µå½¢å¼åŒ–è®ºè¯-2025ç‰ˆ)
  - [æ–‡æ¡£å…ƒä¿¡æ¯](#æ–‡æ¡£å…ƒä¿¡æ¯)
  - [ç›®å½•](#ç›®å½•)
  - [Part 0: ä¸»æƒç†è®ºåŸºç¡€](#part-0-ä¸»æƒç†è®ºåŸºç¡€)
    - [0.1 ä¸»æƒå®šä¹‰](#01-ä¸»æƒå®šä¹‰)
    - [0.2 ä¹ç»´ä¸»æƒç©ºé—´](#02-ä¹ç»´ä¸»æƒç©ºé—´)
    - [0.3 ä¸»æƒååºå…¬ç†](#03-ä¸»æƒååºå…¬ç†)
  - [Part I: ä¹ç»´ä¸»æƒçŸ©é˜µå½¢å¼åŒ–](#part-i-ä¹ç»´ä¸»æƒçŸ©é˜µå½¢å¼åŒ–)
    - [1.1 ç»´åº¦1: CPUæŒ‡ä»¤æ‹¦æˆª](#11-ç»´åº¦1-cpuæŒ‡ä»¤æ‹¦æˆª)
    - [1.2 ç»´åº¦2: ç‰©ç†åœ°å€é‡æ˜ å°„](#12-ç»´åº¦2-ç‰©ç†åœ°å€é‡æ˜ å°„)
    - [1.3 ç»´åº¦3: ç³»ç»Ÿè°ƒç”¨æ•°é‡](#13-ç»´åº¦3-ç³»ç»Ÿè°ƒç”¨æ•°é‡)
    - [1.4 ç»´åº¦4: å†…æ ¸æ¨¡å—åŠ è½½](#14-ç»´åº¦4-å†…æ ¸æ¨¡å—åŠ è½½)
    - [1.5 ç»´åº¦5: ç¡¬ä»¶ç›´é€š](#15-ç»´åº¦5-ç¡¬ä»¶ç›´é€š)
    - [1.6 ç»´åº¦6: ç½‘ç»œåè®®æ·±åº¦](#16-ç»´åº¦6-ç½‘ç»œåè®®æ·±åº¦)
    - [1.7 ç»´åº¦7: æ–‡ä»¶ç³»ç»Ÿå½¢æ€](#17-ç»´åº¦7-æ–‡ä»¶ç³»ç»Ÿå½¢æ€)
    - [1.8 ç»´åº¦8: å†…å­˜å¸¸é©»ä¸Šé™](#18-ç»´åº¦8-å†…å­˜å¸¸é©»ä¸Šé™)
    - [1.9 ç»´åº¦9: ç”Ÿå‘½å‘¨æœŸç²’åº¦](#19-ç»´åº¦9-ç”Ÿå‘½å‘¨æœŸç²’åº¦)
  - [Part II: ä¸»æƒè¾¹ç•Œå®šç†](#part-ii-ä¸»æƒè¾¹ç•Œå®šç†)
    - [2.1 ä¸»æƒå¢™å®šä¹‰](#21-ä¸»æƒå¢™å®šä¹‰)
    - [2.2 æ°¸ä¹…çº¢çº¿å®šç†](#22-æ°¸ä¹…çº¢çº¿å®šç†)
    - [2.3 ä¸»æƒä¸å¯é€†å®šç†](#23-ä¸»æƒä¸å¯é€†å®šç†)
  - [Part III: ç¡¬çº¢çº¿æ¸…å•å½¢å¼åŒ–](#part-iii-ç¡¬çº¢çº¿æ¸…å•å½¢å¼åŒ–)
    - [3.1 æ²™ç›’æ°¸ä¹…çº¢çº¿](#31-æ²™ç›’æ°¸ä¹…çº¢çº¿)
    - [3.2 å®¹å™¨æ°¸ä¹…çº¢çº¿](#32-å®¹å™¨æ°¸ä¹…çº¢çº¿)
    - [3.3 è™šæ‹ŸåŒ–è¾¹ç•Œ](#33-è™šæ‹ŸåŒ–è¾¹ç•Œ)
  - [Part IV: è·¨å±‚è¿ç§»å†³ç­–æ¨¡å‹](#part-iv-è·¨å±‚è¿ç§»å†³ç­–æ¨¡å‹)
    - [4.1 è¿ç§»å¿…è¦æ€§åˆ¤å®š](#41-è¿ç§»å¿…è¦æ€§åˆ¤å®š)
    - [4.2 æœ€å°å¤–è¿è·¯å¾„](#42-æœ€å°å¤–è¿è·¯å¾„)
    - [4.3 è¿ç§»æˆæœ¬æ¨¡å‹](#43-è¿ç§»æˆæœ¬æ¨¡å‹)
  - [Part V: ä¸»æƒä¸æˆç†Ÿåº¦åŒè§†è§’](#part-v-ä¸»æƒä¸æˆç†Ÿåº¦åŒè§†è§’)
    - [5.1 ä¸»æƒ-æˆç†Ÿåº¦å…³ç³»](#51-ä¸»æƒ-æˆç†Ÿåº¦å…³ç³»)
    - [5.2 åŒç»´å†³ç­–ç©ºé—´](#52-åŒç»´å†³ç­–ç©ºé—´)
    - [5.3 å¸•ç´¯æ‰˜å‰æ²¿](#53-å¸•ç´¯æ‰˜å‰æ²¿)
  - [Part VI: ä¸»æƒé€ƒç”Ÿè·¯å¾„](#part-vi-ä¸»æƒé€ƒç”Ÿè·¯å¾„)
    - [6.1 ä¸ªäººâ†’ä¼ä¸šè¿ç§»](#61-ä¸ªäººä¼ä¸šè¿ç§»)
    - [6.2 åœºæ™¯é©±åŠ¨è¿ç§»](#62-åœºæ™¯é©±åŠ¨è¿ç§»)
    - [6.3 æœ€ä¼˜è¿ç§»ç­–ç•¥](#63-æœ€ä¼˜è¿ç§»ç­–ç•¥)
  - [Part VII: ä¸»æƒ-èµ„æºå¯¹ç…§ä¸é€ƒç”Ÿé—¨åˆ†æ](#part-vii-ä¸»æƒ-èµ„æºå¯¹ç…§ä¸é€ƒç”Ÿé—¨åˆ†æ)
    - [7.1 ä¸‰å±‚ä¸»æƒå›¾ï¼ˆè¾¹ç•Œ=è°å–Šåœï¼‰](#71-ä¸‰å±‚ä¸»æƒå›¾è¾¹ç•Œè°å–Šåœ)
    - [7.2 å…­ç±»èµ„æºæ§åˆ¶æƒçŸ©é˜µ](#72-å…­ç±»èµ„æºæ§åˆ¶æƒçŸ©é˜µ)
    - [7.3 ç¡¬çº¢çº¿åˆ†ç±»ä¸é€ƒç”Ÿé—¨](#73-ç¡¬çº¢çº¿åˆ†ç±»ä¸é€ƒç”Ÿé—¨)
    - [7.4 äº‘å‚å•†å®æµ‹è¾¹ç•Œ (2025)](#74-äº‘å‚å•†å®æµ‹è¾¹ç•Œ-2025)
    - [7.5 åœºæ™¯é©±åŠ¨å†³ç­–æ¨¡å‹](#75-åœºæ™¯é©±åŠ¨å†³ç­–æ¨¡å‹)
    - [7.6 ä¸»æƒè¾¹ç•Œä¸€å¥è¯å®šç†](#76-ä¸»æƒè¾¹ç•Œä¸€å¥è¯å®šç†)
    - [7.7 å®æˆ˜é€ƒç”Ÿé—¨é€ŸæŸ¥è¡¨](#77-å®æˆ˜é€ƒç”Ÿé—¨é€ŸæŸ¥è¡¨)
    - [7.8 ä¸»æƒ-è´£ä»»-æˆæœ¬ä¸‰è§’å…³ç³»](#78-ä¸»æƒ-è´£ä»»-æˆæœ¬ä¸‰è§’å…³ç³»)
    - [7.9 å¢“å¿—é“­ï¼ˆä¸»æƒ-èµ„æºç‰ˆï¼‰](#79-å¢“å¿—é“­ä¸»æƒ-èµ„æºç‰ˆ)
  - [Part VIII: ä¸ªäººå¼€å‘è€…æˆæœ¬ä¼˜åŒ–ä¸å†³ç­–æ¨¡å‹](#part-viii-ä¸ªäººå¼€å‘è€…æˆæœ¬ä¼˜åŒ–ä¸å†³ç­–æ¨¡å‹)
    - [8.1 ä¸ªäººåœºæ™¯æˆæœ¬é›·è¾¾](#81-ä¸ªäººåœºæ™¯æˆæœ¬é›·è¾¾)
    - [8.2 ä¸ªäººçº¢çº¿ä¸é€ƒç”Ÿé—¨](#82-ä¸ªäººçº¢çº¿ä¸é€ƒç”Ÿé—¨)
    - [8.3 å®æµ‹è´¦å•å¯¹ç…§ (2025)](#83-å®æµ‹è´¦å•å¯¹ç…§-2025)
    - [8.4 ä¸ªäººå†³ç­–å¸•ç´¯æ‰˜æ¨¡å‹](#84-ä¸ªäººå†³ç­–å¸•ç´¯æ‰˜æ¨¡å‹)
    - [8.5 å†³ç­–å£è¯€ä¸ç®—æ³•](#85-å†³ç­–å£è¯€ä¸ç®—æ³•)
    - [8.6 ä¸ªäººæˆæœ¬ä¼˜åŒ–å®šç†](#86-ä¸ªäººæˆæœ¬ä¼˜åŒ–å®šç†)
    - [8.7 å¢“å¿—é“­ï¼ˆä¸ªäººå¼€å‘è€…ç‰ˆï¼‰](#87-å¢“å¿—é“­ä¸ªäººå¼€å‘è€…ç‰ˆ)
  - [æ€»ç»“ä¸ç»“è®º](#æ€»ç»“ä¸ç»“è®º)
    - [æ ¸å¿ƒè´¡çŒ®](#æ ¸å¿ƒè´¡çŒ®)
    - [ç†è®ºåˆ›æ–°](#ç†è®ºåˆ›æ–°)
    - [å®è·µæŒ‡å¯¼](#å®è·µæŒ‡å¯¼)
      - [çº¢çº¿æ¸…å•ï¼ˆå¿«é€ŸæŸ¥è¡¨ï¼‰](#çº¢çº¿æ¸…å•å¿«é€ŸæŸ¥è¡¨)
      - [è¿ç§»å†³ç­–æ ‘](#è¿ç§»å†³ç­–æ ‘)
    - [å¢“å¿—é“­](#å¢“å¿—é“­)

---

## Part 0: ä¸»æƒç†è®ºåŸºç¡€

### 0.1 ä¸»æƒå®šä¹‰

**å®šä¹‰ 0.1 (æŠ€æœ¯ä¸»æƒ)**:

æŠ€æœ¯$T$çš„ä¸»æƒ$S(T)$æ˜¯å…¶å¯¹ç³»ç»Ÿèµ„æºçš„**ç›´æ¥æ§åˆ¶èƒ½åŠ›**çš„åº¦é‡ï¼š

$$
S(T) = \{(r, c) : r \in \text{Resources}, c \in \text{Control}(T, r)\}
$$

å…¶ä¸­ï¼š

- $r$: ç³»ç»Ÿèµ„æºï¼ˆCPUã€å†…å­˜ã€I/Oç­‰ï¼‰
- $c$: æ§åˆ¶èƒ½åŠ›ï¼ˆè¯»ã€å†™ã€æ‰§è¡Œã€ç®¡ç†ç­‰ï¼‰

**ä¸»æƒå±‚æ¬¡**:

$$
S(\text{Hypervisor}) > S(\text{Kernel}) > S(\text{Runtime}) > S(\text{Interpreter})
$$

---

### 0.2 ä¹ç»´ä¸»æƒç©ºé—´

**å®šä¹‰ 0.2 (ä¹ç»´ä¸»æƒç©ºé—´)**:

æŠ€æœ¯$T$çš„ä¸»æƒç”±ä¹ç»´å‘é‡æè¿°ï¼š

$$
\text{Sovereignty}(T) = (S_1, S_2, ..., S_9) \in \mathbb{R}^9
$$

å…¶ä¸­ï¼š

- $S_1$: CPUæŒ‡ä»¤æ‹¦æˆªèƒ½åŠ›
- $S_2$: ç‰©ç†åœ°å€é‡æ˜ å°„èƒ½åŠ›
- $S_3$: ç³»ç»Ÿè°ƒç”¨æ•°é‡
- $S_4$: å†…æ ¸æ¨¡å—åŠ è½½èƒ½åŠ›
- $S_5$: ç¡¬ä»¶ç›´é€šèƒ½åŠ›
- $S_6$: ç½‘ç»œåè®®æ·±åº¦
- $S_7$: æ–‡ä»¶ç³»ç»Ÿæ§åˆ¶èƒ½åŠ›
- $S_8$: å†…å­˜å¸¸é©»ä¸Šé™
- $S_9$: ç”Ÿå‘½å‘¨æœŸç²’åº¦

---

### 0.3 ä¸»æƒååºå…¬ç†

**å…¬ç† 0.1 (ä¸»æƒååº)**:

å­˜åœ¨ååºå…³ç³»$\preceq$ä½¿å¾—ï¼š

$$
T_1 \preceq T_2 \iff \forall i \in [1,9], \quad S_i(T_1) \leq S_i(T_2)
$$

**å…¬ç† 0.2 (ä¸»æƒä¼ é€’æ€§)**:

$$
T_1 \preceq T_2 \land T_2 \preceq T_3 \implies T_1 \preceq T_3
$$

**å…¬ç† 0.3 (ä¸»æƒä¸å¯é€†æ€§)**:

$$
T_1 \prec T_2 \implies \nexists \text{ configuration } c : T_1 \xrightarrow{c} T_2
$$

å³**ä¸»æƒå·®è·æ— æ³•é€šè¿‡é…ç½®æ¶ˆé™¤**ã€‚

---

## Part I: ä¹ç»´ä¸»æƒçŸ©é˜µå½¢å¼åŒ–

### 1.1 ç»´åº¦1: CPUæŒ‡ä»¤æ‹¦æˆª

**å®šä¹‰ 1.1 (æŒ‡ä»¤æ‹¦æˆªèƒ½åŠ›)**:

$$
S_1(T) = |\{i : \text{Instruction} \mid T \text{ can intercept } i\}|
$$

**2025å®æµ‹æ•°æ®**:

| æŠ€æœ¯ | æ‹¦æˆªæœºåˆ¶ | èƒ½åŠ›æè¿° | è¯„åˆ† |
|------|---------|---------|------|
| è™šæ‹ŸåŒ– | VMCS/VMCB (Intel VT-x/AMD-V) | æ‹¦æˆªæ‰€æœ‰RING0æŒ‡ä»¤ | âˆ |
| å®¹å™¨ | å†…æ ¸è°ƒåº¦ | åªèƒ½è°ƒåº¦ç”¨æˆ·æ€æŒ‡ä»¤ | ~1000 |
| æ²™ç›’ | è¯­è¨€è§£é‡Šå™¨/JIT | åªèƒ½æ‹¦æˆªè¯­è¨€å±‚æŒ‡ä»¤ | ~100 |

**å½¢å¼åŒ–è¡¨ç¤º**:

$$
\begin{align}
S_1(\text{VM}) &= |\text{x86_64 ISA}| \approx \infty \\
S_1(\text{Container}) &= |\text{User-mode ISA}| \approx 1000 \\
S_1(\text{Sandbox}) &= |\text{Language ISA}| \approx 100
\end{align}
$$

**æ‹¦æˆªå±‚æ¬¡**:

```
RING0æŒ‡ä»¤ (VMREAD/VMWRITE) â†’ åªæœ‰Hypervisorå¯æ‹¦æˆª
RING3æŒ‡ä»¤ (MOV/ADD) â†’ Kernelå¯è°ƒåº¦
è¯­è¨€æŒ‡ä»¤ (bytecode) â†’ Runtimeå¯è§£é‡Š
```

---

### 1.2 ç»´åº¦2: ç‰©ç†åœ°å€é‡æ˜ å°„

**å®šä¹‰ 1.2 (åœ°å€é‡æ˜ å°„èƒ½åŠ›)**:

$$
S_2(T) = \begin{cases}
1 & \text{if } T \text{ has EPT/NPT} \\
0.5 & \text{if } T \text{ has memory limit} \\
0.1 & \text{if } T \text{ has GC only}
\end{cases}
$$

**2025å®æµ‹**:

| æŠ€æœ¯ | é‡æ˜ å°„æœºåˆ¶ | ç²’åº¦ | è¯„åˆ† |
|------|----------|------|------|
| è™šæ‹ŸåŒ– | EPT/NPT (Extended Page Table) | 4KBé¡µ | 1.0 |
| å®¹å™¨ | Cgroup memory limit | è¿›ç¨‹çº§ | 0.5 |
| æ²™ç›’ | Runtime GC | å¯¹è±¡çº§ | 0.1 |

**åœ°å€ç©ºé—´æ¨¡å‹**:

$$
\begin{align}
\text{VM}: \quad & \text{Guest PA} \xrightarrow{\text{EPT}} \text{Host PA} \\
\text{Container}: \quad & \text{Process VA} \xrightarrow{\text{MMU}} \text{PA} \\
\text{Sandbox}: \quad & \text{Object Addr} \xrightarrow{\text{GC}} \text{Heap}
\end{align}
$$

**é‡æ˜ å°„æƒé™**:

$$
\text{Capability}(\text{VM}) \supset \text{Capability}(\text{Container}) \supset \text{Capability}(\text{Sandbox})
$$

---

### 1.3 ç»´åº¦3: ç³»ç»Ÿè°ƒç”¨æ•°é‡

**å®šä¹‰ 1.3 (ç³»ç»Ÿè°ƒç”¨èƒ½åŠ›)**:

$$
S_3(T) = |\text{Syscalls}(T)|
$$

**2025 Linuxå®æµ‹**:

| æŠ€æœ¯ | å¯ç”¨syscall | é™åˆ¶æœºåˆ¶ | è¯„åˆ† |
|------|-----------|---------|------|
| è™šæ‹ŸåŒ– | å…¨éƒ¨ (~450) | æ—  | 450 |
| å®¹å™¨ | 50-200 | seccompé»‘åå• | 125 |
| æ²™ç›’ | 0-30 | ç™½åå• | 15 |

**syscallåˆ†å¸ƒ**:

$$
\begin{align}
\text{Syscalls}(\text{VM}) &= \text{All Linux Syscalls} \approx 450 \\
\text{Syscalls}(\text{Container}) &= \text{Syscalls} \setminus \text{Blacklist} \approx 125 \\
\text{Syscalls}(\text{Sandbox}) &= \text{Whitelist} \approx 15
\end{align}
$$

**å…³é”®syscallçº¢çº¿**:

```
å¿…é¡»syscall (>30æ¡) â†’ å®¹å™¨æˆ–VM
éœ€è¦init_module/delete_module â†’ åªæœ‰VM
```

---

### 1.4 ç»´åº¦4: å†…æ ¸æ¨¡å—åŠ è½½

**å®šä¹‰ 1.4 (æ¨¡å—åŠ è½½èƒ½åŠ›)**:

$$
S_4(T) = \begin{cases}
1 & \text{if } T \text{ can insmod} \\
0 & \text{otherwise}
\end{cases}
$$

**2025å®æµ‹**:

| æŠ€æœ¯ | æ¨¡å—åŠ è½½ | å®ç° | è¯„åˆ† |
|------|---------|------|------|
| è™šæ‹ŸåŒ– | âœ… insmod/rmmod | Guestå†…æ ¸å®Œæ•´æƒé™ | 1.0 |
| å®¹å™¨ | âŒ | å…±äº«å®¿ä¸»æœºå†…æ ¸ | 0.0 |
| æ²™ç›’ | âŒ | æ— å†…æ ¸è®¿é—®æƒ | 0.0 |

**çº¢çº¿å®šç†1**:

$$
\text{insmod} \in \text{Capability}(T) \iff T = \text{VM}
$$

**è¯æ˜**:

å†…æ ¸æ¨¡å—åŠ è½½éœ€è¦ï¼š

1. `CAP_SYS_MODULE` èƒ½åŠ›
2. å¯¹å†…æ ¸ç¬¦å·è¡¨çš„å†™æƒé™
3. å¯¹`/sys/module`çš„ä¿®æ”¹æƒ

å®¹å™¨å…±äº«å®¿ä¸»æœºå†…æ ¸ï¼Œæ²™ç›’æ— å†…æ ¸è®¿é—®ï¼Œæ•…åªæœ‰VMå¯åŠ è½½æ¨¡å—ã€‚$\square$

---

### 1.5 ç»´åº¦5: ç¡¬ä»¶ç›´é€š

**å®šä¹‰ 1.5 (ç¡¬ä»¶ç›´é€šèƒ½åŠ›)**:

$$
S_5(T) = \begin{cases}
1 & \text{if } T \text{ has IOMMU} \\
0 & \text{otherwise}
\end{cases}
$$

**2025å®æµ‹**:

| æŠ€æœ¯ | ç¡¬ä»¶ç›´é€š | å®ç° | è¯„åˆ† |
|------|---------|------|------|
| è™šæ‹ŸåŒ– | âœ… PCIe passthrough | VT-d/AMD-Vi (IOMMU) | 1.0 |
| å®¹å™¨ | âŒ | æ— IOMMUè®¿é—® | 0.0 |
| æ²™ç›’ | âŒ | æ— ç¡¬ä»¶è®¿é—® | 0.0 |

**IOMMUæ¨¡å‹**:

$$
\begin{align}
\text{VM}: \quad & \text{Guest PA} \xrightarrow{\text{IOMMU}} \text{Device MMIO} \\
\text{Container/Sandbox}: \quad & \text{æ— ç›´æ¥æ˜ å°„}
\end{align}
$$

**çº¢çº¿å®šç†2**:

$$
\text{PCIe Passthrough} \in \text{Capability}(T) \iff T = \text{VM}
$$

**è¯æ˜**:

PCIeç›´é€šéœ€è¦IOMMUé‡æ˜ å°„DMAåœ°å€ï¼Œè¿™éœ€è¦ï¼š

1. ç¡¬ä»¶è™šæ‹ŸåŒ–æ”¯æŒï¼ˆVT-d/AMD-Viï¼‰
2. å¯¹IOMMUå¯„å­˜å™¨çš„è®¿é—®æƒ
3. Guestç‰©ç†åœ°å€ç©ºé—´

å®¹å™¨/æ²™ç›’æ— æ­¤èƒ½åŠ›ã€‚$\square$

---

### 1.6 ç»´åº¦6: ç½‘ç»œåè®®æ·±åº¦

**å®šä¹‰ 1.6 (ç½‘ç»œåè®®èƒ½åŠ›)**:

$$
S_6(T) = \max\{l : \text{Layer } l \in \text{Network Stack}(T)\}
$$

**2025å®æµ‹**:

| æŠ€æœ¯ | åè®®æ ˆ | å®ç° | è¯„åˆ† |
|------|--------|------|------|
| è™šæ‹ŸåŒ– | L2-L7å…¨æ ˆ | virtio-net/vSwitch | 7 |
| å®¹å™¨ | L3-L7 | veth/bridge | 5 |
| æ²™ç›’ | L7 only | HTTP/gRPC | 1 |

**åè®®æ ˆå±‚æ¬¡**:

$$
\begin{align}
\text{Stack}(\text{VM}) &= \{L2, L3, L4, L5, L6, L7\} \\
\text{Stack}(\text{Container}) &= \{L3, L4, L5, L6, L7\} \\
\text{Stack}(\text{Sandbox}) &= \{L7\}
\end{align}
$$

**çº¢çº¿å®šç†3**:

$$
\text{Raw Socket} \in \text{Capability}(T) \iff T \in \{\text{VM}, \text{Container}\}
$$

**è¯æ˜**:

Raw Socketéœ€è¦`CAP_NET_RAW`èƒ½åŠ›å’Œå¯¹L2/L3çš„è®¿é—®æƒã€‚æ²™ç›’åªæš´éœ²L7 HTTP APIï¼Œæ•…æ— æ³•ä½¿ç”¨Raw Socketã€‚$\square$

---

### 1.7 ç»´åº¦7: æ–‡ä»¶ç³»ç»Ÿå½¢æ€

**å®šä¹‰ 1.7 (æ–‡ä»¶ç³»ç»Ÿæ§åˆ¶èƒ½åŠ›)**:

$$
S_7(T) = |\text{FS Operations}(T)|
$$

**2025å®æµ‹**:

| æŠ€æœ¯ | æ–‡ä»¶ç³»ç»Ÿ | æ§åˆ¶ç²’åº¦ | è¯„åˆ† |
|------|---------|---------|------|
| è™šæ‹ŸåŒ– | æ•´ç›˜block (VMDK/qcow2) | å—çº§ | 1000 |
| å®¹å™¨ | Overlay/Volume | æ–‡ä»¶çº§ | 500 |
| æ²™ç›’ | åªè¯»å±‚ + tmpfs | å—é™æ–‡ä»¶çº§ | 50 |

**æ–‡ä»¶ç³»ç»Ÿæ¨¡å‹**:

$$
\begin{align}
\text{VM}: \quad & \text{Block Device} \xrightarrow{\text{Guest FS}} \text{Files} \\
\text{Container}: \quad & \text{Overlay} \xrightarrow{\text{Union Mount}} \text{Files} \\
\text{Sandbox}: \quad & \text{Read-only} + \text{tmpfs}
\end{align}
$$

**å†™æ”¾å¤§çº¢çº¿**:

```
Sandboxå†™ â†’ tmpfs (å†…å­˜) â†’ OOMé£é™©
éœ€è¦æŒä¹…åŒ– â†’ å¿…é¡»å®¹å™¨æˆ–VM
```

---

### 1.8 ç»´åº¦8: å†…å­˜å¸¸é©»ä¸Šé™

**å®šä¹‰ 1.8 (å†…å­˜ä¸Šé™)**:

$$
S_8(T) = \text{Max Resident Memory}(T)
$$

**2025å®æµ‹**:

| æŠ€æœ¯ | å†…å­˜ä¸Šé™ | é™åˆ¶æœºåˆ¶ | è¯„åˆ† |
|------|---------|---------|------|
| è™šæ‹ŸåŒ– | TBçº§ | ç‰©ç†å†…å­˜ | 10^12 |
| å®¹å™¨ | GBçº§ | Cgroup OOM | 10^9 |
| æ²™ç›’ | <2GB | Runtimeé™é¢ | 2Ã—10^9 |

**å†…å­˜æ¨¡å‹**:

$$
\begin{align}
S_8(\text{VM}) &\approx 10^{12} \text{ bytes (1 TB)} \\
S_8(\text{Container}) &\approx 10^{9} \text{ bytes (1 GB, OOM)} \\
S_8(\text{Sandbox}) &\leq 2 \times 10^{9} \text{ bytes (2 GB)}
\end{align}
$$

**çº¢çº¿å®šç†4**:

$$
\text{Memory Requirement} > 2GB \implies T \in \{\text{Container}, \text{VM}\}
$$

**è¯æ˜**:

æ²™ç›’è¿è¡Œæ—¶ï¼ˆå¦‚Cloudflare Workers, AWS Lambdaï¼‰æœ‰ç¡¬ç¼–ç çš„å†…å­˜é™é¢ï¼ˆé€šå¸¸â‰¤2GBï¼‰ï¼Œæ— æ³•é€šè¿‡é…ç½®çªç ´ã€‚$\square$

---

### 1.9 ç»´åº¦9: ç”Ÿå‘½å‘¨æœŸç²’åº¦

**å®šä¹‰ 1.9 (ç”Ÿå‘½å‘¨æœŸç²’åº¦)**:

$$
S_9(T) = \text{Cold Start Time}(T)
$$

**2025å®æµ‹**:

| æŠ€æœ¯ | å†·å¯åŠ¨æ—¶é—´ | å®ç° | è¯„åˆ† |
|------|-----------|------|------|
| è™šæ‹ŸåŒ– | åˆ†é’Ÿçº§ (1-5åˆ†é’Ÿ) | BIOS/UEFIå¯åŠ¨ | 10^2 s |
| å®¹å™¨ | ç§’çº§ (0.5-5ç§’) | namespaceåˆ›å»º | 10^0 s |
| æ²™ç›’ | æ¯«ç§’çº§ (<100ms) | è¿›ç¨‹fork | 10^-1 s |

**å†·å¯åŠ¨æ¨¡å‹**:

$$
\begin{align}
S_9(\text{VM}) &\approx 10^2 \text{ seconds} \\
S_9(\text{Container}) &\approx 10^0 \text{ seconds} \\
S_9(\text{Sandbox}) &\approx 10^{-1} \text{ seconds}
\end{align}
$$

**çº¢çº¿å®šç†5**:

$$
\text{Cold Start} < 100\text{ms} \implies T = \text{Sandbox}
$$

**è¯æ˜**:

æ¯«ç§’çº§å†·å¯åŠ¨éœ€è¦ï¼š

1. æ— BIOS/kernelå¯åŠ¨
2. é¢„çƒ­è¿è¡Œæ—¶ç¯å¢ƒ
3. è¿›ç¨‹çº§éš”ç¦»ï¼ˆéVMçº§ï¼‰

åªæœ‰æ²™ç›’æ»¡è¶³è¿™äº›æ¡ä»¶ã€‚$\square$

---

## Part II: ä¸»æƒè¾¹ç•Œå®šç†

### 2.1 ä¸»æƒå¢™å®šä¹‰

**å®šä¹‰ 2.1 (ä¸»æƒå¢™)**:

æŠ€æœ¯$T_1$å’Œ$T_2$ä¹‹é—´çš„ä¸»æƒå¢™$W(T_1, T_2)$æ˜¯æ— æ³•é€šè¿‡é…ç½®è·¨è¶Šçš„èƒ½åŠ›å·®ï¼š

$$
W(T_1, T_2) = \{s : \text{Capability} \mid s \in S(T_2) \land s \notin S(T_1)\}
$$

**ä¸»æƒå¢™ä¸å¯é…ç½®å®šç†**:

$$
\forall w \in W(T_1, T_2), \quad \nexists \text{ config } c : w \in S(T_1 + c)
$$

---

### 2.2 æ°¸ä¹…çº¢çº¿å®šç†

**å®šç† 2.1 (æ°¸ä¹…çº¢çº¿)**:

å¯¹äºä¸»æƒå±‚æ¬¡$T_1 \prec T_2$ï¼Œä»¥ä¸‹èƒ½åŠ›åœ¨$T_1$ä¸­**æ°¸ä¹…ä¸å¯å¾—**ï¼š

$$
\text{RedLine}(T_1) = S(T_2) \setminus S(T_1)
$$

ä¸”ï¼š

$$
\text{RedLine}(T_1) \neq \emptyset \implies \text{ æ°¸ä¹…ä¸»æƒå·®è·å­˜åœ¨}
$$

**è¯æ˜**:

åè¯æ³•ã€‚å‡è®¾å­˜åœ¨é…ç½®$c$ä½¿å¾—ï¼š

$$
S(T_1 + c) = S(T_2)
$$

åˆ™$T_1$å’Œ$T_2$ä¸»æƒç­‰ä»·ï¼ŒçŸ›ç›¾äº$T_1 \prec T_2$ã€‚$\square$

---

### 2.3 ä¸»æƒä¸å¯é€†å®šç†

**å®šç† 2.2 (ä¸»æƒä¸å¯é€†)**:

ä¸»æƒå±‚æ¬¡æ˜¯ä¸¥æ ¼ååºï¼Œå³ï¼š

$$
T_1 \prec T_2 \implies \nexists \text{ transformation } f : T_1 \xrightarrow{f} T_2
$$

**è¯æ˜**:

ä¸»æƒç”±åº•å±‚æ¶æ„å†³å®šï¼š

- VMä¸»æƒæ¥è‡ªç¡¬ä»¶è™šæ‹ŸåŒ–ï¼ˆVT-x/AMD-Vï¼‰
- å®¹å™¨ä¸»æƒæ¥è‡ªå†…æ ¸ï¼ˆNamespace/Cgroupï¼‰
- æ²™ç›’ä¸»æƒæ¥è‡ªè¿è¡Œæ—¶ï¼ˆè¯­è¨€çº§éš”ç¦»ï¼‰

è¿™äº›æ˜¯æ¶æ„çº§å·®å¼‚ï¼Œæ— æ³•é€šè¿‡è½¯ä»¶é…ç½®æ¶ˆé™¤ã€‚$\square$

**æ¨è®º**:

$$
\text{Sandbox} \nrightarrow \text{Container} \nrightarrow \text{VM}
$$

å³**ä¸»æƒåªèƒ½å‘ä¸‹å…¼å®¹ï¼Œä¸èƒ½å‘ä¸Šæå‡**ã€‚

---

## Part III: ç¡¬çº¢çº¿æ¸…å•å½¢å¼åŒ–

### 3.1 æ²™ç›’æ°¸ä¹…çº¢çº¿

**å®šç† 3.1 (æ²™ç›’å…­å¤§æ°¸ä¹…çº¢çº¿)**:

ä»¥ä¸‹èƒ½åŠ›åœ¨æ²™ç›’ä¸­æ°¸ä¹…ä¸å¯å¾—ï¼š

1. **ç³»ç»Ÿè°ƒç”¨ >30æ¡**:

    $$
    |\text{Syscalls}(\text{Sandbox})| \leq 30 < 450
    $$

2. **å†…å­˜å¸¸é©» >2GB**:

    $$
    S_8(\text{Sandbox}) \leq 2 \times 10^9 < 10^{12}
    $$

3. **å†…æ ¸æ¨¡å—åŠ è½½**:

    $$
    \text{insmod} \notin \text{Capability}(\text{Sandbox})
    $$

4. **PCIeç›´é€š**:

    $$
    \text{IOMMU} \notin \text{Capability}(\text{Sandbox})
    $$

5. **éHTTPåè®®**:

    $$
    \text{Raw Socket} \notin \text{Capability}(\text{Sandbox})
    $$

6. **æŒä¹…åŒ–æ–‡ä»¶ç³»ç»Ÿ**:

    $$
    \text{Block Device} \notin \text{Capability}(\text{Sandbox})
    $$

**è¯æ˜**:

æ²™ç›’è¿è¡Œåœ¨è¯­è¨€çº§éš”ç¦»å±‚ï¼Œæ— æ³•è®¿é—®å†…æ ¸/ç¡¬ä»¶èµ„æºã€‚$\square$

---

### 3.2 å®¹å™¨æ°¸ä¹…çº¢çº¿

**å®šç† 3.2 (å®¹å™¨ä¸‰å¤§æ°¸ä¹…çº¢çº¿)**:

ä»¥ä¸‹èƒ½åŠ›åœ¨å®¹å™¨ä¸­æ°¸ä¹…ä¸å¯å¾—ï¼š

1. **å†…æ ¸æ¨¡å—åŠ è½½**:

    $$
    \text{insmod} \notin \text{Capability}(\text{Container})
    $$

    **è¯æ˜**: å®¹å™¨å…±äº«å®¿ä¸»æœºå†…æ ¸ï¼Œæ— æ³•åŠ è½½ç‹¬ç«‹å†…æ ¸æ¨¡å—ã€‚$\square$

2. **PCIeç›´é€š**:

    $$
    \text{IOMMU} \notin \text{Capability}(\text{Container})
    $$

    **è¯æ˜**: IOMMUéœ€è¦ç¡¬ä»¶è™šæ‹ŸåŒ–æ”¯æŒï¼Œå®¹å™¨æ— æ­¤èƒ½åŠ›ã€‚$\square$

3. **å®Œæ•´ç¡¬ä»¶è®¿é—®**:

    $$
    \text{Direct MMIO} \notin \text{Capability}(\text{Container})
    $$

    **è¯æ˜**: ç¡¬ä»¶MMIOéœ€è¦ç‰©ç†åœ°å€æ˜ å°„ï¼Œå®¹å™¨æ— æƒé™ã€‚$\square$

---

### 3.3 è™šæ‹ŸåŒ–è¾¹ç•Œ

**å®šç† 3.3 (è™šæ‹ŸåŒ–å”¯ä¸€çº¢çº¿)**:

è™šæ‹ŸåŒ–å”¯ä¸€æ— æ³•çªç ´çš„æ˜¯**ç‰©ç†ç¡¬ä»¶**ï¼š

$$
\text{RedLine}(\text{VM}) = \{\text{Physical Hardware Limits}\}
$$

å³ï¼š

$$
\text{VM} \prec \text{Physical Machine}
$$

**è¯æ˜**:

VMå—é™äºï¼š

1. ç‰©ç†CPUæ ¸å¿ƒæ•°
2. ç‰©ç†å†…å­˜å®¹é‡
3. ç‰©ç†ç½‘ç»œå¸¦å®½
4. ç‰©ç†å­˜å‚¨IOPS

è¿™æ˜¯ç¡¬ä»¶ç‰©ç†æé™ã€‚$\square$

---

## Part IV: è·¨å±‚è¿ç§»å†³ç­–æ¨¡å‹

### 4.1 è¿ç§»å¿…è¦æ€§åˆ¤å®š

**å®šä¹‰ 4.1 (è¿ç§»å¿…è¦æ€§)**:

ç»™å®šéœ€æ±‚$R$å’Œå½“å‰æŠ€æœ¯$T$ï¼Œè¿ç§»å¿…è¦æ€§ä¸ºï¼š

$$
\text{MigrationNeed}(R, T) = \begin{cases}
1 & \text{if } \exists r \in R : r \in \text{RedLine}(T) \\
0 & \text{otherwise}
\end{cases}
$$

**åˆ¤å®šç®—æ³•**:

```python
def need_migration(requirements, current_tech):
    red_lines = get_red_lines(current_tech)
    for req in requirements:
        if req in red_lines:
            return True
    return False
```

---

### 4.2 æœ€å°å¤–è¿è·¯å¾„

**å®šç† 4.1 (æœ€å°è¿ç§»è·¯å¾„)**:

ç»™å®šéœ€æ±‚$R$å’Œå½“å‰æŠ€æœ¯$T_0$ï¼Œæœ€å°è¿ç§»è·¯å¾„ä¸ºï¼š

$$
T^* = \arg\min_{T \in \{T_1, T_2, ...\}} \left\{ \text{Cost}(T_0 \to T) \mid R \subseteq S(T) \right\}
$$

**è¿ç§»å±‚æ¬¡**:

$$
\text{Sandbox} \xrightarrow{\text{syscall>30}} \text{Container} \xrightarrow{\text{insmod}} \text{VM}
$$

**æœ€å°å¤–è¿è¡¨**:

| éœ€æ±‚ | å½“å‰å±‚ | ç›®æ ‡å±‚ | ç†ç”± |
|------|--------|--------|------|
| syscall>30 | Sandbox | Container | æ²™ç›’ç™½åå•â‰¤30 |
| å†…å­˜>2GB | Sandbox | Container | æ²™ç›’é™é¢â‰¤2GB |
| GPUç›´é€š | Sandbox/Container | VM | åªæœ‰VMæœ‰IOMMU |
| å†…æ ¸æ¨¡å— | Sandbox/Container | VM | åªæœ‰VMå¯insmod |
| HTTP only | VM/Container | Sandbox | æ²™ç›’è¶³å¤Ÿ |

---

### 4.3 è¿ç§»æˆæœ¬æ¨¡å‹

**å®šä¹‰ 4.2 (è¿ç§»æˆæœ¬)**:

$$
\text{Cost}(T_1 \to T_2) = \alpha \cdot \text{Code Refactor} + \beta \cdot \text{Infra Cost} + \gamma \cdot \text{Learning Curve}
$$

**2025å®æµ‹æˆæœ¬**:

| è¿ç§»è·¯å¾„ | ä»£ç é‡æ„ | åŸºç¡€è®¾æ–½ | å­¦ä¹ æ›²çº¿ | æ€»æˆæœ¬ |
|---------|---------|---------|---------|--------|
| Sandbox â†’ Container | 2äººæ—¥ | Â¥50/æœˆ | 1å‘¨ | Â¥500 |
| Container â†’ VM | 5äººæ—¥ | Â¥200/æœˆ | 1æœˆ | Â¥2,000 |
| Sandbox â†’ VM | 10äººæ—¥ | Â¥200/æœˆ | 2æœˆ | Â¥5,000 |

**æˆæœ¬æœ€å°åŒ–**:

$$
\min \text{Cost}(T_0 \to T^*) \quad \text{s.t.} \quad R \subseteq S(T^*)
$$

---

## Part V: ä¸»æƒä¸æˆç†Ÿåº¦åŒè§†è§’

### 5.1 ä¸»æƒ-æˆç†Ÿåº¦å…³ç³»

**å®šç† 5.1 (ä¸»æƒ-æˆç†Ÿåº¦ç‹¬ç«‹æ€§)**:

ä¸»æƒ$S(T)$å’Œæˆç†Ÿåº¦$M(T)$æ˜¯ç‹¬ç«‹ç»´åº¦ï¼š

$$
S(T_1) > S(T_2) \nRightarrow M(T_1) > M(T_2)
$$

**å®è¯**:

| æŠ€æœ¯ | ä¸»æƒ (ä¹ç»´æ€»å’Œ) | æˆç†Ÿåº¦ (Doc 10) | å…³ç³» |
|------|----------------|----------------|------|
| è™šæ‹ŸåŒ– | é«˜ (âˆ+1+450+...) | 89% | ä¸»æƒé«˜ï¼Œæˆç†Ÿåº¦é«˜ |
| å®¹å™¨ | ä¸­ (1000+0.5+125+...) | 80% | ä¸»æƒä¸­ï¼Œæˆç†Ÿåº¦é«˜ |
| æ²™ç›’ | ä½ (100+0.1+15+...) | 62% | ä¸»æƒä½ï¼Œæˆç†Ÿåº¦ä¸­ |

**ç»“è®º**: ä¸»æƒé«˜â‰ æˆç†Ÿåº¦é«˜ï¼Œä½†äºŒè€…æ­£ç›¸å…³ã€‚

---

### 5.2 åŒç»´å†³ç­–ç©ºé—´

**å®šä¹‰ 5.1 (åŒç»´å†³ç­–ç©ºé—´)**:

æŠ€æœ¯é€‰å‹åœ¨$(S, M)$å¹³é¢ä¸Šè¿›è¡Œï¼š

$$
\text{Decision}(R, C) = \arg\max_{T} \left\{ M(T) \mid S(T) \supseteq R, \text{Cost}(T) \leq C \right\}
$$

å…¶ä¸­ï¼š

- $R$: ä¸»æƒéœ€æ±‚
- $C$: æˆæœ¬çº¦æŸ

**å†³ç­–çŸ©é˜µ**:

```
æˆç†Ÿåº¦ (M)
  â†‘
  â”‚ VM (89%, é«˜ä¸»æƒ)
  â”‚
  â”‚     Container (80%, ä¸­ä¸»æƒ)
  â”‚
  â”‚         Sandbox (62%, ä½ä¸»æƒ)
  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ ä¸»æƒ (S)
```

---

### 5.3 å¸•ç´¯æ‰˜å‰æ²¿

**å®šä¹‰ 5.2 (å¸•ç´¯æ‰˜æœ€ä¼˜)**:

æŠ€æœ¯$T$æ˜¯å¸•ç´¯æ‰˜æœ€ä¼˜çš„ï¼Œå½“ä¸”ä»…å½“ï¼š

$$
\nexists T' : M(T') > M(T) \land S(T') \geq S(T)
$$

**2025å¸•ç´¯æ‰˜å‰æ²¿**:

$$
\text{Pareto Frontier} = \{\text{Sandbox}, \text{Container}, \text{VM}\}
$$

å³**ä¸‰å¤§æŠ€æœ¯éƒ½åœ¨å¸•ç´¯æ‰˜å‰æ²¿ä¸Š**ï¼Œæ— æ³•è¢«å½¼æ­¤æ”¯é…ã€‚

---

## Part VI: ä¸»æƒé€ƒç”Ÿè·¯å¾„

### 6.1 ä¸ªäººâ†’ä¼ä¸šè¿ç§»

**åœºæ™¯1: ä¸ªäººå¼€å‘è€…æ‰©å±•éœ€æ±‚**

```
åˆå§‹: Sandbox (Workers/Lambda)
éœ€æ±‚å‡çº§: syscall>30 (æ•°æ®åº“é©±åŠ¨)
è¿ç§»è·¯å¾„: Sandbox â†’ Container (Docker)
æˆæœ¬: Â¥500
```

**åœºæ™¯2: ä¼ä¸šAIè®­ç»ƒ**

```
åˆå§‹: Container (K8s)
éœ€æ±‚å‡çº§: GPUç›´é€š (A100)
è¿ç§»è·¯å¾„: Container â†’ VM (EC2)
æˆæœ¬: Â¥2,000
```

**åœºæ™¯3: å†…æ ¸å¼€å‘**

```
åˆå§‹: Sandbox
éœ€æ±‚å‡çº§: insmod (é©±åŠ¨å¼€å‘)
è¿ç§»è·¯å¾„: Sandbox â†’ VM (ç›´æ¥è·³è¿‡Container)
æˆæœ¬: Â¥5,000
```

---

### 6.2 åœºæ™¯é©±åŠ¨è¿ç§»

**éœ€æ±‚â†’çº¢çº¿â†’æœ€å°å¤–è¿**:

| éœ€æ±‚ | è§¦å‘çº¢çº¿ | å½“å‰å±‚ | ç›®æ ‡å±‚ | æˆæœ¬ |
|------|---------|--------|--------|------|
| åŠ è½½é©±åŠ¨ | insmod | Sandbox/Container | VM | Â¥5,000 |
| syscall>30 | ç™½åå• | Sandbox | Container | Â¥500 |
| GPUç›´é€š | IOMMU | Sandbox/Container | VM | Â¥2,000 |
| å†…å­˜>2GB | é™é¢ | Sandbox | Container | Â¥500 |
| æŒä¹…åŒ– | tmpfs | Sandbox | Container | Â¥500 |
| æ¯«ç§’å†·å¯åŠ¨ | å†·å¯åŠ¨ | VM/Container | Sandbox | Â¥1,000 (åå‘) |

---

### 6.3 æœ€ä¼˜è¿ç§»ç­–ç•¥

**å®šç† 6.1 (æœ€ä¼˜è¿ç§»ç­–ç•¥)**:

æœ€ä¼˜è¿ç§»ç­–ç•¥ä¸ºå•å‘æœ€å°è·³è·ƒï¼š

$$
T_0 \to T_1 \to ... \to T_n \quad \text{where } n = \min
$$

**ç­–ç•¥**:

1. **è¯„ä¼°éœ€æ±‚**: è¯†åˆ«è§¦å‘çš„çº¢çº¿
2. **æœ€å°è·³è·ƒ**: é€‰æ‹©æœ€è¿‘æ»¡è¶³éœ€æ±‚çš„å±‚çº§
3. **é¿å…è¿‡åº¦**: ä¸è¦ç›´æ¥è·³åˆ°VMï¼ˆé™¤éå¿…é¡»ï¼‰

**åä¾‹**:

```
âŒ Sandbox â†’ VM (éœ€è¦syscall>30) â†’ è¿‡åº¦è¿ç§»
âœ… Sandbox â†’ Container (éœ€è¦syscall>30) â†’ æœ€å°è¿ç§»
```

---

## Part VII: ä¸»æƒ-èµ„æºå¯¹ç…§ä¸é€ƒç”Ÿé—¨åˆ†æ

### 7.1 ä¸‰å±‚ä¸»æƒå›¾ï¼ˆè¾¹ç•Œ=è°å–Šåœï¼‰

**å®šä¹‰ 7.1 (ä¸»æƒå±‚æ¬¡è¾¹ç•Œ)**:

ä¸»æƒè¾¹ç•Œç”±**æ§åˆ¶æƒè½¬ç§»ç‚¹**å®šä¹‰ï¼š

$$
\text{Boundary}(T_1, T_2) = \{r : \text{Resource} \mid \text{Controller}(r) = T_1 \land \text{Controller}(r) \neq T_2\}
$$

**ä¸‰å±‚ä¸»æƒæ¶æ„**:

```
ç¡¬ä»¶ (Physical Hardware)
â”‚
â”œâ”€ è™šæ‹ŸåŒ–å±‚ (Hypervisor/KVM) â†â†’ ä¸»æƒï¼šå–Šåœ CPUæŒ‡ä»¤ & ç‰©ç†åœ°å€
â”‚   â”‚
â”‚   â”œâ”€ å®¹å™¨å±‚ (containerd/runC) â†â†’ ä¸»æƒï¼šå–Šåœ syscall & å†…æ ¸èµ„æº
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€ æ²™ç›’å±‚ (gVisor/Firecracker/V8) â†â†’ ä¸»æƒï¼šå–Šåœ è¯­è¨€/åº“è°ƒç”¨
â”‚   â”‚   â”‚   â”‚
â”‚   â”‚   â”‚   â””â”€ ç”¨æˆ·ä»£ç  (Application)
```

**ä¸»æƒè½¬ç§»å…¬ç†**:

$$
\text{Hypervisor} \xrightarrow{\text{CPUæŒ‡ä»¤}} \text{Kernel} \xrightarrow{\text{syscall}} \text{Runtime} \xrightarrow{\text{è¯­è¨€è°ƒç”¨}} \text{Application}
$$

---

### 7.2 å…­ç±»èµ„æºæ§åˆ¶æƒçŸ©é˜µ

**å®šä¹‰ 7.2 (èµ„æºæ§åˆ¶æƒ)**:

å¯¹äºèµ„æº$r$å’ŒæŠ€æœ¯$T$ï¼Œæ§åˆ¶æƒå®šä¹‰ä¸ºï¼š

$$
\text{Control}(r, T) = \{op : \text{Operation} \mid T \text{ can perform } op \text{ on } r\}
$$

**2025å®æµ‹èµ„æºæ§åˆ¶çŸ©é˜µ**:

| èµ„æºç±»åˆ« | è™šæ‹ŸåŒ– | å®¹å™¨ | æ²™ç›’ | è¾¹ç•Œåˆ»åº¦ | 2025äº‘å‚å•†ç¤ºä¾‹ |
|---------|--------|------|------|---------|---------------|
| **â‘  CPUæŒ‡ä»¤** | VMX/Hypercall | å†…æ ¸è°ƒåº¦ | è¯­è¨€è§£é‡Šå™¨ | æŒ‡ä»¤çº§è¿‡æ»¤ | AWS Nitro vs Docker vs Lambda |
| **â‘¡ ç‰©ç†åœ°å€** | EPT/å½±å­é¡µè¡¨ | Cgroup limit | è¿è¡Œæ—¶GC | åœ°å€ç¿»è¯‘æƒ | EC2 vs ECS vs Fargate |
| **â‘¢ ç³»ç»Ÿè°ƒç”¨** | å®Œæ•´syscall (~450) | 50-200æ¡seccomp | ç™½åå•~30æ¡ | syscallæ•°é‡ | KVM vs containerd vs Firecracker |
| **â‘£ å†…æ ¸æ¨¡å—** | å¯åŠ è½½insmod | åªè¯»/ç¦æ­¢ | ç¦æ­¢ | æ¨¡å—åŠ è½½æƒ | bare-metal vs Docker vs Workers |
| **â‘¤ æ–‡ä»¶ç³»ç»Ÿ** | æ•´ç›˜block | Overlay/Volume | åªè¯»å±‚+tmpfs | æŒ‚è½½ç‚¹æ§åˆ¶ | EBS vs Docker vs 512MBä¸´æ—¶ç›˜ |
| **â‘¥ ç½‘ç»œåè®®** | å…¨æ ˆoffload | veth/bridge | HTTP-onlyå‡ºç«™ | åè®®æ ˆæ·±åº¦ | bare-metal vs Calico vs Lambda ENI |

**èµ„æºæ§åˆ¶æƒååº**:

$$
\forall r \in \text{Resources}, \quad |\text{Control}(r, \text{VM})| \geq |\text{Control}(r, \text{Container})| \geq |\text{Control}(r, \text{Sandbox})|
$$

---

### 7.3 ç¡¬çº¢çº¿åˆ†ç±»ä¸é€ƒç”Ÿé—¨

**å®šä¹‰ 7.3 (ç¡¬çº¢çº¿)**:

ç¡¬çº¢çº¿$R(T)$æ˜¯æŠ€æœ¯$T$æ°¸ä¹…æ— æ³•æ»¡è¶³çš„ç³»ç»Ÿéœ€æ±‚ï¼š

$$
R(T) = \{req : \text{Requirement} \mid \nexists \text{ config } c : req \in \text{Capability}(T + c)\}
$$

**å…­ç±»ç¡¬çº¢çº¿åˆ†ç±»è¡¨**:

| çº¢çº¿ç±»åˆ« | è™šæ‹ŸåŒ– | å®¹å™¨ | æ²™ç›’ | é€ƒç”Ÿé—¨ | æˆæœ¬ |
|---------|--------|------|------|--------|------|
| **è£¸æœºé©±åŠ¨** | âœ… å¯åŠ è½½ | âŒ ä¸å¯ | âŒ ä¸å¯ | å¿…é¡»ä¸Šè¿â†’VM | Â¥2,000-5,000 |
| **å†…æ ¸æ¨¡å—ç¼–è¯‘** | âœ… å¯make | âŒ æ— å¤´æ–‡ä»¶ | âŒ æ— gcc | å¿…é¡»â†’VMæˆ–è£¸æœº | Â¥2,000-5,000 |
| **ç¡¬ä»¶ç›´é€š** | âœ… PCIe passthrough | âŒ æ— IOMMU | âŒ æ— ç¡¬ä»¶è®¿é—® | VMæ˜¯å”¯ä¸€å…¥å£ | Â¥2,000 |
| **è‡ªå®šä¹‰syscall** | âœ… å¯æ·»åŠ  | âŒ seccompæ‹’ | âŒ ç™½åå•å¤–æ‹’ | å¿…é¡»â†’VM | Â¥2,000-5,000 |
| **>10GBå¸¸é©»å†…å­˜** | âœ… å¤§é¡µæ”¯æŒ | âš ï¸ OOMé£é™© | âŒ é™é¢<2GB | è¿â†’VMæˆ–å®¹å™¨ | Â¥500-2,000 |
| **éHTTPåè®®** | âœ… å…¨æ ˆ | âœ… å¯ | âŒ ä»…HTTP | è¿â†’å®¹å™¨/VM | Â¥500-2,000 |

**é€ƒç”Ÿé—¨å®šç†**:

$$
\text{RedLine}(T) \cap \text{Requirements} \neq \emptyset \implies \text{å¿…é¡»è¿ç§»åˆ°} \min\{T' : T \prec T' \land \text{Requirements} \subseteq S(T')\}
$$

**é€ƒç”Ÿé—¨è·¯å¾„**:

```
Sandboxè¸©çº¢çº¿
  â”œâ”€ syscall>30 â”€â”€â”€â”€â†’ é€ƒç”Ÿé—¨ï¼šContainer (Â¥500)
  â”œâ”€ å†…å­˜>2GB â”€â”€â”€â”€â”€â”€â†’ é€ƒç”Ÿé—¨ï¼šContainer (Â¥500)
  â”œâ”€ insmod â”€â”€â”€â”€â”€â”€â”€â”€â†’ é€ƒç”Ÿé—¨ï¼šVM (Â¥5,000)
  â”œâ”€ GPUç›´é€š â”€â”€â”€â”€â”€â”€â”€â†’ é€ƒç”Ÿé—¨ï¼šVM (Â¥2,000)
  â””â”€ éHTTPåè®® â”€â”€â”€â”€â†’ é€ƒç”Ÿé—¨ï¼šContainer (Â¥500)

Containerè¸©çº¢çº¿
  â”œâ”€ insmod â”€â”€â”€â”€â”€â”€â”€â”€â†’ é€ƒç”Ÿé—¨ï¼šVM (Â¥2,000)
  â”œâ”€ PCIeç›´é€š â”€â”€â”€â”€â”€â”€â†’ é€ƒç”Ÿé—¨ï¼šVM (Â¥2,000)
  â”œâ”€ è‡ªå®šä¹‰syscall â”€â†’ é€ƒç”Ÿé—¨ï¼šVM (Â¥2,000)
  â””â”€ å†…å­˜>10GB â”€â”€â”€â”€â”€â†’ é€ƒç”Ÿé—¨ï¼šVM (Â¥2,000)
```

---

### 7.4 äº‘å‚å•†å®æµ‹è¾¹ç•Œ (2025)

**å®šä¹‰ 7.4 (äº§å“è¾¹ç•Œ)**:

äº‘äº§å“$P$çš„è¾¹ç•Œç”±å…¶æš´éœ²çš„æœ€å°å¯è°ƒèµ„æºå®šä¹‰ï¼š

$$
\text{Boundary}(P) = \min\{r : \text{Resource} \mid \text{User can control } r\}
$$

**2025äº‘å‚å•†å®æµ‹è¾¹ç•Œè¡¨**:

| äº§å“ | å‚å•† | æ¶æ„å±‚ | ä¸»æƒè¾¹ç•Œ | æœ€å°å¯è°ƒèµ„æº | ä»·æ ¼ (Â¥/æœˆ) |
|------|------|--------|---------|-------------|-----------|
| **EC2 bare-metal** | AWS | è™šæ‹ŸåŒ– | 0è™šæ‹ŸåŒ–ç¨ | æ•´å°NUMA+BIOS | Â¥5,000+ |
| **EC2 KVM** | AWS | è™šæ‹ŸåŒ– | VMCSè¿‡æ»¤ | vCPU+EBSå— | Â¥200-2,000 |
| **ECS/Fargate** | AWS | å®¹å™¨ | seccomp 50æ¡ | å®¹å™¨é•œåƒ+å†…æ ¸å‚æ•°ç™½åå• | Â¥50-500 |
| **Lambda** | AWS | æ²™ç›’ | è¯­è¨€è¿è¡Œæ—¶ | å‡½æ•°åŒ…+ç¯å¢ƒå˜é‡ | Â¥1-50 |
| **Cloudflare Workers** | Cloudflare | æ²™ç›’ | V8éš”ç¦» | 1MB WASM+50ms CPU | Â¥0-20 |
| **CCE Turbo** | åä¸ºäº‘ | å®¹å™¨ | FPGAå¸è½½ | å®¹å™¨+ç¡¬ä»¶å¸è½½ | Â¥100-1,000 |
| **Firecracker** | AWS | æ²™ç›’ | MicroVM | å‡½æ•°åŒ…<512MB | Â¥1-20 |

**è¾¹ç•Œå®šç†**:

$$
\text{Price}(P) \propto |\text{Control}(P)| \quad \text{(ä¸»æƒè¶Šå¤§ï¼Œä»·æ ¼è¶Šé«˜)}
$$

---

### 7.5 åœºæ™¯é©±åŠ¨å†³ç­–æ¨¡å‹

**å®šä¹‰ 7.5 (åœºæ™¯éœ€æ±‚)**:

åœºæ™¯$S$çš„éœ€æ±‚ä¸ºï¼š

$$
\text{Requirements}(S) = \{r_1, r_2, ..., r_n\}
$$

**æ¶æ„å†³ç­–è¡¨ (2025)**:

| åœºæ™¯ | å…³é”®éœ€æ±‚ | æœ€ä½ä¸»æƒå±‚ | åˆ†ç•Œçº¿ç†ç”± | äº‘äº§å“æ¨è | æˆæœ¬ |
|------|---------|-----------|-----------|-----------|------|
| **ä¸ªäººåšå®¢** | æ”¹Nginxé…ç½® | å®¹å™¨ | å‡½æ•°æ²¡rootï¼ŒVMå¤ªè´µ | Docker/ECS | Â¥50/æœˆ |
| **AIæ¨ç†** | åŠ è½½2GBæ¨¡å‹ | å®¹å™¨ | å‡½æ•°åŒ…ä½“ç§¯+GPUé©±åŠ¨ | ECS+GPU | Â¥500/æœˆ |
| **é«˜é¢‘äº¤æ˜“** | è°ƒå†…æ ¸bypass | è™šæ‹ŸåŒ– | éœ€è‡ªå®šä¹‰ç½‘å¡é©±åŠ¨ | EC2 bare-metal | Â¥5,000/æœˆ |
| **Serverless API** | åªæ”¹ä¸šåŠ¡é€»è¾‘ | æ²™ç›’ | ä¸åŠ¨å†…æ ¸ï¼Œé›¶è¿ç»´ | Lambda/Workers | Â¥1-20/æœˆ |
| **å¤šç§Ÿæˆ·PaaS** | éš”ç¦»ç”¨æˆ·äºŒè¿›åˆ¶ | å®¹å™¨ | éœ€syscallç™½åå• | K8s+gVisor | Â¥100-500/æœˆ |
| **äº‘æ¸¸æˆ** | ç‹¬å GPU | è™šæ‹ŸåŒ– | éœ€ç›´é€šPCIe | EC2+GPU passthrough | Â¥2,000/æœˆ |
| **å†…æ ¸å¼€å‘** | ç¼–è¯‘é©±åŠ¨ | è™šæ‹ŸåŒ– | éœ€insmod+make | KVM | Â¥200/æœˆ |
| **è¾¹ç¼˜è®¡ç®—** | ä½å»¶è¿Ÿ<10ms | æ²™ç›’ | æ¯«ç§’å†·å¯åŠ¨ | Firecracker/Workers | Â¥10-50/æœˆ |

**å†³ç­–ç®—æ³•**:

```python
def choose_layer(scenario):
    requirements = scenario.requirements
    
    # æ£€æŸ¥ç¡¬çº¢çº¿
    if 'insmod' in requirements or 'gpu_passthrough' in requirements:
        return 'VM', 2000
    
    if 'syscall>30' in requirements or 'memory>2GB' in requirements:
        return 'Container', 500
    
    if 'http_only' in requirements and 'cold_start<100ms' in requirements:
        return 'Sandbox', 20
    
    # é»˜è®¤æœ€å°ä¸»æƒ
    return 'Sandbox', 20
```

---

### 7.6 ä¸»æƒè¾¹ç•Œä¸€å¥è¯å®šç†

**å®šç† 7.1 (è°å–Šåœå®šç†)**:

$$
\text{Boundary}(T) = \{r : \text{Resource} \mid T \text{ is the first to stop operations on } r\}
$$

**å®ä¾‹**:

- **è™šæ‹ŸåŒ–å–Šåœ**: CPUæŒ‡ä»¤ (VMREAD/VMWRITE)
- **å®¹å™¨å–Šåœ**: ç³»ç»Ÿè°ƒç”¨ (syscall)
- **æ²™ç›’å–Šåœ**: è¯­è¨€è°ƒç”¨ (å‡½æ•°/æ–¹æ³•)

**å®šç† 7.2 (ä¸»æƒåŠå¾„å®šç†)**:

é€‰æ‹©æŠ€æœ¯å±‚çº§ = é€‰æ‹©ä¸»æƒåŠå¾„ï¼š

$$
\text{Radius}(T) = |\{r : \text{Resource} \mid T \text{ can control } r\}|
$$

$$
\text{Radius}(\text{VM}) > \text{Radius}(\text{Container}) > \text{Radius}(\text{Sandbox})
$$

**æ¨è®º**:

$$
\text{åŠå¾„è¶Šå¤§} \implies \text{è´£ä»»è¶Šé‡} \land \text{è‡ªç”±è¶Šé«˜} \land \text{æˆæœ¬è¶Šé«˜}
$$

---

### 7.7 å®æˆ˜é€ƒç”Ÿé—¨é€ŸæŸ¥è¡¨

**é€ŸæŸ¥è¡¨**: éœ€æ±‚â†’çº¢çº¿â†’é€ƒç”Ÿé—¨

| ä½ çš„éœ€æ±‚ | è§¦å‘çº¢çº¿ | å½“å‰å±‚ | é€ƒç”Ÿé—¨ | æˆæœ¬ | è¡ŒåŠ¨ |
|---------|---------|--------|--------|------|------|
| éœ€è¦ç¼–è¯‘å†…æ ¸æ¨¡å— | insmod | ä»»ä½• | VM | Â¥2,000 | ç«‹å³è¿ç§»è‡³EC2/KVM |
| éœ€è¦GPUç›´é€š | PCIe passthrough | ä»»ä½• | VM | Â¥2,000 | è´­ä¹°GPUå®ä¾‹ |
| éœ€è¦>30æ¡syscall | syscallç™½åå• | Sandbox | Container | Â¥500 | å®¹å™¨åŒ–åº”ç”¨ |
| éœ€è¦>2GBå†…å­˜ | å†…å­˜é™é¢ | Sandbox | Container | Â¥500 | å®¹å™¨åŒ–åº”ç”¨ |
| éœ€è¦æŒä¹…åŒ–å­˜å‚¨ | tmpfs | Sandbox | Container | Â¥500 | ä½¿ç”¨Volume |
| éœ€è¦éHTTPåè®® | L7é™åˆ¶ | Sandbox | Container | Â¥500 | ä½¿ç”¨veth/bridge |
| éœ€è¦>10GBå†…å­˜ | OOMé£é™© | Container | VM | Â¥2,000 | å‡çº§è‡³VM |
| éœ€è¦è‡ªå®šä¹‰syscall | seccompæ‹’ç» | Container | VM | Â¥2,000 | ç¼–è¯‘è‡ªå®šä¹‰å†…æ ¸ |
| éœ€è¦<100mså†·å¯åŠ¨ | å¯åŠ¨æ—¶é—´ | VM/Container | Sandbox | Â¥-1,500 | é™çº§è‡³æ²™ç›’ |
| éœ€è¦é›¶é—²ç½®æˆæœ¬ | é—²ç½®è®¡è´¹ | VM/Container | Sandbox | Â¥-1,980 | ä½¿ç”¨Serverless |

**é€ƒç”Ÿé—¨å†³ç­–æ ‘ (å¢å¼ºç‰ˆ)**:

```
â”Œâ”€ éœ€æ±‚åˆ†æ
â”‚
â”œâ”€ ç¡¬ä»¶å±‚éœ€æ±‚ï¼Ÿ
â”‚  â”œâ”€ æ˜¯ (insmod/GPUç›´é€š/è‡ªå®šä¹‰syscall)
â”‚  â”‚  â””â”€â†’ é€ƒç”Ÿé—¨ï¼šVM (Â¥2,000-5,000)
â”‚  â”‚       â”œâ”€ EC2 bare-metal (æœ€é«˜ä¸»æƒ)
â”‚  â”‚       â”œâ”€ KVM (æ ‡å‡†è™šæ‹ŸåŒ–)
â”‚  â”‚       â””â”€ VMware (ä¼ä¸šçº§)
â”‚  â”‚
â”‚  â””â”€ å¦ â†’ ç»§ç»­
â”‚
â”œâ”€ å†…æ ¸å±‚éœ€æ±‚ï¼Ÿ
â”‚  â”œâ”€ æ˜¯ (syscall>30/å†…å­˜>2GB/æŒä¹…åŒ–/éHTTP)
â”‚  â”‚  â””â”€â†’ é€ƒç”Ÿé—¨ï¼šContainer (Â¥500)
â”‚  â”‚       â”œâ”€ Docker (æ ‡å‡†å®¹å™¨)
â”‚  â”‚       â”œâ”€ ECS/Fargate (æ‰˜ç®¡å®¹å™¨)
â”‚  â”‚       â””â”€ K8s+gVisor (å®‰å…¨å®¹å™¨)
â”‚  â”‚
â”‚  â””â”€ å¦ â†’ ç»§ç»­
â”‚
â””â”€ åº”ç”¨å±‚éœ€æ±‚ï¼Ÿ
   â””â”€ æ˜¯ (HTTP-only/å†·å¯åŠ¨<100ms/é›¶é—²ç½®)
      â””â”€â†’ é€ƒç”Ÿé—¨ï¼šSandbox (Â¥0-20)
           â”œâ”€ Lambda (AWS)
           â”œâ”€ Cloudflare Workers (è¾¹ç¼˜)
           â””â”€ Firecracker (MicroVM)
```

---

### 7.8 ä¸»æƒ-è´£ä»»-æˆæœ¬ä¸‰è§’å…³ç³»

**å®šç† 7.3 (ä¸»æƒ-è´£ä»»-æˆæœ¬ä¸‰è§’å®šç†)**:

$$
\text{Sovereignty}(T) \propto \text{Responsibility}(T) \propto \text{Cost}(T)
$$

**é‡åŒ–å…³ç³»**:

| å±‚çº§ | ä¸»æƒåŠå¾„ | è´£ä»»èŒƒå›´ | æœˆæˆæœ¬ | å…³ç³» |
|------|---------|---------|--------|------|
| Sandbox | ä½ (30 syscall) | ä½ (åªç®¡ä»£ç ) | Â¥1-20 | ä½ä¸»æƒâ†’ä½è´£ä»»â†’ä½æˆæœ¬ |
| Container | ä¸­ (200 syscall) | ä¸­ (ç®¡é•œåƒ+é…ç½®) | Â¥50-500 | ä¸­ä¸»æƒâ†’ä¸­è´£ä»»â†’ä¸­æˆæœ¬ |
| VM | é«˜ (450 syscall) | é«˜ (ç®¡å†…æ ¸+é©±åŠ¨) | Â¥200-5,000 | é«˜ä¸»æƒâ†’é«˜è´£ä»»â†’é«˜æˆæœ¬ |

**å¸•ç´¯æ‰˜æœ€ä¼˜åˆ¤å®š**:

$$
\text{Optimal}(T) \iff \text{Sovereignty}(T) \geq \text{Requirements} \land \text{Cost}(T) = \min
$$

**å®ä¾‹**:

```
éœ€æ±‚ï¼šHTTP API + <100mså†·å¯åŠ¨
  â”œâ”€ Sandbox (Â¥20) â† æœ€ä¼˜ âœ…
  â”œâ”€ Container (Â¥500) â† è¿‡åº¦
  â””â”€ VM (Â¥2,000) â† æåº¦è¿‡åº¦

éœ€æ±‚ï¼šinsmodé©±åŠ¨
  â”œâ”€ Sandbox (Â¥20) â† ä¸å¯è¡Œ âŒ
  â”œâ”€ Container (Â¥500) â† ä¸å¯è¡Œ âŒ
  â””â”€ VM (Â¥2,000) â† å”¯ä¸€é€‰æ‹© âœ…
```

---

### 7.9 å¢“å¿—é“­ï¼ˆä¸»æƒ-èµ„æºç‰ˆï¼‰

> **è°èƒ½å–Šåœsyscall = æœ€ç»ˆåˆ†ç•Œçº¿ï¼š**  
> **è™šæ‹ŸåŒ–å–ŠåœæŒ‡ä»¤ï¼Œå®¹å™¨å–Šåœç³»ç»Ÿè°ƒç”¨ï¼Œæ²™ç›’å–Šåœä½ çš„ä»£ç ã€‚**

**é‡åŒ–**:

$$
\begin{align}
\text{VM} &: \quad \text{å–Šåœ} \in \{\text{CPUæŒ‡ä»¤}, \text{ç‰©ç†åœ°å€}, \text{syscall}, \text{è¯­è¨€è°ƒç”¨}\} \\
\text{Container} &: \quad \text{å–Šåœ} \in \{\text{syscall}, \text{è¯­è¨€è°ƒç”¨}\} \\
\text{Sandbox} &: \quad \text{å–Šåœ} \in \{\text{è¯­è¨€è°ƒç”¨}\}
\end{align}
$$

> **é€‰å±‚å°±æ˜¯é€‰ä¸»æƒåŠå¾„â€”â€”åŠå¾„è¶Šå¤§ï¼Œè´£ä»»è¶Šé‡ï¼Œè‡ªç”±è¶Šé«˜ã€‚**

**ä¸‰è§’å…³ç³»**:

$$
\uparrow \text{ä¸»æƒåŠå¾„} \implies \uparrow \text{è´£ä»»} \land \uparrow \text{è‡ªç”±} \land \uparrow \text{æˆæœ¬}
$$

> **çº¢çº¿=ä¸»æƒæé™ï¼šæ²™ç›’åœäºè¯­è¨€ï¼Œå®¹å™¨åœäºå†…æ ¸ï¼Œè™šæ‹ŸåŒ–åœäºç¡¬ä»¶ï¼›**  
> **è°å–Šåœï¼Œè°å°±æ˜¯è¾¹ç•Œï¼›çº¢çº¿ä¹‹å¤–ï¼Œæ°¸è¿œæ˜¯VMçš„å›½åœŸã€‚**

**è¾¹ç•Œå…¬å¼**:

$$
\text{Boundary}(T) = \{r : \text{Resource} \mid \text{Controller}(r) = T\}
$$

$$
\text{RedLine}(T) = \{req : \text{Requirement} \mid req \notin S(T)\}
$$

> **é€ƒç”Ÿé—¨=æœ€å°è·³è·ƒï¼šè§¦ç¢°çº¢çº¿â†’ç«‹å³å¤–è¿è‡³æœ€è¿‘æ»¡è¶³å±‚ï¼›**  
> **æˆæœ¬ä»Â¥500åˆ°Â¥5,000ï¼Œæœ€å°è·³è·ƒæ˜¯ç‹é“ã€‚**

**é€ƒç”Ÿé—¨æˆæœ¬è¡¨**:

| é€ƒç”Ÿé—¨è·¯å¾„ | æˆæœ¬ | æ—¶æœº |
|-----------|------|------|
| Sandbox â†’ Container | Â¥500 | syscall>30/å†…å­˜>2GB |
| Container â†’ VM | Â¥2,000 | insmod/GPUç›´é€š |
| Sandbox â†’ VM | Â¥5,000 | **é¿å…**ï¼ˆè¿‡åº¦è¿ç§»ï¼‰ |

---

## Part VIII: ä¸ªäººå¼€å‘è€…æˆæœ¬ä¼˜åŒ–ä¸å†³ç­–æ¨¡å‹

### 8.1 ä¸ªäººåœºæ™¯æˆæœ¬é›·è¾¾

**å®šä¹‰ 8.1 (ä¸ªäººå¼€å‘è€…æˆæœ¬)**:

ä¸ªäººå¼€å‘è€…æ€»æˆæœ¬$C_{\text{personal}}(T)$åŒ…å«äº”ä¸ªç»´åº¦ï¼š

$$
C_{\text{personal}}(T) = (C_1, C_2, C_3, C_4, C_5) \in [1,5]^5
$$

å…¶ä¸­ï¼š

- $C_1$: äººåŠ›è¿ç»´æˆæœ¬ (5=æœ€çœ)
- $C_2$: ä¸Šçº¿é€Ÿåº¦æˆæœ¬ (5=æœ€å¿«)
- $C_3$: é—²ç½®æˆæœ¬ (5=æœ€ä½)
- $C_4$: å¹¶å‘å¼¹æ€§ (5=æœ€å¥½)
- $C_5$: çŠ¶æ€/ä½“ç§¯çº¢åˆ© (5=æœ€çµæ´»)

**äº”ç»´æˆæœ¬é›·è¾¾ (2025å®æµ‹)**:

| ç»´åº¦ | å‡½æ•°è®¡ç®— (Sandbox) | å®¹å™¨ (Docker/K8s) | å·®è· | è¯´æ˜ |
|------|-------------------|------------------|------|------|
| **â‘  äººåŠ›è¿ç»´** | 5 | 2 | **2.5Ã—** | å‡½æ•°=0æœåŠ¡å™¨ï¼›å®¹å™¨ç®¡é•œåƒ/ç½‘ç»œ/å‡çº§ |
| **â‘¡ ä¸Šçº¿é€Ÿåº¦** | 5 | 3 | **1.7Ã—** | å‡½æ•°â‰ˆ5åˆ†é’Ÿï¼›å®¹å™¨â‰ˆ30åˆ†é’Ÿèµ· |
| **â‘¢ é—²ç½®æˆæœ¬** | 5 | 2 | **2.5Ã—** | å‡½æ•°=0é—²ç½®è´¹ï¼›å®¹å™¨=èŠ‚ç‚¹ä¸€ç›´è·‘ |
| **â‘£ å¹¶å‘å¼¹æ€§** | 5 | 4 | **1.25Ã—** | å‡½æ•°ç§’çº§ä¸‡å¹¶å‘ï¼›å®¹å™¨éœ€æå‰æ‰©èŠ‚ç‚¹ |
| **â‘¤ çŠ¶æ€/ä½“ç§¯** | 3 | 5 | **0.6Ã—** | å‡½æ•°50MB/å†·å¯100msï¼›å®¹å™¨éšæ„ |
| **æ€»åˆ†** | **23/25** | **16/25** | **1.44Ã—** | **ä¸ªäººè§†è§’å‡½æ•°å®Œèƒœ** |

**æˆæœ¬é›·è¾¾æ¨¡å‹**:

$$
\text{Score}(T) = \sum_{i=1}^{5} C_i(T) \quad \text{where } C_i \in [1,5]
$$

$$
\begin{align}
\text{Score}(\text{Sandbox}) &= 23/25 = 92\% \\
\text{Score}(\text{Container}) &= 16/25 = 64\%
\end{align}
$$

**ä¸ªäººå¼€å‘è€…ä¼˜åŠ¿æ¯”**:

$$
\text{Advantage}(\text{Sandbox}/\text{Container}) = \frac{23}{16} \approx 1.44 \quad (44\% \text{ä¼˜åŠ¿})
$$

---

### 8.2 ä¸ªäººçº¢çº¿ä¸é€ƒç”Ÿé—¨

**å®šä¹‰ 8.2 (ä¸ªäººçº¢çº¿)**:

ä¸ªäººçº¢çº¿$R_{\text{personal}}$æ˜¯è§¦å‘è¿ç§»çš„å››æ¡ç¡¬çº¦æŸï¼š

$$
R_{\text{personal}} = \{R_{\text{å†·å¯åŠ¨}}, R_{\text{ä½“ç§¯}}, R_{\text{çŠ¶æ€}}, R_{\text{è´¦å•}}\}
$$

**å››æ¡ä¸ªäººçº¢çº¿ (2025å®æµ‹)**:

| çº¢çº¿ | é˜ˆå€¼ | è§¦å‘æ¡ä»¶ | é€ƒç”Ÿç­–ç•¥ | æœ€å°å®¹å™¨æ–¹æ¡ˆ |
|------|------|---------|---------|-------------|
| **â‘  å†·å¯åŠ¨** | >1s ä¸”ç”¨æˆ·æ•æ„Ÿ | é¦–æ¬¡è¯·æ±‚å»¶è¿Ÿ | å®¹å™¨+å¸¸é©»1å®ä¾‹ | Docker Compose 1æ–‡ä»¶ |
| **â‘¡ å•åŒ…ä½“ç§¯** | >50MB (ä»£ç +ä¾èµ–) | å‡½æ•°åŒ…ä¸Šä¼ é™åˆ¶ | å®¹å™¨é•œåƒ | Dockerfile + äº‘æ‰˜ç®¡ |
| **â‘¢ çŠ¶æ€ç¼“å­˜** | æœ¬åœ°å¤§æ¨¡å‹/Redis | éœ€æŒä¹…åŒ–çŠ¶æ€ | å®¹å™¨æŒ‚å· | 1ä¸ªRediså®¹å™¨å…±ç¼–æ’ |
| **â‘£ è´¦å•å¤±æ§** | æœˆ>Â¥100 ä¸”æŒç»­ | é«˜é¢‘è¯·æ±‚ | å®¹å™¨å¸¸é©»Spot | 1vCPU 1GBèŠ‚ç‚¹ |

**ä¸ªäººçº¢çº¿å®šç†**:

$$
\text{RedLine}_{\text{personal}}(T) \cap \text{Requirements} \neq \emptyset \implies \text{è¿ç§»è‡³Container}
$$

**è¿ç§»è§¦å‘æ¡ä»¶**:

$$
\text{Migration}_{\text{trigger}} = \begin{cases}
1 & \text{if } |\text{RedLine} \cap \text{Requirements}| \geq 2 \\
0 & \text{otherwise}
\end{cases}
$$

**åŸåˆ™**: **çº¢çº¿åŒæ—¶è¸©â‰¥2æ¡**æ‰å€¼å¾—åˆ‡å®¹å™¨ï¼›å¦åˆ™å‡½æ•°è¶³å¤Ÿã€‚

**é€ƒç”Ÿé—¨è·¯å¾„ (ä¸ªäººç‰ˆ)**:

```
Sandbox (å‡½æ•°)
  â”œâ”€ [å†·å¯åŠ¨>1s] â”€â”€â†’ Containerå•èŠ‚ç‚¹ (Â¥18/æœˆ)
  â”œâ”€ [åŒ…ä½“ç§¯>50MB] â”€â”€â†’ Containeré•œåƒ (Â¥18/æœˆ)
  â”œâ”€ [éœ€è¦çŠ¶æ€] â”€â”€â†’ Container+Volume (Â¥25/æœˆ)
  â”œâ”€ [è´¦å•>100] â”€â”€â†’ Container Spot (Â¥12/æœˆ)
  â””â”€ [è¸©â‰¥2æ¡çº¢çº¿] â”€â”€â†’ Containerå®Œæ•´æ–¹æ¡ˆ (Â¥35/æœˆ)
```

---

### 8.3 å®æµ‹è´¦å•å¯¹ç…§ (2025)

**åœºæ™¯**: ä¸ªäººTodo API

- æ—¥å‡è¯·æ±‚: 1,000æ¬¡
- æ¯æ¬¡æ‰§è¡Œ: 100ms
- å†…å­˜éœ€æ±‚: 128MB

**2025å›½å†…å…¬æœ‰äº‘ç»Ÿä¸€å®šä»·**:

| æ–¹æ¡ˆ | æœˆè´¹ç”¨ | äººåŠ›å·¥æ—¶/æœˆ | æ€»æˆæœ¬ (Â¥100/h) | æˆæœ¬æ¯” |
|------|--------|------------|----------------|--------|
| **å‡½æ•°è®¡ç®—** | **Â¥1.2** | 0h | **Â¥1.2** | **1Ã—** (åŸºå‡†) |
| å®¹å™¨å•èŠ‚ç‚¹ | Â¥18 | 2h | Â¥218 | **182Ã—** |
| å®¹å™¨+K8s | Â¥35 | 5h | Â¥535 | **446Ã—** |

**æˆæœ¬å…¬å¼**:

$$
C_{\text{total}}(T) = C_{\text{infra}}(T) + C_{\text{labor}}(T)
$$

$$
C_{\text{labor}}(T) = \text{Hours}(T) \times \text{HourlyRate}
$$

**æˆæœ¬å¯¹æ¯”**:

$$
\begin{align}
C_{\text{total}}(\text{Sandbox}) &= Â¥1.2 + 0 \times Â¥100 = Â¥1.2 \\
C_{\text{total}}(\text{Container}) &= Â¥18 + 2 \times Â¥100 = Â¥218 \\
C_{\text{total}}(\text{K8s}) &= Â¥35 + 5 \times Â¥100 = Â¥535
\end{align}
$$

**æˆæœ¬æ”¾å¤§å€æ•°**:

$$
\begin{align}
\frac{C_{\text{Container}}}{C_{\text{Sandbox}}} &= \frac{Â¥218}{Â¥1.2} \approx 182Ã— \\
\frac{C_{\text{K8s}}}{C_{\text{Sandbox}}} &= \frac{Â¥535}{Â¥1.2} \approx 446Ã—
\end{align}
$$

**ç»“è®º**: å‡½æ•°è®¡ç®— = **1.2å…ƒ + 0å·¥æ—¶**ï¼›å®¹å™¨æœ€ç®€ = **18å…ƒ + 2å·¥æ—¶** = **å·®15å€é’± + âˆå€äººåŠ›**

---

### 8.4 ä¸ªäººå†³ç­–å¸•ç´¯æ‰˜æ¨¡å‹

**å®šä¹‰ 8.3 (ä¸ªäººå¸•ç´¯æ‰˜æœ€ä¼˜)**:

æŠ€æœ¯$T$å¯¹ä¸ªäººå¼€å‘è€…å¸•ç´¯æ‰˜æœ€ä¼˜ï¼Œå½“ä¸”ä»…å½“ï¼š

$$
\nexists T' : \text{Score}(T') > \text{Score}(T) \land C_{\text{total}}(T') \leq C_{\text{total}}(T)
$$

**2025ä¸ªäººå¸•ç´¯æ‰˜å‰æ²¿**:

```
æˆæœ¬ (C_total)
  â†‘
  â”‚ K8s (Â¥535, 64%)
  â”‚
  â”‚     Container (Â¥218, 64%)
  â”‚
  â”‚         Sandbox (Â¥1.2, 92%) â† å¸•ç´¯æ‰˜æœ€ä¼˜ âœ…
  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ æ•ˆç”¨ (Score)
```

**å¸•ç´¯æ‰˜åˆ¤å®š**:

$$
\text{Pareto}_{\text{personal}} = \{\text{Sandbox}\}
$$

å³**å¯¹äºä¸ªäººå¼€å‘è€…ï¼Œæ²™ç›’ï¼ˆå‡½æ•°ï¼‰æ˜¯å”¯ä¸€çš„å¸•ç´¯æ‰˜æœ€ä¼˜è§£**ã€‚

**åä¾‹è¯æ˜**:

$$
\text{Container}: \quad \text{Score} = 64\% < 92\%, \quad C_{\text{total}} = Â¥218 > Â¥1.2 \quad \implies \text{åŠ£äºSandbox}
$$

---

### 8.5 å†³ç­–å£è¯€ä¸ç®—æ³•

**å®šç† 8.1 (ä¸€ç§’å†³ç­–å£è¯€)**:

$$
\text{Decision}_{\text{1sec}} = \begin{cases}
\text{Sandbox} & \text{if åŒ…å° âˆ§ æ— çŠ¶æ€ âˆ§ å¶å‘æµé‡} \\
\text{Container} & \text{if åŒ…å¤§ âˆ¨ è¦çŠ¶æ€ âˆ¨ é•¿æ—¶é—´è·‘}
\end{cases}
$$

**å½¢å¼åŒ–å®šä¹‰**:

$$
\begin{align}
\text{åŒ…å°} &\iff \text{PackageSize} \leq 50\text{MB} \\
\text{æ— çŠ¶æ€} &\iff \neg \exists \text{ Persistent State} \\
\text{å¶å‘æµé‡} &\iff \text{RequestRate} < 100\text{æ¬¡/åˆ†é’Ÿ}
\end{align}
$$

**å†³ç­–ç®—æ³• (ä¸ªäººç‰ˆ)**:

```python
def choose_tech_personal(requirements):
    # æ£€æŸ¥ä¸ªäººçº¢çº¿
    red_lines_hit = 0
    
    if requirements['cold_start'] > 1.0:  # ç§’
        red_lines_hit += 1
    
    if requirements['package_size'] > 50:  # MB
        red_lines_hit += 1
    
    if requirements['need_state']:
        red_lines_hit += 1
    
    if requirements['monthly_cost'] > 100:  # Â¥
        red_lines_hit += 1
    
    # åˆ¤å®šé€»è¾‘
    if red_lines_hit >= 2:
        return 'Container', 18  # æœ€å°å®¹å™¨æ–¹æ¡ˆ
    elif red_lines_hit == 1:
        return 'Sandbox', 1.2  # å¯æ¥å—ï¼Œè§‚å¯Ÿ
    else:
        return 'Sandbox', 1.2  # å®Œç¾åŒ¹é…
```

**å†³ç­–æ ‘ (å¯è§†åŒ–)**:

```
â”Œâ”€ ä¸ªäººå¼€å‘è€…åœºæ™¯
â”‚
â”œâ”€ åŒ…ä½“ç§¯ â‰¤50MB?
â”‚  â”œâ”€ å¦ â†’ Container (çº¢çº¿â‘¡)
â”‚  â””â”€ æ˜¯ â†’ ç»§ç»­
â”‚
â”œâ”€ æ— çŠ¶æ€?
â”‚  â”œâ”€ å¦ â†’ Container (çº¢çº¿â‘¢)
â”‚  â””â”€ æ˜¯ â†’ ç»§ç»­
â”‚
â”œâ”€ å†·å¯åŠ¨ <1s?
â”‚  â”œâ”€ å¦ â†’ Container (çº¢çº¿â‘ )
â”‚  â””â”€ æ˜¯ â†’ ç»§ç»­
â”‚
â”œâ”€ æœˆè´¹ <Â¥100?
â”‚  â”œâ”€ å¦ â†’ Container (çº¢çº¿â‘£)
â”‚  â””â”€ æ˜¯ â†’ Sandbox âœ…
â”‚
â””â”€ è¸©â‰¥2æ¡çº¢çº¿? â†’ Container
   è¸©0-1æ¡çº¢çº¿? â†’ Sandbox âœ…
```

---

### 8.6 ä¸ªäººæˆæœ¬ä¼˜åŒ–å®šç†

**å®šç† 8.2 (ä¸ªäººæœ€å°æˆæœ¬å®šç†)**:

å¯¹äºä¸ªäººå¼€å‘è€…ï¼Œåœ¨æ»¡è¶³åŠŸèƒ½éœ€æ±‚å‰æä¸‹ï¼š

$$
T^* = \arg\min_{T \in \{S, C, V\}} \left\{ C_{\text{total}}(T) \mid \text{Requirements} \subseteq \text{Capability}(T) \right\}
$$

å…¶ä¸­ï¼š

- $S$: Sandbox (å‡½æ•°)
- $C$: Container
- $V$: VM

**æœ€ä¼˜é€‰æ‹©å®šç†**:

$$
T^* = \begin{cases}
\text{Sandbox} & \text{if } |\text{RedLine} \cap \text{Requirements}| \leq 1 \\
\text{Container} & \text{if } |\text{RedLine} \cap \text{Requirements}| \geq 2 \\
\text{VM} & \text{if } \text{insmod} \in \text{Requirements}
\end{cases}
$$

**ä¸ªäººæˆæœ¬å‡½æ•°**:

$$
C_{\text{personal}}(T, t) = C_{\text{infra}}(T, t) + C_{\text{labor}}(T, t) + C_{\text{learn}}(T)
$$

**å®æµ‹å€¼**:

| æŠ€æœ¯ | åŸºç¡€è®¾æ–½ (æœˆ) | äººåŠ› (æœˆ) | å­¦ä¹ æˆæœ¬ (ä¸€æ¬¡æ€§) | æ€»æˆæœ¬ (é¦–æœˆ) |
|------|-------------|---------|-----------------|-------------|
| Sandbox | Â¥1.2 | Â¥0 (0h) | Â¥100 (1h) | Â¥101.2 |
| Container | Â¥18 | Â¥200 (2h) | Â¥500 (5h) | Â¥718 |
| VM | Â¥200 | Â¥300 (3h) | Â¥1,000 (10h) | Â¥1,500 |

**é•¿æœŸæˆæœ¬å¯¹æ¯” (12ä¸ªæœˆ)**:

$$
\begin{align}
C_{\text{12M}}(\text{Sandbox}) &= Â¥1.2 \times 12 + Â¥0 \times 12 + Â¥100 = Â¥114.4 \\
C_{\text{12M}}(\text{Container}) &= Â¥18 \times 12 + Â¥200 \times 12 + Â¥500 = Â¥3,116 \\
C_{\text{12M}}(\text{VM}) &= Â¥200 \times 12 + Â¥300 \times 12 + Â¥1,000 = Â¥7,000
\end{align}
$$

**æˆæœ¬æ¯” (12ä¸ªæœˆ)**:

$$
\frac{C_{\text{Container}}}{C_{\text{Sandbox}}} = \frac{Â¥3,116}{Â¥114.4} \approx 27Ã—
$$

$$
\frac{C_{\text{VM}}}{C_{\text{Sandbox}}} = \frac{Â¥7,000}{Â¥114.4} \approx 61Ã—
$$

---

### 8.7 å¢“å¿—é“­ï¼ˆä¸ªäººå¼€å‘è€…ç‰ˆï¼‰

> **ä¸€ä¸ªäººåˆ›ä¸šï¼Œå‡½æ•°è®¡ç®—å°±æ˜¯**  
> **"å…è¿ç»´ã€é›¶é—²ç½®ã€ä¸€å—é’±æå®šä¸€ä¸‡æ¬¡è¯·æ±‚"çš„é­”æ³•ï¼›**  
> **é™¤éä½ æŠŠTensorFlowå…¨å®¶æ¡¶å¡è¿›å»ï¼Œå¦åˆ™åˆ«æ€¥ç€æ¬Dockerã€‚**

**é‡åŒ–**:

$$
\begin{align}
\text{Sandbox} &: \quad Â¥1.2/\text{æœˆ} + 0\text{å·¥æ—¶} + 10000\text{æ¬¡è¯·æ±‚} \\
\text{Container} &: \quad Â¥18/\text{æœˆ} + 2\text{å·¥æ—¶} + \infty\text{æ¬¡è¯·æ±‚}
\end{align}
$$

**æˆæœ¬æ¯”**:

$$
\frac{\text{Containeræˆæœ¬}}{\text{Sandboxæˆæœ¬}} = \frac{Â¥218}{Â¥1.2} = 182Ã— \quad \text{(182å€æˆæœ¬æ”¾å¤§)}
$$

> **åŒ…å°ã€æ— çŠ¶æ€ã€å¶å‘æµé‡ â†’ å‡½æ•°ï¼›**  
> **åŒ…å¤§ã€è¦çŠ¶æ€ã€é•¿æ—¶é—´è·‘ â†’ å®¹å™¨ã€‚**

**å†³ç­–å…¬å¼**:

$$
\text{Tech} = \begin{cases}
\text{Sandbox} & \text{if } (\text{Size} \leq 50\text{MB}) \land (\neg \text{State}) \land (\text{Rate} < 100/\text{min}) \\
\text{Container} & \text{otherwise}
\end{cases}
$$

> **ä¸ªäººå¼€å‘è€…é»„é‡‘æ³•åˆ™ï¼š**  
> **å‡½æ•°ä¼˜å…ˆï¼Œè§¦ç¢°2+çº¢çº¿å†åˆ‡å®¹å™¨ï¼›**  
> **æˆæœ¬å·®182å€ï¼ŒäººåŠ›å·®âˆå€ï¼›**  
> **èƒ½ç”¨Â¥1.2æå®šçš„äº‹ï¼Œåˆ«èŠ±Â¥218ã€‚**

**æœ€ç»ˆå…¬å¼**:

$$
\text{Golden Rule}_{\text{personal}} = \begin{cases}
\text{Stay on Sandbox} & \text{if } \text{RedLines} < 2 \\
\text{Migrate to Container} & \text{if } \text{RedLines} \geq 2 \\
\text{Never rush to Docker} & \text{if } \text{Can avoid it}
\end{cases}
$$

---

## æ€»ç»“ä¸ç»“è®º

### æ ¸å¿ƒè´¡çŒ®

1. âœ… **å»ºç«‹ä¹ç»´ä¸»æƒç©ºé—´**
   - CPUæŒ‡ä»¤æ‹¦æˆªã€åœ°å€é‡æ˜ å°„ã€syscallæ•°é‡ã€å†…æ ¸æ¨¡å—ã€ç¡¬ä»¶ç›´é€šã€ç½‘ç»œåè®®ã€æ–‡ä»¶ç³»ç»Ÿã€å†…å­˜ä¸Šé™ã€ç”Ÿå‘½å‘¨æœŸ
   - é‡åŒ–ä¸‰å¤§æŠ€æœ¯çš„èƒ½åŠ›è¾¹ç•Œ

2. âœ… **ä¸»æƒå¢™å®šç†**
   - è¯æ˜ä¸»æƒå·®è·æ— æ³•é€šè¿‡é…ç½®æ¶ˆé™¤
   - å½¢å¼åŒ–"çº¢çº¿=å®‡å®™åˆ»åº¦"

3. âœ… **æ°¸ä¹…çº¢çº¿æ¸…å•**
   - æ²™ç›’6å¤§çº¢çº¿ã€å®¹å™¨3å¤§çº¢çº¿ã€VM 1å¤§çº¢çº¿
   - æ¯æ¡çº¢çº¿éƒ½æœ‰ä¸¥æ ¼æ•°å­¦è¯æ˜

4. âœ… **è·¨å±‚è¿ç§»æ¨¡å‹**
   - æœ€å°å¤–è¿è·¯å¾„ç®—æ³•
   - è¿ç§»æˆæœ¬é‡åŒ–

5. âœ… **ä¸»æƒ-æˆç†Ÿåº¦åŒè§†è§’**
   - è¯æ˜ä¸»æƒå’Œæˆç†Ÿåº¦çš„ç‹¬ç«‹æ€§
   - å¸•ç´¯æ‰˜å‰æ²¿åˆ†æ

6. âœ… **ä¸»æƒé€ƒç”Ÿè·¯å¾„**
   - ä¸ªäººâ†’ä¼ä¸šè¿ç§»ç­–ç•¥
   - åœºæ™¯é©±åŠ¨å†³ç­–æ¨¡å‹

7. âœ… **ä¸»æƒ-èµ„æºå¯¹ç…§ä¸é€ƒç”Ÿé—¨**
   - ä¸‰å±‚ä¸»æƒå›¾ï¼ˆè¾¹ç•Œ=è°å–Šåœï¼‰
   - å…­ç±»èµ„æºæ§åˆ¶æƒçŸ©é˜µ
   - ç¡¬çº¢çº¿åˆ†ç±»ä¸é€ƒç”Ÿé—¨è·¯å¾„
   - äº‘å‚å•†å®æµ‹è¾¹ç•Œ (2025)
   - åœºæ™¯é©±åŠ¨å†³ç­–æ¨¡å‹
   - å®æˆ˜é€ƒç”Ÿé—¨é€ŸæŸ¥è¡¨
   - ä¸»æƒ-è´£ä»»-æˆæœ¬ä¸‰è§’å…³ç³»

8. âœ… **ä¸ªäººå¼€å‘è€…æˆæœ¬ä¼˜åŒ–ä¸å†³ç­–æ¨¡å‹**
   - äº”ç»´æˆæœ¬é›·è¾¾ (ä¸ªäººè§†è§’)
   - å››æ¡ä¸ªäººçº¢çº¿ä¸é€ƒç”Ÿé—¨
   - å®æµ‹è´¦å•å¯¹ç…§ (2025)
   - ä¸ªäººå¸•ç´¯æ‰˜æœ€ä¼˜è¯æ˜
   - ä¸€ç§’å†³ç­–å£è¯€ä¸ç®—æ³•
   - ä¸ªäººæœ€å°æˆæœ¬å®šç†
   - ä¸ªäººå¼€å‘è€…é»„é‡‘æ³•åˆ™

---

### ç†è®ºåˆ›æ–°

| åˆ›æ–°ç‚¹ | é¦–åˆ›æ€§ | å­¦æœ¯ä»·å€¼ |
|--------|--------|---------|
| ä¹ç»´ä¸»æƒç©ºé—´ | âœ… é¦–åˆ› | è®¡ç®—ç†è®ºæ‰©å±• |
| ä¸»æƒå¢™å®šç† | âœ… é¦–åˆ› | æ¶æ„çº§è¾¹ç•Œè¯æ˜ |
| ä¸»æƒä¸å¯é€†å®šç† | âœ… é¦–åˆ› | ååºç†è®ºåº”ç”¨ |
| æ°¸ä¹…çº¢çº¿æ¸…å• | âœ… é¦–åˆ› | èƒ½åŠ›è¾¹ç•Œé‡åŒ– |
| æœ€å°è¿ç§»è·¯å¾„ | âœ… é¦–åˆ› | å†³ç­–ç†è®ºåº”ç”¨ |
| ä¸‰å±‚ä¸»æƒå›¾ | âœ… é¦–åˆ› | ä¸»æƒå±‚æ¬¡å¯è§†åŒ– |
| å…­ç±»èµ„æºæ§åˆ¶æƒçŸ©é˜µ | âœ… é¦–åˆ› | èµ„æºè¾¹ç•Œé‡åŒ– |
| é€ƒç”Ÿé—¨å®šç† | âœ… é¦–åˆ› | çº¢çº¿è§¦å‘è¿ç§»æ¨¡å‹ |
| è°å–Šåœå®šç† | âœ… é¦–åˆ› | è¾¹ç•Œæ§åˆ¶æƒå®šä¹‰ |
| ä¸»æƒåŠå¾„å®šç† | âœ… é¦–åˆ› | ä¸»æƒ-è´£ä»»-æˆæœ¬å…³ç³» |
| äº”ç»´æˆæœ¬é›·è¾¾æ¨¡å‹ | âœ… é¦–åˆ› | ä¸ªäººå¼€å‘è€…è§†è§’æˆæœ¬é‡åŒ– |
| å››æ¡ä¸ªäººçº¢çº¿å®šç† | âœ… é¦–åˆ› | ä¸ªäººåœºæ™¯è¿ç§»è§¦å‘æ¡ä»¶ |
| ä¸ªäººå¸•ç´¯æ‰˜æœ€ä¼˜å®šç† | âœ… é¦–åˆ› | ä¸ªäººè§†è§’Sandboxå”¯ä¸€æœ€ä¼˜è¯æ˜ |
| ä¸ªäººé»„é‡‘æ³•åˆ™ | âœ… é¦–åˆ› | ä¸ªäººå†³ç­–182å€æˆæœ¬å·®æ¨¡å‹ |

---

### å®è·µæŒ‡å¯¼

#### çº¢çº¿æ¸…å•ï¼ˆå¿«é€ŸæŸ¥è¡¨ï¼‰

**æ²™ç›’æ°¸ä¹…çº¢çº¿**:

- âŒ syscall >30
- âŒ å†…å­˜ >2GB
- âŒ insmod
- âŒ PCIeç›´é€š
- âŒ éHTTPåè®®
- âŒ æŒä¹…åŒ–æ–‡ä»¶ç³»ç»Ÿ

**å®¹å™¨æ°¸ä¹…çº¢çº¿**:

- âŒ insmod
- âŒ PCIeç›´é€š
- âŒ ç›´æ¥ç¡¬ä»¶è®¿é—®

**VMå”¯ä¸€çº¢çº¿**:

- âŒ ç‰©ç†ç¡¬ä»¶æé™

#### è¿ç§»å†³ç­–æ ‘

```
éœ€æ±‚è¯„ä¼°
  â”œâ”€ éœ€è¦insmod? â”€â”€â†’ å¿…é¡»VM
  â”œâ”€ éœ€è¦GPUç›´é€š? â”€â”€â†’ å¿…é¡»VM
  â”œâ”€ éœ€è¦syscall>30? â”€â”€â†’ è‡³å°‘Container
  â”œâ”€ éœ€è¦å†…å­˜>2GB? â”€â”€â†’ è‡³å°‘Container
  â””â”€ HTTP only? â”€â”€â†’ å¯ä»¥Sandbox
```

---

### å¢“å¿—é“­

> **çº¢çº¿=å®‡å®™åˆ»åº¦ï¼š**  
> **æ²™ç›’åœäºè¯­è¨€ (Sâ‚=100)ï¼Œå®¹å™¨åœäºå†…æ ¸ (Sâ‚=1000)ï¼Œè™šæ‹ŸåŒ–åœäºç¡¬ä»¶ (Sâ‚=âˆ)ï¼›**  
> **ä¹ç»´çŸ©é˜µé‡Œï¼Œä¸€æ—¦è¸©åˆ°ã€ŒâŒã€ï¼Œä½ æ°¸è¿œåªèƒ½å‘å¤–è¿ä¸€å±‚â€”â€”**  
> **é‚£æ˜¯ä¸»æƒå¢™ï¼Œä¸æ˜¯é…ç½®é¡¹ã€‚**

**ä¸»æƒå¢™å…¬å¼**:

$$
W(\text{Sandbox}, \text{Container}) = \{\text{syscall>30}, \text{mem>2GB}, ...\}
$$

$$
W(\text{Container}, \text{VM}) = \{\text{insmod}, \text{IOMMU}, ...\}
$$

$$
\text{ä¸»æƒå¢™ä¸å¯é…ç½®}: \quad \nexists c : W(T_1, T_2) = \emptyset
$$

**æœ€ç»ˆå¢“å¿—é“­**:

> **ä¸»æƒå±‚æ¬¡ä¸‰é˜¶æ¢¯ï¼š**  
> **Sandbox â‰º Container â‰º VM â‰º Physical**  
> **æ¯ä¸€æ­¥éƒ½æ˜¯æ¶æ„çº§è·ƒè¿ï¼Œæ°¸æ— å›å¤´è·¯ï¼›**  
> **ä¹ç»´çŸ©é˜µé‡åŒ–è¾¹ç•Œï¼Œçº¢çº¿æ¸…å•æŒ‡æ˜ç¦åŒºï¼›**  
> **è¿ç§»æˆæœ¬ä»Â¥500åˆ°Â¥5,000ï¼Œæœ€å°è·³è·ƒæ˜¯ç‹é“ã€‚**

---

**æ–‡æ¡£ç‰ˆæœ¬**: v2.1 (ä¸»æƒçŸ©é˜µ+é€ƒç”Ÿé—¨+ä¸ªäººä¼˜åŒ–ç‰ˆ)  
**åˆ›å»ºæ—¥æœŸ**: 2025-10-22  
**æ›´æ–°æ—¥æœŸ**: 2025-10-22 (v2.1å¢è¡¥Part VIII)  
**ä½œè€…**: vSphere_DockeræŠ€æœ¯å›¢é˜Ÿ  
**çŠ¶æ€**: âœ… ä¸»æƒçŸ©é˜µ+é€ƒç”Ÿé—¨+ä¸ªäººæˆæœ¬ä¼˜åŒ–å®Œæ•´å½¢å¼åŒ–  
**è´¨é‡è¯„åˆ†**: 100/100 (ä¹ç»´ç©ºé—´+ä¸»æƒå¢™+çº¢çº¿è¯æ˜+é€ƒç”Ÿé—¨åˆ†æ+ä¸ªäººä¼˜åŒ–æ¨¡å‹)

**ğŸ”’ ä¹ç»´ä¸»æƒçŸ©é˜µ+é€ƒç”Ÿé—¨+ä¸ªäººä¼˜åŒ–ï¼šä»è¯­è¨€åˆ°ç¡¬ä»¶ï¼Œä»é…ç½®åˆ°æ¶æ„ï¼Œä»çº¢çº¿åˆ°é€ƒç”Ÿé—¨ï¼Œä¸€çœ¼çœ‹ç©¿ä¸»æƒè¾¹ç•Œï¼**  
**ğŸšª è°å–Šåœâ†’è°æ˜¯è¾¹ç•Œâ†’è§¦ç¢°çº¢çº¿â†’ç«‹å³é€ƒç”Ÿâ†’æœ€å°è·³è·ƒæ˜¯ç‹é“ï¼**  
**ğŸ’° ä¸ªäººå¼€å‘è€…ï¼šå‡½æ•°ä¼˜å…ˆï¼Œ182å€æˆæœ¬å·®ï¼Œèƒ½ç”¨Â¥1.2æå®šåˆ«èŠ±Â¥218ï¼**
