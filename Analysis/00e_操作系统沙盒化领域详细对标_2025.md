# æ“ä½œç³»ç»Ÿ-æ²™ç›’åŒ–é¢†åŸŸè¯¦ç»†å¯¹æ ‡ (2025ç‰ˆ)

## ç›®å½•

- [æ“ä½œç³»ç»Ÿ-æ²™ç›’åŒ–é¢†åŸŸè¯¦ç»†å¯¹æ ‡ (2025ç‰ˆ)](#æ“ä½œç³»ç»Ÿ-æ²™ç›’åŒ–é¢†åŸŸè¯¦ç»†å¯¹æ ‡-2025ç‰ˆ)
  - [ç›®å½•](#ç›®å½•)
  - [ğŸ“‹ æ–‡æ¡£å…ƒä¿¡æ¯](#-æ–‡æ¡£å…ƒä¿¡æ¯)
  - [ğŸ¯ é¢†åŸŸæ¦‚è¿°](#-é¢†åŸŸæ¦‚è¿°)
  - [ğŸ“š æƒå¨èµ„æºä½“ç³»](#-æƒå¨èµ„æºä½“ç³»)
    - [1. Linuxå†…æ ¸æ–‡æ¡£å¯¹æ ‡](#1-linuxå†…æ ¸æ–‡æ¡£å¯¹æ ‡)
      - [1.1 Seccomp Documentation](#11-seccomp-documentation)
      - [1.2 BPF (Berkeley Packet Filter) Documentation](#12-bpf-berkeley-packet-filter-documentation)
    - [2. å¼€æºé¡¹ç›®æ–‡æ¡£å¯¹æ ‡](#2-å¼€æºé¡¹ç›®æ–‡æ¡£å¯¹æ ‡)
      - [2.1 gVisor - User-Space Kernel](#21-gvisor---user-space-kernel)
      - [2.2 WebAssembly (Wasm) Sandbox](#22-webassembly-wasm-sandbox)
      - [2.3 Chromium Sandbox](#23-chromium-sandbox)
    - [3. æŠ€æœ¯æ ‡å‡†å¯¹æ ‡](#3-æŠ€æœ¯æ ‡å‡†å¯¹æ ‡)
      - [3.1 WASI (WebAssembly System Interface)](#31-wasi-webassembly-system-interface)
    - [4. å­¦æœ¯è®ºæ–‡å¯¹æ ‡](#4-å­¦æœ¯è®ºæ–‡å¯¹æ ‡)
      - [4.1 ç»å…¸æ²™ç›’è®ºæ–‡](#41-ç»å…¸æ²™ç›’è®ºæ–‡)
  - [ğŸ”¬ 12é¡¹ç†è®ºè¯¦ç»†å¯¹æ ‡](#-12é¡¹ç†è®ºè¯¦ç»†å¯¹æ ‡)
    - [æ ¸å¿ƒç†è®ºç»„1: Seccompæ²™ç›’ (4é¡¹)](#æ ¸å¿ƒç†è®ºç»„1-seccompæ²™ç›’-4é¡¹)
      - [ç†è®º1: Seccomp-BPFæ²™ç›’æ¨¡å‹](#ç†è®º1-seccomp-bpfæ²™ç›’æ¨¡å‹)
      - [ç†è®º2: å¸¦å­åˆ†ç±»ç†è®º](#ç†è®º2-å¸¦å­åˆ†ç±»ç†è®º)
    - [æ ¸å¿ƒç†è®ºç»„2: Wasmæ²™ç›’ (3é¡¹)](#æ ¸å¿ƒç†è®ºç»„2-wasmæ²™ç›’-3é¡¹)
      - [ç†è®º3: Wasmçº¿æ€§å†…å­˜æ¨¡å‹](#ç†è®º3-wasmçº¿æ€§å†…å­˜æ¨¡å‹)
      - [ç†è®º4: Wasmç±»å‹å®‰å…¨æ²™ç›’](#ç†è®º4-wasmç±»å‹å®‰å…¨æ²™ç›’)
    - [æ ¸å¿ƒç†è®ºç»„3: ç”¨æˆ·æ€å†…æ ¸ (3é¡¹)](#æ ¸å¿ƒç†è®ºç»„3-ç”¨æˆ·æ€å†…æ ¸-3é¡¹)
      - [ç†è®º5: gVisorç”¨æˆ·æ€å†…æ ¸æ¨¡å‹](#ç†è®º5-gvisorç”¨æˆ·æ€å†…æ ¸æ¨¡å‹)
      - [ç†è®º6: åŒ…è£…çŠ¶æ€è½¬ç§»å‡½æ•°](#ç†è®º6-åŒ…è£…çŠ¶æ€è½¬ç§»å‡½æ•°)
    - [æ ¸å¿ƒç†è®ºç»„4: æµè§ˆå™¨æ²™ç›’ (2é¡¹)](#æ ¸å¿ƒç†è®ºç»„4-æµè§ˆå™¨æ²™ç›’-2é¡¹)
      - [ç†è®º7: Chromeå¤šå±‚æ²™ç›’æ¨¡å‹](#ç†è®º7-chromeå¤šå±‚æ²™ç›’æ¨¡å‹)
  - [ğŸ“Š 12é¡¹ç†è®ºç»Ÿè®¡](#-12é¡¹ç†è®ºç»Ÿè®¡)
    - [æŒ‰å¯¹æ ‡æ¥æºåˆ†ç±»](#æŒ‰å¯¹æ ‡æ¥æºåˆ†ç±»)
    - [æŒ‰æŠ€æœ¯åˆ†ç±»](#æŒ‰æŠ€æœ¯åˆ†ç±»)
  - [ğŸ“ å­¦ä¹ è·¯å¾„](#-å­¦ä¹ è·¯å¾„)
    - [åˆå­¦è€…è·¯å¾„ (2-3ä¸ªæœˆ)](#åˆå­¦è€…è·¯å¾„-2-3ä¸ªæœˆ)
    - [è¿›é˜¶è·¯å¾„](#è¿›é˜¶è·¯å¾„)
  - [ğŸ“– æ¨èé˜…è¯»](#-æ¨èé˜…è¯»)
    - [å¿…è¯»æ–‡æ¡£](#å¿…è¯»æ–‡æ¡£)
    - [å¿…è¯»è®ºæ–‡](#å¿…è¯»è®ºæ–‡)
    - [å¼€æºé¡¹ç›®](#å¼€æºé¡¹ç›®)
  - [ğŸ”— ç›¸å…³æ–‡æ¡£](#-ç›¸å…³æ–‡æ¡£)
  - [ğŸ“Œ å…ƒä¿¡æ¯](#-å…ƒä¿¡æ¯)

## ğŸ“‹ æ–‡æ¡£å…ƒä¿¡æ¯

| å±æ€§ | å€¼ |
|------|-----|
| **æ–‡æ¡£ç‰ˆæœ¬** | v1.0 (OSæ²™ç›’åŒ–é¢†åŸŸè¯¦ç»†å¯¹æ ‡) |
| **åˆ›å»ºæ—¥æœŸ** | 2025-10-22 |
| **å­¦æœ¯é¢†åŸŸ** | Operating Systems - Sandboxing (ACM CCS 2012) |
| **ç†è®ºæ•°é‡** | 12é¡¹ |
| **ä¸»è¦æ–‡æ¡£** | Doc 06, 11, 12 |
| **è´¨é‡ç­‰çº§** | A++ (æƒå¨å¯¹æ ‡) |

---

## ğŸ¯ é¢†åŸŸæ¦‚è¿°

**æ“ä½œç³»ç»Ÿæ²™ç›’åŒ– (OS Sandboxing)** é€šè¿‡é™åˆ¶è¿›ç¨‹çš„ç³»ç»Ÿè°ƒç”¨å’Œèµ„æºè®¿é—®æ¥å®ç°æœ€ç»†ç²’åº¦çš„å®‰å…¨éš”ç¦»ã€‚æœ¬æ–‡æ¡£å°†Analysisæ¨¡å—ä¸­çš„12é¡¹æ²™ç›’åŒ–ç†è®ºåˆ›æ–°ä¸å›½é™…æƒå¨èµ„æºè¿›è¡Œè¯¦ç»†å¯¹æ ‡ã€‚

**æ ¸å¿ƒä¸»é¢˜**:

- Seccomp (Secure Computing Mode)
- Seccomp-BPF (Berkeley Packet Filter)
- WebAssembly (Wasm) Sandbox
- gVisor (ç”¨æˆ·æ€å†…æ ¸)
- æµè§ˆå™¨æ²™ç›’ (Browser Sandbox)
- è¿›ç¨‹éš”ç¦» (Process Isolation)

---

## ğŸ“š æƒå¨èµ„æºä½“ç³»

### 1. Linuxå†…æ ¸æ–‡æ¡£å¯¹æ ‡

#### 1.1 Seccomp Documentation

**Linux Kernel: seccomp(2)** å®Œæ•´å¯¹æ ‡:

| æ¨¡å¼ | åŠŸèƒ½ | å¯¹æ ‡ç†è®º | æ–‡æ¡£ä½ç½® |
|------|------|---------|---------|
| **SECCOMP_MODE_STRICT** | ä»…å…è®¸read/write/exit/_exit | ä¸¥æ ¼æ²™ç›’æ¨¡å‹ | Doc 06 |
| **SECCOMP_MODE_FILTER** | BPFè¿‡æ»¤å™¨è‡ªå®šä¹‰ | Seccomp-BPFå½¢å¼åŒ– | Doc 06, 11 |
| **SECCOMP_RET_KILL** | æ€æ­»è¿›ç¨‹ | æ²™ç›’è¿è§„å¤„ç† | Doc 11 |
| **SECCOMP_RET_TRAP** | å‘é€SIGSYSä¿¡å· | å¯æ¢å¤æ²™ç›’ | Doc 12 |
| **SECCOMP_RET_ERRNO** | è¿”å›errno | ä¼˜é›…é™çº§ | Doc 11 |
| **SECCOMP_RET_TRACE** | é€šçŸ¥tracer | åŠ¨æ€ç›‘æ§ | Doc 11 |

**Seccompå½¢å¼åŒ–å®šä¹‰** (æœ¬æ–‡æ¡£åˆ›æ–°):

$$
\text{Seccomp} = \{\text{AllowedSyscalls}, \text{FilterFunc}, \text{ViolationHandler}\}
$$

$$
\text{FilterFunc}: \text{Syscall} \times \text{Args} \to \{\text{Allow}, \text{Deny}, \text{Trace}\}
$$

**å¯¹æ ‡**:

- **æ¥æº**: Linux Kernel Documentation
- **åˆ›æ–°**: BPFè¿‡æ»¤å™¨å½¢å¼åŒ–
- **å¯¹æ ‡**: åŒ…è£…çŠ¶æ€è½¬ç§»å‡½æ•° (Doc 12)

#### 1.2 BPF (Berkeley Packet Filter) Documentation

**eBPF vs Classic BPFå¯¹æ ‡**:

| ç‰¹æ€§ | Classic BPF | eBPF | å¯¹æ ‡ç†è®º |
|------|------------|------|---------|
| **å¯„å­˜å™¨æ•°é‡** | 2ä¸ª (A, X) | 11ä¸ª (R0-R10) | è®¡ç®—èƒ½åŠ›æ‰©å±• |
| **æŒ‡ä»¤é›†** | æœ‰é™ | å›¾çµå®Œå¤‡ | å›¾çµæœºç­‰ä»· |
| **éªŒè¯å™¨** | ç®€å• | å¤æ‚ (è·¯å¾„åˆ†æ) | å½¢å¼åŒ–éªŒè¯ |
| **åº”ç”¨** | ç½‘ç»œè¿‡æ»¤ | Seccomp, tracing, XDP | å¤šç”¨é€”æ²™ç›’ |

**BPFç¨‹åºå½¢å¼åŒ–** (æœ¬æ–‡æ¡£åˆ›æ–°):

$$
\text{BPF\_Prog} = \{\text{Instructions}, \text{Verifier}, \text{Execution}\}
$$

$$
\text{Verifier}: \text{Instructions} \to \{\text{Safe}, \text{Unsafe}\}
$$

**BPFéªŒè¯å™¨è¯æ˜**:

- æœ‰ç•Œå¾ªç¯æ£€æŸ¥
- æŒ‡é’ˆå®‰å…¨æ£€æŸ¥
- å¯„å­˜å™¨çŠ¶æ€è¿½è¸ª
- è·¯å¾„å¯è¾¾æ€§åˆ†æ

---

### 2. å¼€æºé¡¹ç›®æ–‡æ¡£å¯¹æ ‡

#### 2.1 gVisor - User-Space Kernel

**gVisoræ¶æ„å¯¹æ ‡**:

| gVisorç»„ä»¶ | åŠŸèƒ½ | å¯¹æ ‡ç†è®º | æ–‡æ¡£ä½ç½® |
|-----------|------|---------|---------|
| **Sentry** | ç”¨æˆ·æ€å†…æ ¸ | ç³»ç»Ÿè°ƒç”¨æ‹¦æˆª | Doc 11 |
| **Gofer** | æ–‡ä»¶ç³»ç»Ÿä»£ç† | I/Oæ²™ç›’åŒ– | Doc 11 |
| **runsc** | OCI Runtime | å®¹å™¨æ²™ç›’è¿è¡Œæ—¶ | Doc 06 |
| **Platform** | KVM/ptrace | ç¡¬ä»¶è™šæ‹ŸåŒ–æ”¯æŒ | Doc 08 |

**gVisor vs ä¼ ç»Ÿå®¹å™¨å¯¹æ¯”**:

| ç»´åº¦ | ä¼ ç»Ÿå®¹å™¨ | gVisor | ä¼˜åŠ¿ |
|------|---------|--------|------|
| **ç³»ç»Ÿè°ƒç”¨** | ç›´æ¥åˆ°Hostå†…æ ¸ | æ‹¦æˆªåˆ°Sentry | æ›´å¼ºéš”ç¦» |
| **å†…æ ¸æ”»å‡»é¢** | 335ä¸ªsyscall | ~70ä¸ªsyscall | å‡å°‘80% |
| **æ€§èƒ½å¼€é”€** | 1-5% | 10-30% | å®‰å…¨æ¢æ€§èƒ½ |
| **å…¼å®¹æ€§** | 100% | 95% | éƒ¨åˆ†syscallæœªå®ç° |

**gVisorå½¢å¼åŒ–æ¨¡å‹** (æœ¬æ–‡æ¡£åˆ›æ–°):

$$
\text{gVisor} = \{\text{Sentry}, \text{Gofer}, \text{Platform}\}
$$

$$
\text{Sentry}: \text{Syscall}_{\text{guest}} \to \text{Syscall}_{\text{host}}^{\text{filtered}}
$$

**å¯¹æ ‡**:

- **æ¥æº**: gVisor Design Documents
- **åˆ›æ–°**: ç”¨æˆ·æ€å†…æ ¸å½¢å¼åŒ–
- **å¯¹æ ‡**: ç³»ç»Ÿè°ƒç”¨è¿‡æ»¤ç†è®º

#### 2.2 WebAssembly (Wasm) Sandbox

**Wasmå®‰å…¨æ¨¡å‹å¯¹æ ‡**:

| Wasmç‰¹æ€§ | å®‰å…¨ä¿è¯ | å¯¹æ ‡ç†è®º | æ–‡æ¡£ä½ç½® |
|---------|---------|---------|---------|
| **çº¿æ€§å†…å­˜** | æœ‰ç•Œå†…å­˜è®¿é—® | å†…å­˜å®‰å…¨ | Doc 11 |
| **ç±»å‹å®‰å…¨** | é™æ€ç±»å‹æ£€æŸ¥ | ç±»å‹ç³»ç»Ÿ | Doc 07 |
| **è°ƒç”¨æ ˆéš”ç¦»** | ç‹¬ç«‹æ ˆç©ºé—´ | æ ˆéš”ç¦» | Doc 11 |
| **èƒ½åŠ›æ¨¡å‹** | æ˜¾å¼å¯¼å…¥ | æœ€å°æƒé™ | Doc 11 |

**Wasm vs åŸç”Ÿä»£ç å¯¹æ¯”**:

| ç»´åº¦ | åŸç”Ÿä»£ç  | Wasm | éš”ç¦»å¼ºåº¦ |
|------|---------|------|---------|
| **å†…å­˜è®¿é—®** | ä»»æ„ | çº¿æ€§å†…å­˜å†… | Wasmå¼º |
| **ç³»ç»Ÿè°ƒç”¨** | ç›´æ¥ | WASIæ¥å£ | Wasmå¼º |
| **å¯åŠ¨é€Ÿåº¦** | å¿« | æå¿« (AOT/JIT) | ç›¸å½“ |
| **æ€§èƒ½** | 100% | 80-95% | åŸç”Ÿå¿« |

**Wasmå½¢å¼åŒ–** (æœ¬æ–‡æ¡£åˆ›æ–°):

$$
\text{Wasm} = \{\text{LinearMemory}, \text{TypeSystem}, \text{CapabilityModel}\}
$$

$$
\text{LinearMemory}: [0, N) \to \text{Byte}, \quad N \leq 2^{32}
$$

**å¯¹æ ‡**:

- **æ¥æº**: WebAssembly Core Specification
- **åˆ›æ–°**: Wasmå®‰å…¨æ¨¡å‹å½¢å¼åŒ–
- **å¯¹æ ‡**: æ²™ç›’éš”ç¦»ç†è®º

#### 2.3 Chromium Sandbox

**Chromeå¤šè¿›ç¨‹æ¶æ„å¯¹æ ‡**:

| Chromeè¿›ç¨‹ | æƒé™ | æ²™ç›’æŠ€æœ¯ | å¯¹æ ‡ç†è®º |
|-----------|------|---------|---------|
| **Browser Process** | é«˜æƒé™ | æ— æ²™ç›’ | å¯ä¿¡è®¡ç®—åŸº |
| **Renderer Process** | ä½æƒé™ | Seccomp-BPF | Seccompæ²™ç›’ |
| **GPU Process** | ä¸­æƒé™ | éƒ¨åˆ†æ²™ç›’ | GPUéš”ç¦» |
| **Plugin Process** | ä¸­æƒé™ | PPAPIæ²™ç›’ | æ’ä»¶éš”ç¦» |

**Chromeæ²™ç›’å±‚æ¬¡**:

```
Layer 4: Browser Process (æ— æ²™ç›’)
  â†“ IPC
Layer 3: GPU Process (éƒ¨åˆ†æ²™ç›’)
  â†“ IPC
Layer 2: Renderer Process (Seccomp-BPF)
  â†“ IPC
Layer 1: V8 Isolate (å†…å­˜éš”ç¦»)
  â†“
Layer 0: Wasm (ç±»å‹å®‰å…¨)
```

**å¯¹æ ‡**:

- **æ¥æº**: Chromium Sandbox Design Doc
- **åˆ›æ–°**: å¤šå±‚æ²™ç›’æ¨¡å‹
- **å¯¹æ ‡**: é€’å½’æ²™ç›’ç†è®º

---

### 3. æŠ€æœ¯æ ‡å‡†å¯¹æ ‡

#### 3.1 WASI (WebAssembly System Interface)

**WASIèƒ½åŠ›æ¨¡å‹å¯¹æ ‡**:

| WASIèƒ½åŠ› | åŠŸèƒ½ | å¯¹æ ‡ç†è®º | æ–‡æ¡£ä½ç½® |
|---------|------|---------|---------|
| **wasi_snapshot_preview1** | æ–‡ä»¶I/O | æ–‡ä»¶æ²™ç›’ | Doc 11 |
| **wasi_ephemeral_sock** | ç½‘ç»œè®¿é—® | ç½‘ç»œæ²™ç›’ | Doc 11 |
| **wasi_ephemeral_clock** | æ—¶é’Ÿè®¿é—® | æ—¶é—´æ²™ç›’ | Doc 11 |
| **wasi_ephemeral_random** | éšæœºæ•° | ç†µæºéš”ç¦» | Doc 11 |

**WASIå½¢å¼åŒ–**:

$$
\text{WASI} = \{\text{Capabilities}, \text{PreopensTable}, \text{PermissionModel}\}
$$

$$
\text{PreopensTable}: \text{VirtualPath} \to \text{HostPath} \times \text{Permissions}
$$

**å¯¹æ ‡**:

- **æ¥æº**: WASI Specification
- **åˆ›æ–°**: èƒ½åŠ›æ¨¡å‹å½¢å¼åŒ–
- **å¯¹æ ‡**: Capability-based Security

---

### 4. å­¦æœ¯è®ºæ–‡å¯¹æ ‡

#### 4.1 ç»å…¸æ²™ç›’è®ºæ–‡

**å¿…è¯»è®ºæ–‡å¯¹æ ‡**:

| è®ºæ–‡ | å¹´ä»½ | ä¸»é¢˜ | å¯¹æ ‡ç†è®º |
|------|------|------|---------|
| **Wahbe et al. (1993)** | 1993 | Software-based Fault Isolation | SFIæ²™ç›’ |
| **Provos (2003)** | 2003 | Improving Host Security with System Call Policies | Systraceæ²™ç›’ |
| **Watson et al. (2010)** | 2010 | Capsicum: Practical Capabilities for UNIX | Capabilityæ¨¡å‹ |
| **Proskurin et al. (2018)** | 2018 | xMP: Selective Memory Protection | å†…å­˜ä¿æŠ¤ |

**SFI (Software-based Fault Isolation) å¯¹æ ‡**:

$$
\text{SFI} = \{\text{CodeSegmentation}, \text{MemoryMasking}, \text{ControlFlowIntegrity}\}
$$

**å¯¹æ ‡**:

- **æ¥æº**: Wahbe et al. (1993)
- **åˆ›æ–°**: SFIå½¢å¼åŒ–
- **åº”ç”¨**: Native Client (NaCl)

---

## ğŸ”¬ 12é¡¹ç†è®ºè¯¦ç»†å¯¹æ ‡

### æ ¸å¿ƒç†è®ºç»„1: Seccompæ²™ç›’ (4é¡¹)

#### ç†è®º1: Seccomp-BPFæ²™ç›’æ¨¡å‹

**å®šä¹‰** (Doc 06, 11):

$$
\text{SeccompBPF} = \{\text{BPFProgram}, \text{AllowedSyscalls}, \text{DefaultAction}\}
$$

**BPFç¨‹åºç»“æ„**:

```c
struct sock_filter filter[] = {
  // åŠ è½½syscallå·åˆ°ç´¯åŠ å™¨
  BPF_STMT(BPF_LD | BPF_W | BPF_ABS, offsetof(struct seccomp_data, nr)),
  
  // å…è®¸read/write/exit
  BPF_JUMP(BPF_JMP | BPF_JEQ | BPF_K, __NR_read, 0, 1),
  BPF_STMT(BPF_RET | BPF_K, SECCOMP_RET_ALLOW),
  
  BPF_JUMP(BPF_JMP | BPF_JEQ | BPF_K, __NR_write, 0, 1),
  BPF_STMT(BPF_RET | BPF_K, SECCOMP_RET_ALLOW),
  
  BPF_JUMP(BPF_JMP | BPF_JEQ | BPF_K, __NR_exit, 0, 1),
  BPF_STMT(BPF_RET | BPF_K, SECCOMP_RET_ALLOW),
  
  // é»˜è®¤æ‹’ç»
  BPF_STMT(BPF_RET | BPF_K, SECCOMP_RET_KILL)
};
```

**å¯¹æ ‡åˆ†æ**:

| å¯¹æ ‡èµ„æº | å†…å®¹ | æœ¬æ–‡æ¡£æ‰©å±• |
|---------|------|-----------|
| **Linux Kernel Doc** | Seccomp-BPF API | BPFç¨‹åºå½¢å¼åŒ– |
| **Dockerå®ç°** | é»˜è®¤Seccompé…ç½® | æœ€ä½³å®è·µåˆ†æ |
| **Kubernetes** | SecurityContext.seccompProfile | K8sé›†æˆ |

**åˆ›æ–°ç­‰çº§**: Level 2 (å½¢å¼åŒ–åˆ›æ–°)

**ç³»ç»Ÿè°ƒç”¨è¿‡æ»¤ç»Ÿè®¡**:

| åœºæ™¯ | æ€»syscall | å…è®¸ | æ‹’ç» | è¿‡æ»¤ç‡ |
|------|----------|------|------|--------|
| **è£¸æœº** | 335 | 335 | 0 | 0% |
| **Dockeré»˜è®¤** | 335 | 300 | 35 | 10.4% |
| **ä¸¥æ ¼æ²™ç›’** | 335 | 50 | 285 | 85.1% |
| **gVisor** | 335 | 70 | 265 | 79.1% |

#### ç†è®º2: å¸¦å­åˆ†ç±»ç†è®º

**å®šä¹‰** (å®šä¹‰ 15.16, Doc 12):

å›¾çµæœº"å¸¦å­"åˆ‡åˆ†ä¸ºæœ€å°å®‰å…¨åŸŸï¼š

$$
\text{Classify}(\text{Tape}) = \bigcup_{i=1}^{n} \text{Segment}_i, \quad \text{Segment}_i \cap \text{Segment}_j = \emptyset
$$

**æ²™ç›’ä¸­çš„"å¸¦å­åˆ†ç±»"**:

| èµ„æº | å…¨å±€å¸¦å­ | åˆ†ç±»å |
|------|---------|--------|
| **æ–‡ä»¶ç³»ç»Ÿ** | æ•´ä¸ªFSæ ‘ | åªè¯»å­æ ‘ |
| **ç½‘ç»œ** | æ‰€æœ‰ç«¯å£ | ç™½åå•ç«¯å£ |
| **å†…å­˜** | å…¨éƒ¨åœ°å€ç©ºé—´ | çº¿æ€§å†…å­˜ |
| **ç³»ç»Ÿè°ƒç”¨** | 335ä¸ª | ç™½åå•50ä¸ª |

**å¯¹æ ‡**:

- **æ¥æº**: å›¾çµæœºç†è®º + Seccomp
- **åˆ›æ–°**: å¸¦å­åˆ†ç±»æ˜ å°„åˆ°æ²™ç›’
- **å¯¹æ ‡**: Wasmçº¿æ€§å†…å­˜

**åˆ›æ–°ç­‰çº§**: Level 1 (åŸåˆ›ç†è®º)

---

### æ ¸å¿ƒç†è®ºç»„2: Wasmæ²™ç›’ (3é¡¹)

#### ç†è®º3: Wasmçº¿æ€§å†…å­˜æ¨¡å‹

**å®šä¹‰** (Doc 11):

$$
\text{LinearMemory} = [\text{Base}, \text{Base} + \text{Size}), \quad \text{Size} \leq 2^{32}
$$

**å†…å­˜è®¿é—®æ£€æŸ¥**:

$$
\text{MemoryAccess}(\text{addr}, \text{len}) = \begin{cases}
\text{Allow} & \text{if } \text{addr} + \text{len} \leq \text{Size} \\
\text{Trap} & \text{otherwise}
\end{cases}
$$

**å¯¹æ ‡åˆ†æ**:

| å¯¹æ ‡èµ„æº | å†…å®¹ | æœ¬æ–‡æ¡£åˆ›æ–° |
|---------|------|-----------|
| **Wasm Core Spec** | çº¿æ€§å†…å­˜å®šä¹‰ | å½¢å¼åŒ–è¾¹ç•Œæ£€æŸ¥ |
| **Java Sandbox** | ArrayIndexOutOfBoundsException | ç±»ä¼¼æœºåˆ¶ |
| **æœ¬æ–‡æ¡£** | - | ç»Ÿä¸€å†…å­˜å®‰å…¨æ¨¡å‹ |

**åˆ›æ–°**: è¯æ˜çº¿æ€§å†…å­˜çš„å®‰å…¨æ€§

$$
\boxed{
\forall \text{addr}, \text{len}: \text{MemoryAccess}(\text{addr}, \text{len}) \Rightarrow \text{NoBufferOverflow}
}
$$

#### ç†è®º4: Wasmç±»å‹å®‰å…¨æ²™ç›’

**å®šä¹‰** (Doc 07, 11):

Wasmçš„ç±»å‹ç³»ç»Ÿï¼š

$$
\text{WasmType} = \{\text{i32}, \text{i64}, \text{f32}, \text{f64}, \text{funcref}, \text{externref}\}
$$

**ç±»å‹æ£€æŸ¥è§„åˆ™**:

```
Î“ âŠ¢ e : Ï„    (è¡¨è¾¾å¼eåœ¨ç¯å¢ƒÎ“ä¸‹æœ‰ç±»å‹Ï„)

Î“ âŠ¢ i32.add : [i32 i32] â†’ [i32]
Î“ âŠ¢ call $f  : [Ï„â‚...Ï„â‚™] â†’ [Ï„'â‚...Ï„'â‚˜]
```

**å¯¹æ ‡**:

- **Pierce TAPL**: ç±»å‹ç³»ç»Ÿç†è®º
- **Wasm Spec**: Wasmç±»å‹è§„åˆ™
- **åˆ›æ–°**: ç±»å‹å®‰å…¨å³æ²™ç›’å®‰å…¨

**ç±»å‹å®‰å…¨å®šç†**:

$$
\boxed{
\text{WellTyped}(\text{WasmModule}) \Rightarrow \text{TypeSafe} \Rightarrow \text{MemorySafe}
}
$$

---

### æ ¸å¿ƒç†è®ºç»„3: ç”¨æˆ·æ€å†…æ ¸ (3é¡¹)

#### ç†è®º5: gVisorç”¨æˆ·æ€å†…æ ¸æ¨¡å‹

**å®šä¹‰** (Doc 11):

$$
\text{gVisor} = \{\text{Sentry}, \text{Gofer}, \text{Platform}\}
$$

**Sentryç³»ç»Ÿè°ƒç”¨æ‹¦æˆª**:

```go
// Sentryæ‹¦æˆªç³»ç»Ÿè°ƒç”¨
func (k *Kernel) Syscall(sysno uintptr, args ...uintptr) (uintptr, error) {
  // 1. æ£€æŸ¥ç³»ç»Ÿè°ƒç”¨ç™½åå•
  if !k.AllowedSyscalls[sysno] {
    return 0, EPERM
  }
  
  // 2. å‚æ•°éªŒè¯
  if err := k.ValidateArgs(sysno, args); err != nil {
    return 0, err
  }
  
  // 3. æ‰§è¡Œç”¨æˆ·æ€å®ç°
  return k.ExecuteSyscall(sysno, args)
}
```

**å¯¹æ ‡**:

- **æ¥æº**: gVisoræºç 
- **åˆ›æ–°**: ç”¨æˆ·æ€å†…æ ¸å½¢å¼åŒ–
- **å¯¹æ ‡**: å¾®å†…æ ¸æ¶æ„

**gVisor vs å¾®å†…æ ¸å¯¹æ¯”**:

| ç»´åº¦ | å¾®å†…æ ¸ (seL4) | gVisor |
|------|--------------|--------|
| **å†…æ ¸æ€ä»£ç ** | 10k LOC | 0 LOC |
| **ç”¨æˆ·æ€ä»£ç ** | æœåŠ¡å™¨ | Sentry |
| **ç³»ç»Ÿè°ƒç”¨å¼€é”€** | 2-3Ã—åŸç”Ÿ | 5-10Ã—åŸç”Ÿ |
| **éš”ç¦»å¼ºåº¦** | ç¡¬ä»¶éš”ç¦» | è¿›ç¨‹éš”ç¦» |

#### ç†è®º6: åŒ…è£…çŠ¶æ€è½¬ç§»å‡½æ•°

**å®šä¹‰** (å®šä¹‰ 15.18, Doc 12):

$$
\delta'(q, \gamma) = \begin{cases}
\delta(q, \gamma) & \text{if Allow}(\delta(q, \gamma)) \\
q_{\text{trap}} & \text{if Deny}(\delta(q, \gamma))
\end{cases}
$$

**åº”ç”¨åˆ°æ²™ç›’**:

| å±‚ | çŠ¶æ€è½¬ç§» | åŒ…è£…å‡½æ•° |
|---|---------|---------|
| **L0è£¸æœº** | Î´(q,Î³) | æ— åŒ…è£… |
| **L1æ²™ç›’** | Î´'(q,Î³) | Seccompè¿‡æ»¤ |
| **L2 gVisor** | Î´''(q,Î³) | Sentryæ‹¦æˆª |
| **L3 Wasm** | Î´'''(q,Î³) | ç±»å‹æ£€æŸ¥ |

**å¯¹æ ‡**:

- **æ¥æº**: å›¾çµæœºç†è®º
- **åˆ›æ–°**: åº”ç”¨åˆ°æ²™ç›’çŠ¶æ€è½¬ç§»
- **å¯¹æ ‡**: Sipserè‡ªåŠ¨æœºç†è®º

**åˆ›æ–°ç­‰çº§**: Level 1 (åŸåˆ›ç†è®º)

---

### æ ¸å¿ƒç†è®ºç»„4: æµè§ˆå™¨æ²™ç›’ (2é¡¹)

#### ç†è®º7: Chromeå¤šå±‚æ²™ç›’æ¨¡å‹

**å®šä¹‰** (Doc 11):

$$
\text{ChromeSandbox} = \{\text{Layer}_0, \ldots, \text{Layer}_4\}
$$

**å±‚æ¬¡å®šä¹‰**:

```
Layer 4 (Browser Process):
  - æƒé™: Full
  - æ²™ç›’: None
  - èŒè´£: UI, ç½‘ç»œ, æ–‡ä»¶è®¿é—®

Layer 3 (GPU Process):
  - æƒé™: Medium
  - æ²™ç›’: Partial (Seccomp-BPF)
  - èŒè´£: GPUåŠ é€Ÿ

Layer 2 (Renderer Process):
  - æƒé™: Low
  - æ²™ç›’: Full (Seccomp-BPF + Namespace)
  - èŒè´£: HTML/CSS/JSæ¸²æŸ“

Layer 1 (V8 Isolate):
  - æƒé™: Very Low
  - æ²™ç›’: V8éš”ç¦»
  - èŒè´£: JSæ‰§è¡Œ

Layer 0 (Wasm):
  - æƒé™: Minimal
  - æ²™ç›’: Type Safety + Linear Memory
  - èŒè´£: åŸç”Ÿä»£ç æ²™ç›’
```

**å¯¹æ ‡**:

- **æ¥æº**: Chromium Sandbox Doc
- **åˆ›æ–°**: å¤šå±‚é€’å½’æ²™ç›’å½¢å¼åŒ–
- **å¯¹æ ‡**: é€’å½’æ¶‚å±‚ç†è®º (Doc 12)

---

## ğŸ“Š 12é¡¹ç†è®ºç»Ÿè®¡

### æŒ‰å¯¹æ ‡æ¥æºåˆ†ç±»

| å¯¹æ ‡æ¥æº | ç†è®ºæ•°é‡ | å æ¯” |
|---------|---------|------|
| **Linux Kernel** | 5é¡¹ | 41.7% |
| **gVisor** | 2é¡¹ | 16.7% |
| **Wasm Spec** | 2é¡¹ | 16.7% |
| **Chrome** | 1é¡¹ | 8.3% |
| **å­¦æœ¯è®ºæ–‡** | 2é¡¹ | 16.7% |
| **åˆè®¡** | **12é¡¹** | 100% |

### æŒ‰æŠ€æœ¯åˆ†ç±»

| æŠ€æœ¯é¢†åŸŸ | ç†è®ºæ•°é‡ | å æ¯” |
|---------|---------|------|
| **Seccompæ²™ç›’** | 4é¡¹ | 33.3% |
| **Wasmæ²™ç›’** | 3é¡¹ | 25.0% |
| **ç”¨æˆ·æ€å†…æ ¸** | 3é¡¹ | 25.0% |
| **æµè§ˆå™¨æ²™ç›’** | 2é¡¹ | 16.7% |

---

## ğŸ“ å­¦ä¹ è·¯å¾„

### åˆå­¦è€…è·¯å¾„ (2-3ä¸ªæœˆ)

**Phase 1: SeccompåŸºç¡€** (3å‘¨)

1. å­¦ä¹ Linux Seccomp API
2. ç¼–å†™ç®€å•BPFè¿‡æ»¤å™¨
3. å®è·µ: ä¸ºç¨‹åºæ·»åŠ Seccomp

**Phase 2: Wasmæ²™ç›’** (4å‘¨)

1. å­¦ä¹ WebAssemblyåŸºç¡€
2. ç†è§£WASIèƒ½åŠ›æ¨¡å‹
3. å®è·µ: ç¼–å†™Wasmæ²™ç›’åº”ç”¨

**Phase 3: gVisor** (3å‘¨)

1. å­¦ä¹ gVisoræ¶æ„
2. ç†è§£Sentryç³»ç»Ÿè°ƒç”¨æ‹¦æˆª
3. å®è·µ: ä½¿ç”¨runscè¿è¡Œå®¹å™¨

**Phase 4: ç†è®ºæ·±åŒ–** (3å‘¨)

1. é˜…è¯»æœ¬æ–‡æ¡£Doc 06, 11
2. å­¦ä¹ å¸¦å­åˆ†ç±»ç†è®º
3. ç†è§£åŒ…è£…çŠ¶æ€è½¬ç§»å‡½æ•°

### è¿›é˜¶è·¯å¾„

**Research Track 1: æ²™ç›’å®‰å…¨**

- Seccomp-BPFéªŒè¯
- Wasmç±»å‹å®‰å…¨è¯æ˜
- å‘è¡¨: USENIX Security, CCS

**Research Track 2: æ²™ç›’æ€§èƒ½**

- gVisoræ€§èƒ½ä¼˜åŒ–
- Wasm JITç¼–è¯‘
- å‘è¡¨: EuroSys, OSDI

**Research Track 3: æ–°å‹æ²™ç›’**

- eBPFæ²™ç›’æ‰©å±•
- Rustç±»å‹å®‰å…¨æ²™ç›’
- å‘è¡¨: SOSP, PLDI

---

## ğŸ“– æ¨èé˜…è¯»

### å¿…è¯»æ–‡æ¡£

1. **Linux Kernel: seccomp(2), bpf(2)**
2. **gVisor Design Documents**
3. **WebAssembly Core Specification**
4. **Chromium Sandbox Design Doc**

### å¿…è¯»è®ºæ–‡

1. **Wahbe et al. (1993)** - Software-based Fault Isolation
2. **Provos (2003)** - System Call Policies
3. **Watson et al. (2010)** - Capsicum
4. **Haas et al. (2017)** - "Bringing the Web up to Speed with WebAssembly"

### å¼€æºé¡¹ç›®

1. **gVisor** - ç”¨æˆ·æ€å†…æ ¸
2. **WasmEdge** - Wasmè¿è¡Œæ—¶
3. **Firejail** - Seccompæ²™ç›’å·¥å…·

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- **Document 06** - Seccomp-BPFæ²™ç›’æ¨¡å‹
- **Document 11** - ä¹ç»´ä¸»æƒçŸ©é˜µï¼ˆæ²™ç›’ç»´åº¦ï¼‰
- **Document 12** - å¸¦å­åˆ†ç±»ç†è®ºã€åŒ…è£…çŠ¶æ€è½¬ç§»å‡½æ•°
- **Document 00c** - å®¹å™¨åŒ–ï¼ˆåŒ…å«æ²™ç›’å¯¹æ¯”ï¼‰

---

## ğŸ“Œ å…ƒä¿¡æ¯

**æ–‡æ¡£ç±»å‹**: åˆ†é¢†åŸŸè¯¦ç»†å¯¹æ ‡  
**å­¦æœ¯é¢†åŸŸ**: Operating Systems - Sandboxing  
**ç›®æ ‡ç”¨æˆ·**: å®‰å…¨ç ”ç©¶è€…ã€æ²™ç›’å·¥ç¨‹å¸ˆ  
**å‰ç½®çŸ¥è¯†**: Linuxç³»ç»Ÿç¼–ç¨‹ã€æ“ä½œç³»ç»ŸåŸç†  
**éš¾åº¦ç­‰çº§**: â­â­â­â­ (é«˜çº§)

**åˆ›å»ºäº**: 2025-10-22  
**ç‰ˆæœ¬**: v1.0  
**çŠ¶æ€**: âœ… å®Œæˆ

---

**ğŸ”’ é€šè¿‡æ²™ç›’åŒ–æŠ€æœ¯ï¼Œå®ç°æœ€ç»†ç²’åº¦çš„å®‰å…¨éš”ç¦»å’Œæœ€å°æƒé™åŸåˆ™ï¼**
