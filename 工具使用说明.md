# 文档自动化管理工具使用说明

## 问题解决方案

### 问题描述

以前可以通过主题修改自动生成和修改目录，现在需要手工一行行修改，耗费大量精力。

### 解决方案

我们创建了一套完整的文档自动化管理工具，解决目录手工修改的问题。

## 工具介绍

### 1. 自动化目录生成工具

#### 功能特点

- **自动提取标题**：从Markdown文档中自动提取所有标题
- **智能生成目录**：根据标题层次自动生成目录结构
- **自动更新**：检测并更新现有目录
- **批量处理**：支持批量处理多个文档

#### 使用方法

##### Windows系统

```batch
# 更新所有文档的目录
tools\run_automation.bat update-toc

# 为没有目录的文档创建目录
tools\run_automation.bat create-toc

# 批量处理所有文档
tools\run_automation.bat batch
```

##### Linux/Mac系统

```bash
# 更新所有文档的目录
./tools/run_automation.sh update-toc

# 为没有目录的文档创建目录
./tools/run_automation.sh create-toc

# 批量处理所有文档
./tools/run_automation.sh batch
```

##### Python直接调用

```python
# 简化版工具（无需额外依赖）
python tools/simple_toc_updater.py .

# 完整版工具（需要安装依赖）
python tools/auto_toc_generator.py --root . --all --update
```

### 2. 文档自动化管理系统

#### 功能特点

- **质量检查**：自动检查文档结构和内容质量
- **格式修复**：自动修复常见的格式问题
- **模板生成**：快速创建标准化的文档模板
- **批量验证**：批量验证所有文档的质量

#### 使用方法

```python
# 验证文档质量
python tools/document_automation.py --root . --validate

# 生成质量报告
python tools/document_automation.py --root . --report

# 修复格式问题
python tools/document_automation.py --root . --fix "文件路径.md"

# 创建文档模板
python tools/document_automation.py --root . --template "新文档.md" "文档标题"
```

## 快速开始

### 1. 环境准备

#### 检查Python环境

```bash
python --version
# 或
python3 --version
```

#### 安装依赖（可选）

```bash
pip install pyyaml markdown
```

### 2. 一键解决目录问题

#### 方法一：使用批处理脚本（推荐）

```batch
# Windows
tools\run_automation.bat batch

# Linux/Mac
./tools/run_automation.sh batch
```

#### 方法二：使用简化版工具

```python
python tools/simple_toc_updater.py .
```

### 3. 验证结果

运行完成后，所有Markdown文档的目录都会自动更新，无需手工修改。

## 工具配置

### 配置文件

工具使用 `tools/doc_config.yaml` 进行配置，可以自定义：

- 必需章节列表
- 质量检查标准
- 文件匹配模式
- 格式化规则
- 验证规则

### 自定义配置示例

```yaml
document_structure:
  required_sections:
    - "摘要"
    - "目录"
    - "理论基础"
    - "技术实现"
    - "实践应用"
    - "最佳实践"
    - "总结"

quality_checks:
  min_sections: 5
  min_code_examples: 2
  require_toc: true
  require_abstract: true
```

## 高级功能

### 1. 自动格式修复

- 修复标题格式
- 统一列表格式
- 确保代码块有语言标识
- 修复段落间距

### 2. 质量检查

- 检查必需章节
- 验证目录完整性
- 统计代码示例数量
- 检查文档字数

### 3. 批量处理

- 批量更新目录
- 批量修复格式
- 批量验证质量
- 生成综合报告

## 使用场景

### 场景1：新文档创建

```python
# 创建标准化文档模板
python tools/document_automation.py --root . --template "新分析文档.md" "2025年新技术分析"
```

### 场景2：现有文档维护

```python
# 批量更新所有文档
python tools/simple_toc_updater.py .
```

### 场景3：质量检查

```python
# 生成质量报告
python tools/document_automation.py --root . --report
```

### 场景4：格式统一

```python
# 修复格式问题
python tools/document_automation.py --root . --fix "文档.md"
```

## 故障排除

### 常见问题

#### 1. Python未安装

**问题**：提示"Python未找到"
**解决**：安装Python 3.6或更高版本

#### 2. 依赖包缺失

**问题**：提示"模块未找到"
**解决**：使用简化版工具 `simple_toc_updater.py`

#### 3. 文件权限问题

**问题**：无法写入文件
**解决**：检查文件权限，确保有写入权限

#### 4. 编码问题

**问题**：中文显示乱码
**解决**：确保文件使用UTF-8编码

### 调试模式

```python
# 添加调试信息
python tools/simple_toc_updater.py . 2>&1 | tee debug.log
```

## 最佳实践

### 1. 定期维护

- 每周运行一次批量处理
- 新文档创建后立即更新目录
- 定期检查质量报告

### 2. 版本控制

- 使用Git管理文档版本
- 重要修改前创建备份
- 记录重要变更

### 3. 团队协作

- 统一使用自动化工具
- 制定文档标准
- 定期培训团队成员

## 扩展功能

### 1. 自定义模板

可以创建自定义的文档模板，满足特定需求。

### 2. 集成CI/CD

可以将工具集成到持续集成流程中，自动检查文档质量。

### 3. 多语言支持

工具支持多语言文档的处理。

## 总结

通过这套自动化工具，您可以：

1. **彻底解决目录手工修改问题**
2. **提高文档维护效率**
3. **保证文档质量和一致性**
4. **减少人工错误**
5. **支持批量处理**

现在您只需要运行一个命令，就能自动更新所有文档的目录，无需再手工一行行修改！

---

**工具版本**：v1.0  
**更新日期**：2025年1月  
**支持系统**：Windows, Linux, macOS  
**Python版本**：3.6+
