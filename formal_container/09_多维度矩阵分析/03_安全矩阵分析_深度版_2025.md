# è™šæ‹ŸåŒ–ä¸å®¹å™¨åŒ–å®‰å…¨çŸ©é˜µæ·±åº¦åˆ†æï¼ˆ2025ç‰ˆï¼‰

> **æ–‡æ¡£å®šä½**: å®‰å…¨å¨èƒæ¨¡å‹ã€æ”»å‡»é¢åˆ†æã€é›¶ä¿¡ä»»æ¶æ„ä¸2025åˆè§„æ ‡å‡†  
> **å¯¹æ ‡æ°´å¹³**: NIST/CISæ ‡å‡† + CVEæ•°æ®åº“ + OWASP + é›¶ä¿¡ä»»æ¶æ„  
> **æ›´æ–°æ—¥æœŸ**: 2025å¹´10æœˆ20æ—¥

---

## ğŸ“‹ ç›®å½•

- [ç¬¬ä¸€éƒ¨åˆ†ï¼šå®‰å…¨å¨èƒæ¨¡å‹ä¸æ”»å‡»é¢](#ç¬¬ä¸€éƒ¨åˆ†å®‰å…¨å¨èƒæ¨¡å‹ä¸æ”»å‡»é¢)
- [ç¬¬äºŒéƒ¨åˆ†ï¼šéš”ç¦»æœºåˆ¶å®‰å…¨åˆ†æ](#ç¬¬äºŒéƒ¨åˆ†éš”ç¦»æœºåˆ¶å®‰å…¨åˆ†æ)
- [ç¬¬ä¸‰éƒ¨åˆ†ï¼šè®¿é—®æ§åˆ¶ä¸èº«ä»½ç®¡ç†](#ç¬¬ä¸‰éƒ¨åˆ†è®¿é—®æ§åˆ¶ä¸èº«ä»½ç®¡ç†)
- [ç¬¬å››éƒ¨åˆ†ï¼šæ•°æ®å®‰å…¨ä¸åŠ å¯†](#ç¬¬å››éƒ¨åˆ†æ•°æ®å®‰å…¨ä¸åŠ å¯†)
- [ç¬¬äº”éƒ¨åˆ†ï¼šå®‰å…¨åˆè§„ä¸æ ‡å‡†](#ç¬¬äº”éƒ¨åˆ†å®‰å…¨åˆè§„ä¸æ ‡å‡†)
- [ç¬¬å…­éƒ¨åˆ†ï¼šé›¶ä¿¡ä»»æ¶æ„](#ç¬¬å…­éƒ¨åˆ†é›¶ä¿¡ä»»æ¶æ„)
- [ç¬¬ä¸ƒéƒ¨åˆ†ï¼šæœºå¯†è®¡ç®—ä¸TEE](#ç¬¬ä¸ƒéƒ¨åˆ†æœºå¯†è®¡ç®—ä¸tee)
- [ç¬¬å…«éƒ¨åˆ†ï¼š2025å¹´å®‰å…¨å·¥å…·ç”Ÿæ€](#ç¬¬å…«éƒ¨åˆ†2025å¹´å®‰å…¨å·¥å…·ç”Ÿæ€)

---

## ç¬¬ä¸€éƒ¨åˆ†ï¼šå®‰å…¨å¨èƒæ¨¡å‹ä¸æ”»å‡»é¢

### 1.1 STRIDEå¨èƒæ¨¡å‹

**STRIDEåˆ†ç±»**ï¼ˆå¾®è½¯å®‰å…¨æ¡†æ¶ï¼‰:

| å¨èƒç±»å‹ | è‹±æ–‡ | è™šæ‹ŸåŒ– | å®¹å™¨åŒ– | microVM | é£é™©ç­‰çº§ |
|---------|------|--------|--------|---------|---------|
| **Spoofing** | èº«ä»½æ¬ºéª— | ä¸­ | é«˜ | ä¸­ | â­â­â­ |
| **Tampering** | ç¯¡æ”¹ | ä½ | ä¸­ | ä½ | â­â­â­â­ |
| **Repudiation** | æŠµèµ– | ä¸­ | ä¸­ | ä¸­ | â­â­ |
| **Information Disclosure** | ä¿¡æ¯æ³„éœ² | ä¸­ | é«˜ | ä¸­ | â­â­â­â­â­ |
| **Denial of Service** | æ‹’ç»æœåŠ¡ | ä¸­ | é«˜ | ä¸­ | â­â­â­â­ |
| **Elevation of Privilege** | æƒé™æå‡ | ä½ | é«˜ | ä½ | â­â­â­â­â­ |

### 1.2 æ”»å‡»é¢é‡åŒ–åˆ†æ

#### 1.2.1 æ”»å‡»é¢çŸ©é˜µ

```mermaid
mindmap
  root((æ”»å‡»é¢))
    ç¡¬ä»¶å±‚
      CPUä¾§ä¿¡é“
        Spectre
        Meltdown
        L1TF
      å†…å­˜æ”»å‡»
        Rowhammer
        RAMBleed
      å›ºä»¶æ¼æ´
        BIOS/UEFI
        BMC
    è™šæ‹ŸåŒ–å±‚
      Hypervisoræ¼æ´
        VMé€ƒé€¸
        VMé—´å¹²æ‰°
      è®¾å¤‡æ¨¡æ‹Ÿ
        QEMUæ¼æ´
        virtioæ¼æ´
    OSå†…æ ¸å±‚
      å†…æ ¸æ¼æ´
        æƒé™æå‡
        å®¹å™¨é€ƒé€¸
      ç³»ç»Ÿè°ƒç”¨
        Syscallè¿‡æ»¤ç»•è¿‡
        Seccompæ¼æ´
    å®¹å™¨è¿è¡Œæ—¶
      Dockeræ¼æ´
        CVEæ•°æ®åº“
        é…ç½®é”™è¯¯
      é•œåƒå®‰å…¨
        æ¶æ„é•œåƒ
        ä¾›åº”é“¾æ”»å‡»
    åº”ç”¨å±‚
      åº”ç”¨æ¼æ´
        OWASP Top 10
        ä¾èµ–åº“æ¼æ´
      é…ç½®é”™è¯¯
        æš´éœ²æ•æ„Ÿä¿¡æ¯
        å¼±å¯†ç 
```

#### 1.2.2 TCB (Trusted Computing Base) å¤§å°å¯¹æ¯”

| æŠ€æœ¯ | TCBå¤§å° | å…³é”®ç»„ä»¶ | CVEæ•°é‡/å¹´ | æ”»å‡»é¢è¯„åˆ† |
|------|---------|---------|-----------|-----------|
| **å®Œå…¨è™šæ‹ŸåŒ–** |||||
| VMware ESXi | ~20M LOC | VMKernel + VMDK | 20-40 | â­â­â­ |
| KVM/QEMU | ~15M LOC | KVM + QEMU + Host OS | 40-60 | â­â­â­â­ |
| Hyper-V | ~18M LOC | Hyper-V + Windows | 30-50 | â­â­â­ |
| **å®¹å™¨åŒ–** |||||
| Docker | ~100K LOC | containerd + runc + Kernel | 50-100 | â­â­â­â­ |
| containerd | ~50K LOC | containerd + runc + Kernel | 10-25 | â­â­â­ |
| **å®‰å…¨å®¹å™¨** |||||
| gVisor | ~50K LOC | Sentry (ç”¨æˆ·æ€å†…æ ¸) | 10-25 | â­â­ |
| Kata Containers | ~50K LOC | miniOS + KVM | 5-15 | â­â­ |
| Firecracker | ~30K LOC | microVM + KVM | 3-10 | â­ |
| **æ–°å…´æŠ€æœ¯** |||||
| WebAssembly | ~10K LOC | Wasm Runtime | <5 | â­ |

**æ”»å‡»é¢è¯„åˆ†**: â­ (æœ€å°) åˆ° â­â­â­â­â­ (æœ€å¤§)

### 1.3 é€ƒé€¸æ”»å‡»åˆ†æ

#### 1.3.1 VMé€ƒé€¸å†å²CVE

| CVEç¼–å· | å¹´ä»½ | å½±å“äº§å“ | ä¸¥é‡æ€§ | æ”»å‡»å‘é‡ | ç¼“è§£æªæ–½ |
|---------|------|---------|--------|---------|---------|
| CVE-2015-3456 | 2015 | QEMU | é«˜ | è½¯ç›˜æ§åˆ¶å™¨ | æ›´æ–°QEMU |
| CVE-2018-3639 | 2018 | Intel CPU | ä¸­ | Spectre v4 | å¾®ç æ›´æ–° |
| CVE-2019-14835 | 2019 | KVM | é«˜ | vhost-net | å†…æ ¸è¡¥ä¸ |
| CVE-2021-22555 | 2021 | Linux Kernel | é«˜ | Netfilter | å†…æ ¸æ›´æ–° |

#### 1.3.2 å®¹å™¨é€ƒé€¸å†å²CVE

| CVEç¼–å· | å¹´ä»½ | å½±å“äº§å“ | ä¸¥é‡æ€§ | æ”»å‡»å‘é‡ | ç¼“è§£æªæ–½ |
|---------|------|---------|--------|---------|---------|
| CVE-2019-5736 | 2019 | runc | é«˜ | /proc/self/exe | æ›´æ–°runc |
| CVE-2020-15257 | 2020 | containerd | ä¸­ | æŠ½è±¡socket | æ›´æ–°containerd |
| CVE-2021-30465 | 2021 | runc | é«˜ | symlink-exchange | æ›´æ–°runc |
| CVE-2022-0492 | 2022 | Linux Kernel | é«˜ | cgroups v1 | å†…æ ¸è¡¥ä¸ |
| CVE-2024-21626 | 2024 | runc | é«˜ | æ–‡ä»¶æè¿°ç¬¦æ³„éœ² | æ›´æ–°runc |

### 1.4 ä¾§ä¿¡é“æ”»å‡»

#### 1.4.1 CPUä¾§ä¿¡é“æ”»å‡»çŸ©é˜µ

| æ”»å‡»ç±»å‹ | å‘ç°å¹´ä»½ | å½±å“èŒƒå›´ | ç¼“è§£æ–¹æ¡ˆ | æ€§èƒ½å½±å“ | å‰©ä½™é£é™© |
|---------|---------|---------|---------|---------|---------|
| **Spectreç³»åˆ—** ||||||
| Spectre v1 | 2018 | æ‰€æœ‰CPU | è¾¹ç•Œæ£€æŸ¥ | <5% | ä½ |
| Spectre v2 | 2018 | æ‰€æœ‰CPU | Retpoline | 5-15% | ä½ |
| Spectre v4 | 2018 | Intel/AMD | SSBD | 2-8% | ä¸­ |
| **Meltdownç³»åˆ—** ||||||
| Meltdown | 2018 | Intel | KPTI | 5-30% | ä½ |
| L1TF | 2018 | Intel | L1D Flush | 2-5% | ä½ |
| MDS | 2019 | Intel | Bufferæ¸…é›¶ | 3-9% | ä¸­ |
| **2023-2025æ–°æ”»å‡»** ||||||
| Zenbleed | 2023 | AMD Zen2 | å¾®ç æ›´æ–° | <2% | ä½ |
| Downfall | 2023 | Intel | ç¦ç”¨GDS | 5-15% | ä¸­ |
| Inception | 2023 | AMD Zen3/4 | å¾®ç æ›´æ–° | <5% | ä½ |

#### 1.4.2 ä¾§ä¿¡é“æ”»å‡»é˜²æŠ¤æ¨¡å‹

```mermaid
graph TD
    subgraph Defense["å¤šå±‚é˜²å¾¡ç­–ç•¥"]
        A[ç¡¬ä»¶çº§] --> A1[CPUå¾®ç æ›´æ–°]
        A --> A2[ç¡¬ä»¶éš”ç¦»]
        A --> A3[TEE/SGX/SEV]
        
        B[å†…æ ¸çº§] --> B1[KPTI]
        B --> B2[Retpoline]
        B --> B3[L1D Flush]
        
        C[è™šæ‹ŸåŒ–å±‚] --> C1[è°ƒåº¦å™¨éš”ç¦»]
        C --> C2[Cacheåˆ†åŒº]
        C --> C3[ç¦ç”¨è¶…çº¿ç¨‹]
        
        D[åº”ç”¨å±‚] --> D1[å¸¸é‡æ—¶é—´ç®—æ³•]
        D --> D2[é¿å…åˆ†æ”¯é¢„æµ‹]
        D --> D3[å†…å­˜å±éšœ]
    end
    
    style Defense fill:#f9f,stroke:#333,stroke-width:2px
    style A fill:#f99,stroke:#333,stroke-width:2px
    style B fill:#9f9,stroke:#333,stroke-width:2px
    style C fill:#9cf,stroke:#333,stroke-width:2px
```

---

## ç¬¬äºŒéƒ¨åˆ†ï¼šéš”ç¦»æœºåˆ¶å®‰å…¨åˆ†æ

### 2.1 éš”ç¦»å¼ºåº¦é‡åŒ–æ¨¡å‹

**éš”ç¦»å¼ºåº¦è¯„åˆ†å…¬å¼**:

\[
S_{\text{isolation}} = w_1 S_{\text{CPU}} + w_2 S_{\text{memory}} + w_3 S_{\text{process}} + w_4 S_{\text{network}} + w_5 S_{\text{kernel}}
\]

å…¶ä¸­ \( \sum w_i = 1 \)ï¼Œæ¨èæƒé‡ï¼š

- \( w_1 = 0.2 \) (CPUéš”ç¦»)
- \( w_2 = 0.3 \) (å†…å­˜éš”ç¦»)
- \( w_3 = 0.2 \) (è¿›ç¨‹éš”ç¦»)
- \( w_4 = 0.1 \) (ç½‘ç»œéš”ç¦»)
- \( w_5 = 0.2 \) (å†…æ ¸éš”ç¦»)

### 2.2 éš”ç¦»æœºåˆ¶è¯¦ç»†å¯¹æ¯”

| éš”ç¦»ç»´åº¦ | å®Œå…¨è™šæ‹ŸåŒ– | å®¹å™¨ | microVM | gVisor | Wasm |
|---------|----------|------|---------|--------|------|
| **CPUéš”ç¦»** ||||||
| æœºåˆ¶ | VMCS | Cgroup | VMCS | Sentry | Runtime |
| å¼ºåº¦ | â­â­â­â­â­ | â­â­â­ | â­â­â­â­â­ | â­â­â­â­ | â­â­â­â­ |
| é€ƒé€¸éš¾åº¦ | æéš¾ | ä¸­ç­‰ | æéš¾ | éš¾ | æéš¾ |
| **å†…å­˜éš”ç¦»** ||||||
| æœºåˆ¶ | EPT/NPT | Cgroup | EPT/NPT | ç”¨æˆ·æ€é¡µè¡¨ | Linear Memory |
| å¼ºåº¦ | â­â­â­â­â­ | â­â­â­ | â­â­â­â­â­ | â­â­â­â­ | â­â­â­â­â­ |
| ä¾§ä¿¡é“é£é™© | ä¸­ | é«˜ | ä¸­ | ä¸­ | ä½ |
| **è¿›ç¨‹éš”ç¦»** ||||||
| æœºåˆ¶ | Guest OS | PID NS | Guest OS | Sentry | Runtime |
| å¼ºåº¦ | â­â­â­â­â­ | â­â­â­ | â­â­â­â­â­ | â­â­â­â­ | â­â­â­â­ |
| å¯è§æ€§ | å®Œå…¨éš”ç¦» | éƒ¨åˆ†éš”ç¦» | å®Œå…¨éš”ç¦» | å®Œå…¨éš”ç¦» | å®Œå…¨éš”ç¦» |
| **ç½‘ç»œéš”ç¦»** ||||||
| æœºåˆ¶ | vNIC | Net NS | vNIC | Netstack | WASI Socket |
| å¼ºåº¦ | â­â­â­â­ | â­â­â­â­ | â­â­â­â­ | â­â­â­â­ | â­â­â­â­ |
| DDoSé˜²æŠ¤ | å¥½ | ä¸­ | å¥½ | å¥½ | å¥½ |
| **æ–‡ä»¶ç³»ç»Ÿéš”ç¦»** ||||||
| æœºåˆ¶ | è™šæ‹Ÿç£ç›˜ | Mount NS | è™šæ‹Ÿç£ç›˜ | VFS | WASI FS |
| å¼ºåº¦ | â­â­â­â­â­ | â­â­â­ | â­â­â­â­â­ | â­â­â­â­ | â­â­â­â­ |
| æ•æ„Ÿè·¯å¾„ | éš”ç¦» | æš´éœ² | éš”ç¦» | è¿‡æ»¤ | éš”ç¦» |
| **å†…æ ¸éš”ç¦»** ||||||
| æœºåˆ¶ | Guestå†…æ ¸ | å…±äº«å†…æ ¸ | Guestå†…æ ¸ | ç”¨æˆ·æ€å†…æ ¸ | æ— å†…æ ¸ |
| å¼ºåº¦ | â­â­â­â­â­ | â­ | â­â­â­â­â­ | â­â­â­â­ | â­â­â­â­â­ |
| å†…æ ¸æš´éœ² | âŒ | âœ… | âŒ | âš ï¸ | âŒ |

### 2.3 Namespaceå®‰å…¨åˆ†æ

#### 2.3.1 Linux Namespaceéš”ç¦»èƒ½åŠ›

| Namespace | éš”ç¦»èµ„æº | å®‰å…¨å¼ºåº¦ | å·²çŸ¥æ¼æ´ | ç»•è¿‡éš¾åº¦ | 2025å»ºè®® |
|-----------|---------|---------|---------|---------|---------|
| **PID** | è¿›ç¨‹ID | â­â­â­ | ä¸­ç­‰ | ä¸­ | å¯ç”¨ |
| **Network** | ç½‘ç»œæ ˆ | â­â­â­â­ | å°‘ | éš¾ | å¿…é¡»å¯ç”¨ |
| **Mount** | æ–‡ä»¶ç³»ç»Ÿ | â­â­â­ | ä¸­ç­‰ | ä¸­ | å¿…é¡»å¯ç”¨ |
| **UTS** | ä¸»æœºå | â­â­ | å°‘ | æ˜“ | å¯é€‰ |
| **IPC** | è¿›ç¨‹é—´é€šä¿¡ | â­â­â­ | å°‘ | ä¸­ | å¯ç”¨ |
| **User** | ç”¨æˆ·ID | â­â­â­â­ | ä¸­ç­‰ | éš¾ | **å¼ºçƒˆæ¨è** |
| **Cgroup** | Cgroupæ ¹ | â­â­â­ | å¤š | ä¸­ | å¯ç”¨ |
| **Time** (5.6+) | æ—¶é—´ | â­â­ | æ–° | æœªçŸ¥ | è¯„ä¼°ä¸­ |

#### 2.3.2 User Namespaceå®‰å…¨æ¨¡å‹

**User Namespaceæ˜ å°„å…¬å¼**:

\[
UID_{\text{host}} = UID_{\text{container}} + UID_{\text{offset}}
\]

**å®‰å…¨ä¼˜åŠ¿**:

1. **Rootæƒé™éš”ç¦»**: å®¹å™¨å†…root = ä¸»æœºæ™®é€šç”¨æˆ·
2. **æƒé™çº¦æŸ**: é™åˆ¶Capabilitiesç”Ÿæ•ˆèŒƒå›´
3. **èµ„æºä¿æŠ¤**: é˜²æ­¢å®¹å™¨å½±å“ä¸»æœºèµ„æº

**é…ç½®ç¤ºä¾‹** (subuid/subgid):

```yaml
# /etc/subuid
container-user:100000:65536

# /etc/subgid
container-user:100000:65536
```

**æ˜ å°„å…³ç³»**:

- å®¹å™¨UID 0 â†’ ä¸»æœºUID 100000
- å®¹å™¨UID 1 â†’ ä¸»æœºUID 100001
- å®¹å™¨UID 65535 â†’ ä¸»æœºUID 165535

### 2.4 Seccomp-BPFè¿‡æ»¤

#### 2.4.1 Seccompæ¨¡å¼å¯¹æ¯”

| æ¨¡å¼ | å…è®¸syscall | ä¸¥æ ¼ç¨‹åº¦ | æ€§èƒ½å½±å“ | é€‚ç”¨åœºæ™¯ |
|------|-----------|---------|---------|---------|
| **Disabled** | æ‰€æœ‰ | âŒ æ— é™åˆ¶ | 0% | âš ï¸ ä¸æ¨è |
| **Strict** | 4ä¸ªåŸºæœ¬ | â­â­â­â­â­ | <1% | å—é™åº”ç”¨ |
| **Filter (BPF)** | è‡ªå®šä¹‰ | â­â­â­â­ | 1-3% | æ¨è |

**å…è®¸syscallæ•°é‡å¯¹æ¯”**:

- Linux æ€»syscall: ~450ä¸ªï¼ˆKernel 6.xï¼‰
- Dockeré»˜è®¤å…è®¸: ~300ä¸ª
- Kubernetesé»˜è®¤: ä¸é™åˆ¶ï¼ˆâš ï¸ï¼‰
- gVisorå…è®¸: ~70ä¸ª (â­â­â­â­â­)

#### 2.4.2 Seccompç­–ç•¥ç¤ºä¾‹

**ä¸¥æ ¼ç­–ç•¥**ï¼ˆæ¨èç”¨äºç”Ÿäº§ï¼‰:

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: secure-pod
spec:
  securityContext:
    seccompProfile:
      type: RuntimeDefault  # æˆ– Localhost
  containers:
  - name: app
    image: app:latest
    securityContext:
      allowPrivilegeEscalation: false
      capabilities:
        drop: ["ALL"]
        add: ["NET_BIND_SERVICE"]
      runAsNonRoot: true
      runAsUser: 10000
      seccompProfile:
        type: Localhost
        localhostProfile: profiles/strict.json
```

**è‡ªå®šä¹‰Seccompé…ç½®** (strict.json):

```json
{
  "defaultAction": "SCMP_ACT_ERRNO",
  "architectures": ["SCMP_ARCH_X86_64"],
  "syscalls": [
    {
      "names": [
        "read", "write", "open", "close", "stat", "fstat",
        "lseek", "mmap", "mprotect", "munmap", "brk",
        "rt_sigaction", "rt_sigprocmask", "rt_sigreturn",
        "ioctl", "pread64", "pwrite64", "readv", "writev",
        "access", "pipe", "select", "sched_yield", "mremap",
        "msync", "mincore", "madvise", "shmget", "shmat", "shmctl",
        "dup", "dup2", "pause", "nanosleep", "getitimer",
        "alarm", "setitimer", "getpid", "sendfile", "socket",
        "connect", "accept", "sendto", "recvfrom", "sendmsg", "recvmsg",
        "shutdown", "bind", "listen", "getsockname", "getpeername",
        "socketpair", "setsockopt", "getsockopt", "clone", "fork", "vfork",
        "execve", "exit", "wait4", "kill", "uname", "semget",
        "semop", "semctl", "shmdt", "msgget", "msgsnd", "msgrcv",
        "msgctl", "fcntl", "flock", "fsync", "fdatasync",
        "truncate", "ftruncate", "getdents", "getcwd", "chdir",
        "fchdir", "rename", "mkdir", "rmdir", "creat", "link",
        "unlink", "symlink", "readlink", "chmod", "fchmod",
        "chown", "fchown", "lchown", "umask", "gettimeofday",
        "getrlimit", "getrusage", "sysinfo", "times", "ptrace",
        "getuid", "syslog", "getgid", "setuid", "setgid",
        "geteuid", "getegid", "setpgid", "getppid", "getpgrp"
      ],
      "action": "SCMP_ACT_ALLOW"
    }
  ]
}
```

**é˜»æ­¢çš„å±é™©syscall**:

- `ptrace`: è°ƒè¯•/æ³¨å…¥
- `reboot`: é‡å¯ç³»ç»Ÿ
- `mount`: æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿ
- `swapon`/`swapoff`: äº¤æ¢ç®¡ç†
- `module_*`: å†…æ ¸æ¨¡å—åŠ è½½

---

## ç¬¬ä¸‰éƒ¨åˆ†ï¼šè®¿é—®æ§åˆ¶ä¸èº«ä»½ç®¡ç†

### 3.1 RBAC (Role-Based Access Control)

#### 3.1.1 RBACæ¨¡å‹ï¼ˆSandhu 1996ï¼‰

**æ•°å­¦å®šä¹‰**:

\[
\begin{align}
&\text{Users} \times \text{Roles} \times \text{Permissions} \\
&PA: \text{Permissions} \to \text{Roles} \\
&UA: \text{Users} \to \text{Roles} \\
&\text{check}(u, p) = \exists r: (u, r) \in UA \land (p, r) \in PA
\end{align}
\]

#### 3.1.2 Kubernetes RBACçŸ©é˜µ

| è§’è‰² | æƒé™èŒƒå›´ | é€‚ç”¨åœºæ™¯ | å®‰å…¨çº§åˆ« | å®¡è®¡è¦æ±‚ |
|------|---------|---------|---------|---------|
| **Cluster Admin** | æ‰€æœ‰èµ„æº | å¹³å°ç®¡ç†å‘˜ | â­ | é«˜ |
| **Namespace Admin** | å•Namespace | é¡¹ç›®ç®¡ç†å‘˜ | â­â­â­ | ä¸­ |
| **Developer** | è¯»å†™Pod/Service | å¼€å‘äººå‘˜ | â­â­â­â­ | ä¸­ |
| **Viewer** | åªè¯» | è¿ç»´æŸ¥çœ‹ | â­â­â­â­â­ | ä½ |
| **CI/CD Bot** | ç‰¹å®šèµ„æº | è‡ªåŠ¨åŒ– | â­â­â­ | é«˜ |

**æœ€å°æƒé™åŸåˆ™é…ç½®ç¤ºä¾‹**:

```yaml
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  namespace: production
  name: pod-reader
rules:
- apiGroups: [""]
  resources: ["pods", "pods/log"]
  verbs: ["get", "list", "watch"]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: read-pods
  namespace: production
subjects:
- kind: User
  name: dev-user
  apiGroup: rbac.authorization.k8s.io
roleRef:
  kind: Role
  name: pod-reader
  apiGroup: rbac.authorization.k8s.io
```

### 3.2 Linux Capabilities

#### 3.2.1 CapabilitiesçŸ©é˜µ

| Capability | æƒé™ | é£é™©ç­‰çº§ | é»˜è®¤Docker | æ¨è | æ›¿ä»£æ–¹æ¡ˆ |
|-----------|------|---------|-----------|------|---------|
| `CAP_CHOWN` | ä¿®æ”¹æ–‡ä»¶æ‰€æœ‰è€… | â­â­ | âœ… | âš ï¸ | User NS |
| `CAP_DAC_OVERRIDE` | ç»•è¿‡æ–‡ä»¶æƒé™ | â­â­â­â­ | âœ… | âŒ | æ­£ç¡®æƒé™ |
| `CAP_FOWNER` | ç»•è¿‡æ–‡ä»¶æ‰€æœ‰è€…æ£€æŸ¥ | â­â­â­ | âœ… | âš ï¸ | User NS |
| `CAP_NET_BIND_SERVICE` | ç»‘å®š<1024ç«¯å£ | â­â­ | âœ… | âœ… | é«˜ç«¯å£ |
| `CAP_NET_RAW` | åŸå§‹socket | â­â­â­ | âœ… | âŒ | åº”ç”¨å±‚ |
| `CAP_SYS_ADMIN` | ç³»ç»Ÿç®¡ç† | â­â­â­â­â­ | âŒ | âŒ | æ‹†åˆ†éœ€æ±‚ |
| `CAP_SYS_PTRACE` | è¿›ç¨‹è·Ÿè¸ª | â­â­â­â­ | âŒ | âŒ | è°ƒè¯•å®¹å™¨ |
| `CAP_SYS_MODULE` | åŠ è½½å†…æ ¸æ¨¡å— | â­â­â­â­â­ | âŒ | âŒ | ä¸»æœºæ“ä½œ |

**å±é™©Capabilities**ï¼ˆæ°¸è¿œä¸åº”æˆäºˆï¼‰:

- `CAP_SYS_ADMIN`: å‡ ä¹ç­‰åŒäºroot
- `CAP_SYS_MODULE`: å†…æ ¸æ¨¡å—åŠ è½½
- `CAP_SYS_PTRACE`: å¯è°ƒè¯•å…¶ä»–è¿›ç¨‹
- `CAP_DAC_READ_SEARCH`: ç»•è¿‡æ‰€æœ‰æ–‡ä»¶è¯»æƒé™

**æ¨èé…ç½®**ï¼ˆDrop ALL + Addéœ€è¦çš„ï¼‰:

```yaml
securityContext:
  capabilities:
    drop: ["ALL"]
    add: ["NET_BIND_SERVICE"]  # ä»…å½“éœ€è¦æ—¶
```

### 3.3 Pod Security Standards (PSS)

#### 3.3.1 PSSä¸‰çº§æ ‡å‡†

| å®‰å…¨çº§åˆ« | é™åˆ¶ | é€‚ç”¨åœºæ™¯ | å®‰å…¨æ€§ | å…¼å®¹æ€§ |
|---------|------|---------|--------|-------|
| **Privileged** | æ— é™åˆ¶ | ç³»ç»Ÿç»„ä»¶ | â­ | â­â­â­â­â­ |
| **Baseline** | åŸºæœ¬é™åˆ¶ | ä¸€èˆ¬åº”ç”¨ | â­â­â­ | â­â­â­â­ |
| **Restricted** | ä¸¥æ ¼é™åˆ¶ | å®‰å…¨åº”ç”¨ | â­â­â­â­â­ | â­â­ |

#### 3.3.2 Restrictedç­–ç•¥è¯¦ç»†è¦æ±‚

| ç­–ç•¥é¡¹ | è¦æ±‚ | è¯´æ˜ |
|-------|------|------|
| `runAsNonRoot` | `true` | ç¦æ­¢ä»¥rootè¿è¡Œ |
| `runAsUser` | `>= 10000` | ä½¿ç”¨é«˜UID |
| `allowPrivilegeEscalation` | `false` | ç¦æ­¢æƒé™æå‡ |
| `capabilities` | Drop ALL | ç§»é™¤æ‰€æœ‰Capabilities |
| `seccompProfile` | `RuntimeDefault` | å¯ç”¨Seccomp |
| `hostNetwork` | `false` | ç¦ç”¨Hostç½‘ç»œ |
| `hostPID` | `false` | ç¦ç”¨Host PID |
| `hostIPC` | `false` | ç¦ç”¨Host IPC |
| `privileged` | `false` | ç¦æ­¢ç‰¹æƒå®¹å™¨ |
| `volumes` | å—é™ç±»å‹ | ç¦ç”¨hostPath |

**PSSå®æ–½ç¤ºä¾‹**:

```yaml
apiVersion: v1
kind: Namespace
metadata:
  name: production
  labels:
    pod-security.kubernetes.io/enforce: restricted
    pod-security.kubernetes.io/audit: restricted
    pod-security.kubernetes.io/warn: restricted
```

---

## ç¬¬å››éƒ¨åˆ†ï¼šæ•°æ®å®‰å…¨ä¸åŠ å¯†

### 4.1 æ•°æ®åŠ å¯†çŸ©é˜µ

| æ•°æ®çŠ¶æ€ | è™šæ‹ŸåŒ–æ–¹æ¡ˆ | å®¹å™¨æ–¹æ¡ˆ | åŠ å¯†ç®—æ³• | æ€§èƒ½å½±å“ | å¯†é’¥ç®¡ç† |
|---------|----------|---------|---------|---------|---------|
| **é™æ€æ•°æ®** (Data at Rest) ||||||
| VMç£ç›˜ | VMDKåŠ å¯† | - | AES-256-XTS | 3-8% | vCenter KMS |
| å®¹å™¨å· | - | LUKS | AES-256-XTS | 5-10% | Kubernetes Secret |
| é•œåƒ | - | RegistryåŠ å¯† | AES-256-GCM | <2% | Harbor |
| **ä¼ è¾“æ•°æ®** (Data in Transit) ||||||
| VMè¿ç§» | vMotionåŠ å¯† | - | AES-256-GCM | 2-5% | è¯ä¹¦ |
| å®¹å™¨ç½‘ç»œ | - | mTLS | TLS 1.3 | 3-8% | cert-manager |
| APIé€šä¿¡ | HTTPS | HTTPS | TLS 1.3 | 2-5% | è¯ä¹¦ |
| **ä½¿ç”¨æ•°æ®** (Data in Use) ||||||
| å†…å­˜åŠ å¯† | AMD SEV | SEV-ES | AES-128 | 5-15% | ç¡¬ä»¶ |
| å¯ä¿¡æ‰§è¡Œ | Intel TDX | - | AES-128 | 3-10% | ç¡¬ä»¶ |
| å®‰å…¨é£åœ° | Intel SGX | - | AES-128 | 10-30% | ç¡¬ä»¶ |

### 4.2 æœºå¯†è®¡ç®—ï¼ˆConfidential Computingï¼‰

#### 4.2.1 TEE (Trusted Execution Environment) æŠ€æœ¯å¯¹æ¯”

| æŠ€æœ¯ | å‚å•† | éš”ç¦»ç²’åº¦ | å†…å­˜å¤§å° | æ€§èƒ½å½±å“ | æˆç†Ÿåº¦ | 2025å¯ç”¨æ€§ |
|------|------|---------|---------|---------|--------|-----------|
| **Intel SGX** | Intel | åº”ç”¨çº§ | ~256MB | 10-30% | æˆç†Ÿ | âœ… å·²éƒ¨ç½² |
| **Intel TDX** | Intel | VMçº§ | æ— é™åˆ¶ | 3-10% | æˆç†Ÿ | âœ… å·²éƒ¨ç½² |
| **AMD SEV** | AMD | VMçº§ | æ— é™åˆ¶ | 5-15% | æˆç†Ÿ | âœ… å·²éƒ¨ç½² |
| **AMD SEV-ES** | AMD | VMçº§+å¯„å­˜å™¨ | æ— é™åˆ¶ | 8-18% | æˆç†Ÿ | âœ… å·²éƒ¨ç½² |
| **AMD SEV-SNP** | AMD | VMçº§+å®Œæ•´æ€§ | æ— é™åˆ¶ | 5-15% | æˆç†Ÿ | âœ… å·²éƒ¨ç½² |
| **ARM TrustZone** | ARM | åº”ç”¨çº§ | <512MB | 5-20% | æˆç†Ÿ | âœ… å·²éƒ¨ç½² |
| **ARM CCA** | ARM | VMçº§ | æ— é™åˆ¶ | 5-12% | æ–° | âš ï¸ 2024-2025 |

#### 4.2.2 Confidential Containersæ¶æ„

```mermaid
graph TD
    subgraph CoCo["Confidential Containersæ¶æ„"]
        A[åº”ç”¨å®¹å™¨] --> B[Kata Containers]
        B --> C[Guest OS<br/>åŠ å¯†å†…å­˜]
        C --> D[AMD SEV-SNP<br/>æˆ– Intel TDX]
        D --> E[ç‰©ç†ç¡¬ä»¶]
        
        F[Attestation<br/>è¿œç¨‹è¯æ˜] -.->|éªŒè¯| C
        G[Key Broker<br/>å¯†é’¥ä»£ç†] -.->|å¯†é’¥æ³¨å…¥| C
    end
    
    style A fill:#9f9,stroke:#333,stroke-width:2px
    style D fill:#f99,stroke:#333,stroke-width:3px
    style F fill:#9cf,stroke:#333,stroke-width:2px
```

**Confidential Containersä¼˜åŠ¿**:

1. **å†…å­˜åŠ å¯†**: é˜²æ­¢ä¸»æœº/Hypervisorçª¥æ¢
2. **å®Œæ•´æ€§ä¿æŠ¤**: æ£€æµ‹å†…å­˜ç¯¡æ”¹
3. **è¿œç¨‹è¯æ˜**: éªŒè¯TEEçŠ¶æ€
4. **å¯†é’¥ä¿æŠ¤**: ä»…TEEå†…å¯è®¿é—®

### 4.3 å¯†é’¥ç®¡ç†æœ€ä½³å®è·µ

#### 4.3.1 å¯†é’¥ç®¡ç†ç³»ç»Ÿå¯¹æ¯”

| ç³»ç»Ÿ | ç±»å‹ | FIPS 140-2 | HSMæ”¯æŒ | å¤šç§Ÿæˆ· | K8sé›†æˆ | æ¨èåº¦ |
|------|------|-----------|---------|--------|---------|-------|
| **HashiCorp Vault** | å¼€æº/å•†ä¸š | âœ… (Enterprise) | âœ… | âœ… | â­â­â­â­â­ | â­â­â­â­â­ |
| **AWS KMS** | äº‘æœåŠ¡ | âœ… | âœ… | âœ… | â­â­â­â­ | â­â­â­â­ |
| **Azure Key Vault** | äº‘æœåŠ¡ | âœ… | âœ… | âœ… | â­â­â­â­ | â­â­â­â­ |
| **GCP KMS** | äº‘æœåŠ¡ | âœ… | âœ… | âœ… | â­â­â­â­ | â­â­â­â­ |
| **cert-manager** | å¼€æº | âŒ | âŒ | âš ï¸ | â­â­â­â­â­ | â­â­â­â­ |
| **Sealed Secrets** | å¼€æº | âŒ | âŒ | âš ï¸ | â­â­â­â­â­ | â­â­â­ |

#### 4.3.2 Secretç®¡ç†ç­–ç•¥

**åˆ†å±‚åŠ å¯†æ¨¡å‹**:

\[
\text{Encrypted Secret} = E_{K_{\text{master}}}(E_{K_{\text{namespace}}}(\text{Secret}))
\]

**æœ€ä½³å®è·µ**:

1. **ç¦æ­¢æ˜æ–‡å­˜å‚¨**: ä½¿ç”¨åŠ å¯†etcdæˆ–å¤–éƒ¨KMS
2. **è‡ªåŠ¨è½®æ¢**: 90å¤©è½®æ¢å‘¨æœŸ
3. **æœ€å°æƒé™**: RBACé™åˆ¶Secretè®¿é—®
4. **å®¡è®¡æ—¥å¿—**: è®°å½•æ‰€æœ‰Secretè®¿é—®
5. **ç”Ÿå‘½å‘¨æœŸç®¡ç†**: è‡ªåŠ¨è¿‡æœŸå’Œæ¸…ç†

---

## ç¬¬äº”éƒ¨åˆ†ï¼šå®‰å…¨åˆè§„ä¸æ ‡å‡†

### 5.1 2025å¹´å®‰å…¨åˆè§„çŸ©é˜µ

| æ ‡å‡†/æ³•è§„ | é€‚ç”¨è¡Œä¸š | è™šæ‹ŸåŒ–åˆè§„ | å®¹å™¨åˆè§„ | å…³é”®è¦æ±‚ | å®¡è®¡é¢‘ç‡ |
|---------|---------|-----------|---------|---------|---------|
| **ISO 27001** | æ‰€æœ‰ | âœ… æˆç†Ÿ | âœ… æˆç†Ÿ | ISMSä½“ç³» | å¹´åº¦ |
| **SOC 2 Type II** | äº‘æœåŠ¡ | âœ… æˆç†Ÿ | âœ… æˆç†Ÿ | 5å¤§ä¿¡ä»»åŸåˆ™ | å¹´åº¦ |
| **PCI-DSS v4.0** | æ”¯ä»˜ | âœ… è®¤è¯ | âš ï¸ éœ€è¯„ä¼° | ç½‘ç»œéš”ç¦» | å­£åº¦ |
| **HIPAA** | åŒ»ç–— | âœ… è®¤è¯ | âš ï¸ éœ€åŠ å›º | PHIä¿æŠ¤ | å¹´åº¦ |
| **GDPR** | æ¬§ç›Ÿ | âœ… åˆè§„ | âœ… åˆè§„ | æ•°æ®ä¿æŠ¤ | æŒç»­ |
| **FedRAMP** | ç¾å›½æ”¿åºœ | âœ… è®¤è¯ | âš ï¸ è¯„ä¼°ä¸­ | é«˜å®‰å…¨åŸºçº¿ | æŒç»­ |
| **NIST 800-190** | å®¹å™¨å®‰å…¨ | N/A | âœ… æ ‡å‡† | å®¹å™¨å®‰å…¨ | å»ºè®® |
| **CIS Benchmarks** | æ‰€æœ‰ | âœ… è®¤è¯ | âœ… è®¤è¯ | åŠ å›ºåŸºçº¿ | å»ºè®® |

### 5.2 CIS Benchmarksæ ¸å¿ƒè¦æ±‚

#### 5.2.1 CIS Docker Benchmark v1.6 (2024)

| ç±»åˆ« | å…³é”®æ§åˆ¶ | åŸºçº¿è¦æ±‚ | ä¼˜å…ˆçº§ |
|------|---------|---------|--------|
| **ä¸»æœºé…ç½®** | ç‹¬ç«‹åˆ†åŒº | `/var/lib/docker`ç‹¬ç«‹åˆ†åŒº | é«˜ |
| **Dockerå®ˆæŠ¤è¿›ç¨‹** | TLSè®¤è¯ | å¯ç”¨TLS 1.2+ | é«˜ |
| **å®ˆæŠ¤è¿›ç¨‹é…ç½®** | æ—¥å¿—çº§åˆ« | `info`æˆ–æ›´ä½ | ä¸­ |
| **å®¹å™¨é•œåƒ** | å¯ä¿¡é•œåƒ | ä»…ä½¿ç”¨ç­¾åé•œåƒ | é«˜ |
| **å®¹å™¨è¿è¡Œæ—¶** | AppArmor | å¯ç”¨AppArmoré…ç½® | é«˜ |
| **å®¹å™¨è¿è¡Œæ—¶** | Seccomp | å¯ç”¨Seccompé…ç½® | é«˜ |
| **å®¹å™¨è¿è¡Œæ—¶** | User NS | å¯ç”¨User Namespace | é«˜ |
| **Dockerå®‰å…¨** | Content Trust | `DOCKER_CONTENT_TRUST=1` | é«˜ |

#### 5.2.2 CIS Kubernetes Benchmark v1.8 (2024)

| ç±»åˆ« | å…³é”®æ§åˆ¶ | åŸºçº¿è¦æ±‚ | ä¼˜å…ˆçº§ |
|------|---------|---------|--------|
| **Control Plane** | API Server TLS | å¯ç”¨TLS 1.3 | é«˜ |
| **Control Plane** | åŒ¿åè®¿é—® | ç¦ç”¨`--anonymous-auth` | é«˜ |
| **Control Plane** | etcdåŠ å¯† | å¯ç”¨at-reståŠ å¯† | é«˜ |
| **Worker Nodes** | kubeletè®¤è¯ | å¯ç”¨webhookè®¤è¯ | é«˜ |
| **Worker Nodes** | åªè¯»ç«¯å£ | ç¦ç”¨`--read-only-port=0` | é«˜ |
| **Policies** | Pod Security | å®æ–½PSS Restricted | é«˜ |
| **Policies** | Network Policy | å®æ–½é»˜è®¤æ‹’ç» | é«˜ |
| **Policies** | RBAC | å¯ç”¨RBAC | é«˜ |

### 5.3 å®¡è®¡ä¸ç›‘æ§è¦æ±‚

#### 5.3.1 å®¡è®¡æ—¥å¿—çŸ©é˜µ

| äº‹ä»¶ç±»å‹ | è®°å½•å†…å®¹ | ä¿ç•™æœŸ | åˆ†æå·¥å…· | å‘Šè­¦é˜ˆå€¼ |
|---------|---------|--------|---------|---------|
| **è®¤è¯äº‹ä»¶** | ç™»å½•/ç™»å‡º/å¤±è´¥ | 90å¤©+ | SIEM | 5æ¬¡å¤±è´¥ |
| **æˆæƒäº‹ä»¶** | æƒé™æ£€æŸ¥/æ‹’ç» | 90å¤©+ | SIEM | å¼‚å¸¸è®¿é—® |
| **èµ„æºæ“ä½œ** | CRUDæ“ä½œ | 90å¤©+ | æ—¥å¿—ç³»ç»Ÿ | æ•æ„Ÿæ“ä½œ |
| **é…ç½®å˜æ›´** | é…ç½®ä¿®æ”¹ | 1å¹´+ | Git+å®¡è®¡ | æ‰€æœ‰å˜æ›´ |
| **å®‰å…¨äº‹ä»¶** | æ¼æ´/æ”»å‡» | 3å¹´+ | SIEM | ç«‹å³ |

#### 5.3.2 Kuberneteså®¡è®¡ç­–ç•¥

**å®¡è®¡çº§åˆ«**:

- `None`: ä¸è®°å½•
- `Metadata`: è®°å½•å…ƒæ•°æ®ï¼ˆè°ã€ä»€ä¹ˆã€ä½•æ—¶ï¼‰
- `Request`: + è¯·æ±‚ä½“
- `RequestResponse`: + å“åº”ä½“

**æ¨èé…ç½®**:

```yaml
apiVersion: audit.k8s.io/v1
kind: Policy
rules:
# è®°å½•Secretè®¿é—®
- level: RequestResponse
  resources:
  - group: ""
    resources: ["secrets"]
    
# è®°å½•RBACå˜æ›´
- level: RequestResponse
  resources:
  - group: "rbac.authorization.k8s.io"
    
# è®°å½•Podåˆ›å»º/åˆ é™¤
- level: Request
  verbs: ["create", "update", "patch", "delete"]
  resources:
  - group: ""
    resources: ["pods"]
    
# å…¶ä»–è¯»æ“ä½œä»…è®°å½•å…ƒæ•°æ®
- level: Metadata
  verbs: ["get", "list", "watch"]
```

---

## ç¬¬å…­éƒ¨åˆ†ï¼šé›¶ä¿¡ä»»æ¶æ„

### 6.1 é›¶ä¿¡ä»»åŸåˆ™

**NIST SP 800-207é›¶ä¿¡ä»»æ ¸å¿ƒåŸåˆ™**:

1. **æ°¸ä¸ä¿¡ä»»ï¼ŒæŒç»­éªŒè¯** (Never Trust, Always Verify)
2. **æœ€å°æƒé™è®¿é—®** (Least Privilege Access)
3. **å‡è®¾è¿è§„** (Assume Breach)
4. **æŒç»­ç›‘æ§** (Continuous Monitoring)
5. **åŠ¨æ€ç­–ç•¥** (Dynamic Policy)

### 6.2 é›¶ä¿¡ä»»åœ¨å®¹å™¨ç¯å¢ƒçš„å®æ–½

| ç»„ä»¶ | é›¶ä¿¡ä»»è¦æ±‚ | å®æ–½æ–¹æ¡ˆ | å·¥å…· | æˆç†Ÿåº¦ |
|------|----------|---------|------|-------|
| **èº«ä»½éªŒè¯** | mTLS everywhere | Service Mesh | Istio/Linkerd | â­â­â­â­â­ |
| **æˆæƒ** | å¾®åˆ†æ®µ | Network Policy | Calico/Cilium | â­â­â­â­â­ |
| **è®¿é—®æ§åˆ¶** | RBAC+ABAC | K8s RBAC | OPA | â­â­â­â­ |
| **åŠ å¯†** | E2EåŠ å¯† | mTLS | cert-manager | â­â­â­â­â­ |
| **å®¡è®¡** | å…¨é‡æ—¥å¿— | Audit Log | Falco/Fluent | â­â­â­â­ |
| **ç›‘æ§** | å®æ—¶æ£€æµ‹ | eBPF | Cilium/Tetragon | â­â­â­â­ |

### 6.3 Service Meshé›¶ä¿¡ä»»æ¶æ„

```mermaid
graph LR
    subgraph ZeroTrust["é›¶ä¿¡ä»»Service Meshæ¶æ„"]
        A[Service A] -->|mTLS| B[Envoy Proxy]
        B -->|è¯ä¹¦éªŒè¯| C[Service B]
        C -->|æˆæƒæ£€æŸ¥| D[Envoy Proxy]
        
        E[Cert Manager] -.->|é¢å‘è¯ä¹¦| B
        E -.->|é¢å‘è¯ä¹¦| D
        
        F[Istio Control<br/>Plane] -.->|ç­–ç•¥| B
        F -.->|ç­–ç•¥| D
        
        G[OPA] -.->|æˆæƒå†³ç­–| B
        G -.->|æˆæƒå†³ç­–| D
    end
    
    style A fill:#9f9,stroke:#333,stroke-width:2px
    style E fill:#f99,stroke:#333,stroke-width:2px
    style F fill:#9cf,stroke:#333,stroke-width:2px
```

---

## ç¬¬ä¸ƒéƒ¨åˆ†ï¼šæœºå¯†è®¡ç®—ä¸TEE

### 7.1 Confidential ComputingæŠ€æœ¯æ ˆ

| å±‚æ¬¡ | æŠ€æœ¯ | åŠŸèƒ½ | ä¿¡ä»»æ ¹ |
|------|------|------|--------|
| **ç¡¬ä»¶å±‚** | Intel TDX / AMD SEV-SNP | å†…å­˜åŠ å¯† | CPU |
| **VMå±‚** | Confidential VM | åŠ å¯†VM | TEE |
| **å®¹å™¨å±‚** | Confidential Containers | åŠ å¯†å®¹å™¨ | TEE |
| **åº”ç”¨å±‚** | Intel SGX | åº”ç”¨é£åœ° | TEE |

### 7.2 è¿œç¨‹è¯æ˜ï¼ˆRemote Attestationï¼‰

**è¯æ˜æµç¨‹**:

```mermaid
sequenceDiagram
    participant App as åº”ç”¨å®¹å™¨
    participant KBS as Key Broker
    participant AS as Attestation Service
    participant HW as Hardware TEE
    
    App->>HW: è¯·æ±‚è¯æ˜
    HW->>App: ç”ŸæˆQuote (ç­¾åæŠ¥å‘Š)
    App->>AS: æäº¤QuoteéªŒè¯
    AS->>AS: éªŒè¯Quoteç­¾å
    AS->>AS: æ£€æŸ¥Platform TCB
    AS->>App: è¿”å›è¯æ˜ä»¤ç‰Œ
    App->>KBS: ä½¿ç”¨ä»¤ç‰Œè¯·æ±‚å¯†é’¥
    KBS->>KBS: éªŒè¯ä»¤ç‰Œ
    KBS->>App: æ³¨å…¥å¯†é’¥åˆ°TEE
```

---

## ç¬¬å…«éƒ¨åˆ†ï¼š2025å¹´å®‰å…¨å·¥å…·ç”Ÿæ€

### 8.1 å®¹å™¨å®‰å…¨å·¥å…·çŸ©é˜µ

| å·¥å…·ç±»åˆ« | å·¥å…·åç§° | åŠŸèƒ½ | å¼€æº/å•†ä¸š | æˆç†Ÿåº¦ | æ¨èåº¦ |
|---------|---------|------|----------|--------|-------|
| **é•œåƒæ‰«æ** ||||||
| Trivy | æ¼æ´æ‰«æ | å¼€æº | â­â­â­â­â­ | â­â­â­â­â­ ||
| Grype | æ¼æ´æ‰«æ | å¼€æº | â­â­â­â­ | â­â­â­â­ ||
| Snyk | æ¼æ´+è®¸å¯è¯ | å•†ä¸š | â­â­â­â­â­ | â­â­â­â­ ||
| **è¿è¡Œæ—¶å®‰å…¨** ||||||
| Falco | å¨èƒæ£€æµ‹ | å¼€æº | â­â­â­â­â­ | â­â­â­â­â­ ||
| Tetragon | eBPFå®‰å…¨ | å¼€æº | â­â­â­â­ | â­â­â­â­ ||
| Sysdig | å…¨æ ˆç›‘æ§ | å•†ä¸š | â­â­â­â­â­ | â­â­â­â­ ||
| **ç­–ç•¥å¼•æ“** ||||||
| OPA | ç­–ç•¥ç®¡ç† | å¼€æº | â­â­â­â­â­ | â­â­â­â­â­ ||
| Kyverno | K8sç­–ç•¥ | å¼€æº | â­â­â­â­ | â­â­â­â­ ||
| **åˆè§„å®¡è®¡** ||||||
| kube-bench | CISåŸºå‡† | å¼€æº | â­â­â­â­â­ | â­â­â­â­â­ ||
| kube-hunter | æ¸—é€æµ‹è¯• | å¼€æº | â­â­â­â­ | â­â­â­â­ ||

### 8.2 å®‰å…¨é€‰å‹å†³ç­–æ ‘

```mermaid
graph TD
    Start{å®‰å…¨éœ€æ±‚} --> Q1{åˆè§„è¦æ±‚?}
    
    Q1 -->|é«˜| Q2{è¡Œä¸š?}
    Q1 -->|ä¸­| Q4{å¨èƒæ¨¡å‹?}
    Q1 -->|ä½| Q6{é¢„ç®—?}
    
    Q2 -->|é‡‘è/åŒ»ç–—| High[é«˜å®‰å…¨æ–¹æ¡ˆ]
    Q2 -->|ä¸€èˆ¬| Mid[æ ‡å‡†å®‰å…¨æ–¹æ¡ˆ]
    
    High --> H1[å®Œå…¨è™šæ‹ŸåŒ–<br/>+ æœºå¯†è®¡ç®—]
    High --> H2[CIS Restricted]
    High --> H3[å•†ä¸šå®‰å…¨å·¥å…·]
    
    Q4 -->|é«˜çº§æŒç»­å¨èƒ| APT[APTé˜²æŠ¤æ–¹æ¡ˆ]
    Q4 -->|ä¸€èˆ¬å¨èƒ| Basic[åŸºç¡€é˜²æŠ¤]
    
    APT --> A1[Zero Trust + eBPF]
    APT --> A2[Confidential Containers]
    APT --> A3[Falco + Tetragon]
    
    Basic --> B1[Standardå®¹å™¨]
    Basic --> B2[PSS Baseline]
    Basic --> B3[å¼€æºå·¥å…·]
    
    Q6 -->|å……è¶³| Commercial[å•†ä¸šæ–¹æ¡ˆ]
    Q6 -->|æœ‰é™| OpenSource[å¼€æºæ–¹æ¡ˆ]
    
    Commercial --> C1[Sysdig/Aqua]
    OpenSource --> O1[Falco+Trivy+OPA]
    
    style Start fill:#f9f,stroke:#333,stroke-width:4px
    style High fill:#f99,stroke:#333,stroke-width:2px
    style APT fill:#9cf,stroke:#333,stroke-width:2px
    style OpenSource fill:#9f9,stroke:#333,stroke-width:2px
```

---

## æ€»ç»“ä¸å»ºè®®

### å…³é”®å®‰å…¨åŸåˆ™

1. **æ·±åº¦é˜²å¾¡** (Defense in Depth)
   - å¤šå±‚å®‰å…¨æ§åˆ¶
   - æ²¡æœ‰å•ç‚¹æ•…éšœ

2. **æœ€å°æƒé™** (Least Privilege)
   - RBAC + Capabilities
   - Drop ALL + Add éœ€è¦çš„

3. **é›¶ä¿¡ä»»** (Zero Trust)
   - æ°¸ä¸ä¿¡ä»»ï¼ŒæŒç»­éªŒè¯
   - mTLS everywhere

4. **æŒç»­ç›‘æ§** (Continuous Monitoring)
   - å®æ—¶å¨èƒæ£€æµ‹
   - å®¡è®¡æ—¥å¿—

### 2025å¹´å®‰å…¨è¶‹åŠ¿

1. **æœºå¯†è®¡ç®—æ™®åŠåŒ–**
   - TEEæŠ€æœ¯æˆç†Ÿ
   - Confidential Containerså¹¿æ³›éƒ¨ç½²

2. **eBPFå®‰å…¨é©å‘½**
   - å†…æ ¸çº§å¯è§‚æµ‹æ€§
   - é›¶æ€§èƒ½å¼€é”€ç›‘æ§

3. **é›¶ä¿¡ä»»æ ‡å‡†åŒ–**
   - Service Meshæˆä¸ºæ ‡é…
   - mTLSå…¨é¢æ™®åŠ

4. **AIé©±åŠ¨å®‰å…¨**
   - å¼‚å¸¸æ£€æµ‹è‡ªåŠ¨åŒ–
   - å¨èƒæƒ…æŠ¥å¢å¼º

### å®‰å…¨æ£€æŸ¥æ¸…å•

**å®¹å™¨å®‰å…¨åŸºçº¿**:

- [ ] å¯ç”¨User Namespace
- [ ] é…ç½®Seccomp-BPF
- [ ] Drop ALL Capabilities
- [ ] ç¦ç”¨ç‰¹æƒå®¹å™¨
- [ ] å®æ–½PSS Restricted
- [ ] å¯ç”¨Network Policy
- [ ] é…ç½®RBAC
- [ ] å¯ç”¨é•œåƒæ‰«æ
- [ ] éƒ¨ç½²Runtime Security
- [ ] é…ç½®å®¡è®¡æ—¥å¿—

**Kuberneteså®‰å…¨åŸºçº¿**:

- [ ] API Server TLS 1.3
- [ ] etcdåŠ å¯†
- [ ] ç¦ç”¨åŒ¿åè®¿é—®
- [ ] å®æ–½RBAC
- [ ] Network Policyé»˜è®¤æ‹’ç»
- [ ] Pod Security Standards
- [ ] Admission Controllers
- [ ] å®¡è®¡æ—¥å¿—
- [ ] SecretåŠ å¯†
- [ ] å®šæœŸæ›´æ–°

---

## å‚è€ƒæ–‡çŒ®

1. **NIST SP 800-190** (2017). "Application Container Security Guide".
2. **NIST SP 800-207** (2020). "Zero Trust Architecture".
3. **CIS Docker Benchmark v1.6** (2024).
4. **CIS Kubernetes Benchmark v1.8** (2024).
5. **OWASP Kubernetes Top 10** (2023).
6. **CVE Details** (2025). "Container Security CVE Database".
7. **Confidential Computing Consortium** (2025). "Technical Specifications".
8. **CNCF** (2025). "Container Security Best Practices".

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2025å¹´10æœˆ20æ—¥  
**ä½œè€…**: Security & Compliance Team  
**License**: CC-BY-4.0

---

**ğŸ›¡ï¸ æœ¬æ–‡æ¡£æä¾›äº†è™šæ‹ŸåŒ–ä¸å®¹å™¨åŒ–ä»å¨èƒæ¨¡å‹åˆ°é›¶ä¿¡ä»»æ¶æ„çš„å®Œæ•´å®‰å…¨åˆ†ææ¡†æ¶ï¼**
