# 2025å®‰å…¨æ–°æ ‡å‡†

> **è¿”å›**: [æ–°å…´æŠ€æœ¯2025é¦–é¡µ](README.md) | [å®¹å™¨åŒ–éƒ¨ç½²é¦–é¡µ](../README.md)

---

## ğŸ“‹ ç›®å½•

- [2025å®‰å…¨æ–°æ ‡å‡†](#2025å®‰å…¨æ–°æ ‡å‡†)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [äº‘åŸç”Ÿå®‰å…¨æ¼”è¿›](#äº‘åŸç”Ÿå®‰å…¨æ¼”è¿›)
    - [2025å®‰å…¨è¶‹åŠ¿](#2025å®‰å…¨è¶‹åŠ¿)
      - [1. **ä¾›åº”é“¾å®‰å…¨æˆä¸ºé¦–è¦å…³æ³¨**](#1-ä¾›åº”é“¾å®‰å…¨æˆä¸ºé¦–è¦å…³æ³¨)
      - [2. **é›¶ä¿¡ä»»æ¶æ„ä¸»æµåŒ–**](#2-é›¶ä¿¡ä»»æ¶æ„ä¸»æµåŒ–)
      - [3. **eBPFé©±åŠ¨çš„è¿è¡Œæ—¶å®‰å…¨**](#3-ebpfé©±åŠ¨çš„è¿è¡Œæ—¶å®‰å…¨)
      - [4. **AIè¾…åŠ©å®‰å…¨åˆ†æ**](#4-aiè¾…åŠ©å®‰å…¨åˆ†æ)
    - [ä¾›åº”é“¾å®‰å…¨é‡è¦æ€§](#ä¾›åº”é“¾å®‰å…¨é‡è¦æ€§)
  - [Sigstoreæ— å¯†é’¥ç­¾å](#sigstoreæ— å¯†é’¥ç­¾å)
    - [Sigstoreæ¦‚è¿°](#sigstoreæ¦‚è¿°)
    - [Sigstoreæ¶æ„](#sigstoreæ¶æ„)
    - [Cosigné•œåƒç­¾å](#cosigné•œåƒç­¾å)
      - [å®‰è£…Cosign](#å®‰è£…cosign)
      - [ç­¾åå®¹å™¨é•œåƒ](#ç­¾åå®¹å™¨é•œåƒ)
      - [éªŒè¯é•œåƒç­¾å](#éªŒè¯é•œåƒç­¾å)
      - [Kubernetesé›†æˆ](#kubernetesé›†æˆ)
    - [Sigstore 2025æ–°ç‰¹æ€§](#sigstore-2025æ–°ç‰¹æ€§)
      - [1. **Trusted Root (ä¿¡ä»»æ ¹)**](#1-trusted-root-ä¿¡ä»»æ ¹)
      - [2. **ç§æœ‰Sigstoreå®ä¾‹**](#2-ç§æœ‰sigstoreå®ä¾‹)
      - [3. **Sigstore Java/Python/Goå®¢æˆ·ç«¯**](#3-sigstore-javapythongoå®¢æˆ·ç«¯)
  - [SBOMè½¯ä»¶ç‰©æ–™æ¸…å•](#sbomè½¯ä»¶ç‰©æ–™æ¸…å•)
    - [SBOMæ¦‚è¿°](#sbomæ¦‚è¿°)
    - [Syftç”ŸæˆSBOM](#syftç”Ÿæˆsbom)
    - [SBOMéªŒè¯ä¸å®¡è®¡](#sboméªŒè¯ä¸å®¡è®¡)
  - [SLSAä¾›åº”é“¾ç­‰çº§](#slsaä¾›åº”é“¾ç­‰çº§)
    - [SLSAæ¦‚è¿°](#slsaæ¦‚è¿°)
    - [SLSAç­‰çº§è¦æ±‚](#slsaç­‰çº§è¦æ±‚)
    - [å®ç°SLSA 3çº§](#å®ç°slsa-3çº§)
  - [GUACè½¯ä»¶ä¾›åº”é“¾å›¾è°±](#guacè½¯ä»¶ä¾›åº”é“¾å›¾è°±)
    - [GUACæ¦‚è¿°](#guacæ¦‚è¿°)
    - [GUACæ¶æ„](#guacæ¶æ„)
    - [GUACéƒ¨ç½²](#guacéƒ¨ç½²)
    - [GUACæŸ¥è¯¢ç¤ºä¾‹](#guacæŸ¥è¯¢ç¤ºä¾‹)
  - [VEXæ¼æ´å¯åˆ©ç”¨æ€§äº¤æ¢](#vexæ¼æ´å¯åˆ©ç”¨æ€§äº¤æ¢)
    - [VEXæ¦‚è¿°](#vexæ¦‚è¿°)
    - [VEXæ–‡æ¡£æ ¼å¼](#vexæ–‡æ¡£æ ¼å¼)
    - [VEXå®è·µ](#vexå®è·µ)
  - [Trivyå®‰å…¨æ‰«æå¢å¼º](#trivyå®‰å…¨æ‰«æå¢å¼º)
    - [Trivyæ¦‚è¿°](#trivyæ¦‚è¿°)
    - [Trivy 2025æ–°ç‰¹æ€§](#trivy-2025æ–°ç‰¹æ€§)
      - [1. **VEXæ”¯æŒ**](#1-vexæ”¯æŒ)
      - [2. **SBOMæ‰«æ**](#2-sbomæ‰«æ)
      - [3. **Kubernetes Operator**](#3-kubernetes-operator)
      - [4. **ä¾›åº”é“¾å®‰å…¨**](#4-ä¾›åº”é“¾å®‰å…¨)
    - [Trivyå…¨é¢æ‰«æ](#trivyå…¨é¢æ‰«æ)
    - [Trivy CI/CDé›†æˆ](#trivy-cicdé›†æˆ)
    - [Trivy Operator](#trivy-operator)
  - [Falcoè¿è¡Œæ—¶å®‰å…¨](#falcoè¿è¡Œæ—¶å®‰å…¨)
    - [Falcoæ¦‚è¿°](#falcoæ¦‚è¿°)
    - [Falco 2025æ–°ç‰¹æ€§](#falco-2025æ–°ç‰¹æ€§)
      - [1. **eBPFåŸç”Ÿ** (é»˜è®¤)](#1-ebpfåŸç”Ÿ-é»˜è®¤)
      - [2. **æ’ä»¶ç”Ÿæ€**](#2-æ’ä»¶ç”Ÿæ€)
    - [Falcoè§„åˆ™ç¤ºä¾‹](#falcoè§„åˆ™ç¤ºä¾‹)
  - [Tetragon eBPFå®‰å…¨](#tetragon-ebpfå®‰å…¨)
    - [Tetragonæ¦‚è¿°](#tetragonæ¦‚è¿°)
    - [Tetragonç­–ç•¥ç¤ºä¾‹](#tetragonç­–ç•¥ç¤ºä¾‹)
  - [OPA/Kyvernoç­–ç•¥å¼•æ“](#opakyvernoç­–ç•¥å¼•æ“)
    - [Kyverno 2025æ–°ç‰¹æ€§](#kyverno-2025æ–°ç‰¹æ€§)
      - [1. **Validate Admission Rules** (1.11+)](#1-validate-admission-rules-111)
    - [Kyvernoç­–ç•¥ç¤ºä¾‹](#kyvernoç­–ç•¥ç¤ºä¾‹)
  - [é›¶ä¿¡ä»»å®‰å…¨æ¶æ„](#é›¶ä¿¡ä»»å®‰å…¨æ¶æ„)
    - [SPIFFE/SPIREèº«ä»½è®¤è¯](#spiffespireèº«ä»½è®¤è¯)
    - [mTLSè‡ªåŠ¨åŒ–](#mtlsè‡ªåŠ¨åŒ–)
  - [å®‰å…¨æœ€ä½³å®è·µ](#å®‰å…¨æœ€ä½³å®è·µ)
    - [é•œåƒå®‰å…¨](#é•œåƒå®‰å…¨)
      - [1. **ä½¿ç”¨æœ€å°åŒ–åŸºç¡€é•œåƒ**](#1-ä½¿ç”¨æœ€å°åŒ–åŸºç¡€é•œåƒ)
      - [2. **å¤šé˜¶æ®µæ„å»º + érootç”¨æˆ·**](#2-å¤šé˜¶æ®µæ„å»º--érootç”¨æˆ·)
      - [3. **ç­¾åå’ŒéªŒè¯**](#3-ç­¾åå’ŒéªŒè¯)
    - [è¿è¡Œæ—¶å®‰å…¨](#è¿è¡Œæ—¶å®‰å…¨)
      - [1. **Pod Security Standards**](#1-pod-security-standards)
      - [2. **AppArmor/SELinux**](#2-apparmorselinux)
    - [ç½‘ç»œå®‰å…¨](#ç½‘ç»œå®‰å…¨)
      - [1. **NetworkPolicy**](#1-networkpolicy)
    - [æ•°æ®å®‰å…¨](#æ•°æ®å®‰å…¨)
      - [1. **å¯†é’¥åŠ å¯† (KMS)**](#1-å¯†é’¥åŠ å¯†-kms)
      - [2. **External Secrets Operator**](#2-external-secrets-operator)
  - [å®‰å…¨åˆè§„æ¡†æ¶](#å®‰å…¨åˆè§„æ¡†æ¶)
    - [CIS Benchmarks](#cis-benchmarks)
    - [PCI DSS](#pci-dss)
    - [SOC 2](#soc-2)
  - [å®‰å…¨ç”Ÿäº§æ¡ˆä¾‹](#å®‰å…¨ç”Ÿäº§æ¡ˆä¾‹)
    - [æ¡ˆä¾‹1ï¼šä¾›åº”é“¾æ”»å‡»é˜²å¾¡](#æ¡ˆä¾‹1ä¾›åº”é“¾æ”»å‡»é˜²å¾¡)
    - [æ¡ˆä¾‹2ï¼šé›¶ä¿¡ä»»å®‰å…¨æ¶æ„](#æ¡ˆä¾‹2é›¶ä¿¡ä»»å®‰å…¨æ¶æ„)
  - [å®‰å…¨æœªæ¥è¶‹åŠ¿](#å®‰å…¨æœªæ¥è¶‹åŠ¿)
    - [1. **ä¾›åº”é“¾å®‰å…¨æ ‡å‡†åŒ–**](#1-ä¾›åº”é“¾å®‰å…¨æ ‡å‡†åŒ–)
    - [2. **eBPFé©±åŠ¨å®‰å…¨**](#2-ebpfé©±åŠ¨å®‰å…¨)
    - [3. **AIè¾…åŠ©å®‰å…¨**](#3-aiè¾…åŠ©å®‰å…¨)
    - [4. **é›¶ä¿¡ä»»ä¸»æµåŒ–**](#4-é›¶ä¿¡ä»»ä¸»æµåŒ–)
  - [ç›¸å…³èµ„æº](#ç›¸å…³èµ„æº)
    - [å®˜æ–¹æ–‡æ¡£](#å®˜æ–¹æ–‡æ¡£)
    - [GitHubä»“åº“](#githubä»“åº“)
    - [å­¦ä¹ èµ„æº](#å­¦ä¹ èµ„æº)

---

## äº‘åŸç”Ÿå®‰å…¨æ¼”è¿›

### 2025å®‰å…¨è¶‹åŠ¿

#### 1. **ä¾›åº”é“¾å®‰å…¨æˆä¸ºé¦–è¦å…³æ³¨**

```text
2023å¹´SolarWindsä¾›åº”é“¾æ”»å‡»å½±å“:
- 18,000+ç»„ç»‡å—å½±å“
- æŸå¤±: >$100M

2024å¹´Log4Shellæ¼æ´å½±å“:
- å…¨çƒæ•°ç™¾ä¸‡åº”ç”¨å—å½±å“
- CVSSè¯„åˆ†: 10.0 (æœ€é«˜)

2025å¹´åº”å¯¹:
- âœ… SBOM (è½¯ä»¶ç‰©æ–™æ¸…å•) å¼ºåˆ¶è¦æ±‚
- âœ… Sigstoreæ— å¯†é’¥ç­¾åæ ‡å‡†åŒ–
- âœ… SLSAä¾›åº”é“¾ç­‰çº§è®¤è¯
```

#### 2. **é›¶ä¿¡ä»»æ¶æ„ä¸»æµåŒ–**

- âœ… SPIFFE/SPIREæˆä¸ºèº«ä»½æ ‡å‡†
- âœ… mTLSè‡ªåŠ¨åŒ– (Istio Ambientã€Linkerd)
- âœ… å·¥ä½œè´Ÿè½½èº«ä»½ (Workload Identity)

#### 3. **eBPFé©±åŠ¨çš„è¿è¡Œæ—¶å®‰å…¨**

- âœ… Falco 0.37+ (eBPFåŸç”Ÿ)
- âœ… Tetragon (Ciliumå®‰å…¨ç»„ä»¶)
- âœ… å†…æ ¸çº§å¯è§‚æµ‹æ€§å’Œç­–ç•¥æ‰§è¡Œ

#### 4. **AIè¾…åŠ©å®‰å…¨åˆ†æ**

- âœ… æ™ºèƒ½æ¼æ´ä¼˜å…ˆçº§æ’åº
- âœ… å¼‚å¸¸è¡Œä¸ºæ£€æµ‹
- âœ… è‡ªåŠ¨åŒ–å®‰å…¨å“åº”

---

### ä¾›åº”é“¾å®‰å…¨é‡è¦æ€§

**ä¾›åº”é“¾æ”»å‡»è·¯å¾„**:

```text
æ”»å‡»è€…
  â†“
å¼€æºåº“æŠ•æ¯’ (æ¶æ„ä¾èµ–)
  â†“
å¼€å‘è€…æ„å»ºé•œåƒ (åŒ…å«æ¶æ„ä»£ç )
  â†“
CI/CDæµæ°´çº¿ (æœªéªŒè¯ç­¾å)
  â†“
ç”Ÿäº§ç¯å¢ƒéƒ¨ç½² (å—æ„ŸæŸ“)
  â†“
æ•°æ®æ³„éœ² / åé—¨æ¤å…¥
```

**2025é˜²å¾¡ä½“ç³»**:

```text
âœ… SBOM: é€æ˜çš„ä¾èµ–å…³ç³»
âœ… Sigstore: å¯éªŒè¯çš„ç­¾å
âœ… SLSA: å¯ä¿¡çš„æ„å»ºè¿‡ç¨‹
âœ… GUAC: å…¨å±€ä¾›åº”é“¾å›¾è°±
âœ… VEX: å‡†ç¡®çš„æ¼æ´çŠ¶æ€
âœ… Trivy: å…¨é¢çš„å®‰å…¨æ‰«æ
```

---

## Sigstoreæ— å¯†é’¥ç­¾å

### Sigstoreæ¦‚è¿°

**Sigstore** æ˜¯ä¸€ä¸ª**å…è´¹ã€å¼€æº**çš„è½¯ä»¶ç­¾åæœåŠ¡ï¼Œæä¾›**æ— å¯†é’¥ç­¾å** (Keyless Signing)ã€‚

**å®˜ç½‘**: https://www.sigstore.dev/  
**GitHub**: https://github.com/sigstore/sigstore  
**CNCFçŠ¶æ€**: Incubating (2021) â†’ Graduated (2023)

**æ ¸å¿ƒç‰¹ç‚¹**:

- ğŸ”‘ **æ— å¯†é’¥ç­¾å**: åŸºäºOIDCèº«ä»½ï¼Œæ— éœ€ç®¡ç†é•¿æœŸå¯†é’¥
- ğŸŒ **å…¬å…±é€æ˜æ—¥å¿—**: Rekoré€æ˜æ—¥å¿—ï¼Œä¸å¯ç¯¡æ”¹
- ğŸ“œ **è¯ä¹¦é¢å‘**: Fulcio CAï¼ŒçŸ­æœŸè¯ä¹¦
- ğŸ†“ **å…è´¹å…¬å…±æœåŠ¡**: ç”±Linux Foundationè¿è¥

---

### Sigstoreæ¶æ„

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Sigstore Architecture                   â”‚
â”‚                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  å¼€å‘è€…                                             â”‚   â”‚
â”‚  â”‚  1. OIDCç™»å½• (GitHub/Google/Microsoft)            â”‚   â”‚
â”‚  â”‚  2. è¯·æ±‚ç­¾å                                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                       â†“                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Fulcio (è¯ä¹¦é¢å‘æœºæ„)                             â”‚   â”‚
â”‚  â”‚  - éªŒè¯OIDCèº«ä»½                                    â”‚   â”‚
â”‚  â”‚  - é¢å‘çŸ­æœŸè¯ä¹¦ (10åˆ†é’Ÿ)                           â”‚   â”‚
â”‚  â”‚  - è¯ä¹¦ç»‘å®šOIDCèº«ä»½ä¿¡æ¯                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                       â†“                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Cosign (ç­¾åå·¥å…·)                                  â”‚   â”‚
â”‚  â”‚  - ä½¿ç”¨çŸ­æœŸè¯ä¹¦ç­¾åå®¹å™¨é•œåƒ                         â”‚   â”‚
â”‚  â”‚  - å°†ç­¾åä¸Šä¼ åˆ°OCI Registry                         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                       â†“                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  Rekor (é€æ˜æ—¥å¿—)                                   â”‚   â”‚
â”‚  â”‚  - è®°å½•æ‰€æœ‰ç­¾åæ“ä½œ                                 â”‚   â”‚
â”‚  â”‚  - ä¸å¯ç¯¡æ”¹çš„Merkleæ ‘                              â”‚   â”‚
â”‚  â”‚  - å…¬å¼€å¯å®¡è®¡                                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                       â†“                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  éªŒè¯è€… (Kubernetes / CI/CD)                        â”‚   â”‚
â”‚  â”‚  - éªŒè¯ç­¾åçœŸå®æ€§                                   â”‚   â”‚
â”‚  â”‚  - æ£€æŸ¥é€æ˜æ—¥å¿—                                     â”‚   â”‚
â”‚  â”‚  - éªŒè¯OIDCèº«ä»½                                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### Cosigné•œåƒç­¾å

#### å®‰è£…Cosign

```bash
#!/bin/bash
# install-cosign.sh - Cosignå®‰è£… (2025)

set -e

echo "=== å®‰è£…Cosign ==="

# æ–¹æ³•1: äºŒè¿›åˆ¶å®‰è£…
COSIGN_VERSION="v2.2.3"
wget https://github.com/sigstore/cosign/releases/download/${COSIGN_VERSION}/cosign-linux-amd64
chmod +x cosign-linux-amd64
sudo mv cosign-linux-amd64 /usr/local/bin/cosign

# æ–¹æ³•2: Goå®‰è£…
# go install github.com/sigstore/cosign/v2/cmd/cosign@latest

# éªŒè¯å®‰è£…
cosign version

echo "=== Cosignå®‰è£…å®Œæˆ ==="
```

#### ç­¾åå®¹å™¨é•œåƒ

```bash
#!/bin/bash
# sign-container-image.sh - æ— å¯†é’¥ç­¾åå®¹å™¨é•œåƒ

set -e

echo "=== Sigstoreæ— å¯†é’¥ç­¾åå®¹å™¨é•œåƒ ==="

IMAGE="docker.io/myorg/myapp:v1.0.0"

# 1. ä½¿ç”¨OIDCç™»å½• (GitHubèº«ä»½)
echo "1. ä½¿ç”¨OIDCç™»å½•..."
# Cosignä¼šæ‰“å¼€æµè§ˆå™¨è¿›è¡ŒGitHub OAuthç™»å½•

# 2. ç­¾åé•œåƒ (Keyless)
echo "2. ç­¾åé•œåƒ..."
cosign sign $IMAGE

# ç­¾åæµç¨‹:
# - Cosigné€šè¿‡æµè§ˆå™¨è¿›è¡ŒOIDCè®¤è¯ (GitHub/Google/Microsoft)
# - FulcioéªŒè¯èº«ä»½åé¢å‘çŸ­æœŸè¯ä¹¦ (10åˆ†é’Ÿ)
# - Cosignä½¿ç”¨è¯ä¹¦ç­¾åé•œåƒ
# - ç­¾åå’Œè¯ä¹¦ä¸Šä¼ åˆ°OCI Registry
# - ç­¾åè®°å½•å†™å…¥Rekoré€æ˜æ—¥å¿—

# 3. æŸ¥çœ‹ç­¾å
echo "3. æŸ¥çœ‹ç­¾å..."
cosign tree $IMAGE

echo ""
echo "=== ç­¾åå®Œæˆ ==="
```

**ç­¾åè¾“å‡ºç¤ºä¾‹**:

```text
Generating ephemeral keys...
Retrieving signed certificate...

        The sigstore service, hosted by sigstore a Series of LF Projects, LLC, is provided pursuant to the Hosted Project Tools Terms of Use, available at https://lfprojects.org/policies/hosted-project-tools-terms-of-use/.
        Note that if your submission includes personal data associated with this signed artifact, it will be part of an immutable record.
        This may include the email address associated with the account with which you authenticate your contractual Agreement.
        This information will be used for signing this artifact and will be stored in public transparency logs and cannot be removed later, and is subject to the Immutable Record notice at https://lfprojects.org/policies/hosted-project-tools-immutable-records/.

By typing 'y', you attest that (1) you are not submitting the personal data of any other person; and (2) you understand and agree to the statement and the Agreement terms at the URLs listed above.
Are you sure you would like to continue? [y/N] y

tlog entry created with index: 123456789
Pushing signature to: docker.io/myorg/myapp:sha256-abc123...
```

#### éªŒè¯é•œåƒç­¾å

```bash
#!/bin/bash
# verify-signature.sh - éªŒè¯é•œåƒç­¾å

set -e

IMAGE="docker.io/myorg/myapp:v1.0.0"

echo "=== éªŒè¯é•œåƒç­¾å ==="

# 1. éªŒè¯ç­¾å (åŸºäºOIDCèº«ä»½)
echo "1. éªŒè¯ç­¾å..."
cosign verify $IMAGE \
  --certificate-identity=user@example.com \
  --certificate-oidc-issuer=https://github.com/login/oauth

# 2. éªŒè¯ç­¾å (ä»»ä½•GitHubç”¨æˆ·)
echo "2. éªŒè¯GitHubç»„ç»‡ç­¾å..."
cosign verify $IMAGE \
  --certificate-identity-regexp='.*@myorg.com' \
  --certificate-oidc-issuer=https://github.com/login/oauth

# 3. æŸ¥çœ‹ç­¾åè¯¦æƒ…
echo "3. æŸ¥çœ‹ç­¾åè¯¦æƒ…..."
cosign verify $IMAGE \
  --certificate-identity-regexp='.*' \
  --certificate-oidc-issuer=https://github.com/login/oauth \
  -o json | jq

echo ""
echo "=== éªŒè¯å®Œæˆ ==="
```

**éªŒè¯è¾“å‡º**:

```json
{
  "critical": {
    "identity": {
      "docker-reference": "docker.io/myorg/myapp"
    },
    "image": {
      "docker-manifest-digest": "sha256:abc123..."
    },
    "type": "cosign container image signature"
  },
  "optional": {
    "Bundle": {
      "SignedEntryTimestamp": "MEUCIQD...",
      "Payload": {
        "body": "eyJhcGlWZXJzaW9...",
        "integratedTime": 1697760000,
        "logIndex": 123456789,
        "logID": "c0d23d6ad406973f9559f3ba2d1ca01f84147d8ffc5b8445c224f98b9591801d"
      }
    },
    "Issuer": "https://github.com/login/oauth",
    "Subject": "user@example.com"
  }
}
```

#### Kubernetesé›†æˆ

**Policy Controller (Sigstore)**:

```bash
#!/bin/bash
# install-policy-controller.sh - å®‰è£…Sigstore Policy Controller

set -e

echo "=== å®‰è£…Sigstore Policy Controller ==="

# 1. å®‰è£…Policy Controller
kubectl apply -f https://github.com/sigstore/policy-controller/releases/latest/download/policy-controller.yaml

# 2. ç­‰å¾…éƒ¨ç½²å®Œæˆ
kubectl rollout status deployment/policy-controller-webhook -n cosign-system

echo "=== Policy Controllerå®‰è£…å®Œæˆ ==="
```

**ClusterImagePolicy** (å¼ºåˆ¶ç­¾åéªŒè¯):

```yaml
# cluster-image-policy.yaml
apiVersion: policy.sigstore.dev/v1beta1
kind: ClusterImagePolicy
metadata:
  name: require-signed-images
spec:
  images:
  - glob: "docker.io/myorg/**"  # æ‰€æœ‰myorgé•œåƒå¿…é¡»ç­¾å
  authorities:
  - keyless:
      url: https://fulcio.sigstore.dev
      identities:
      - issuerRegExp: ".*"
        subjectRegExp: ".*@myorg\\.com"  # åªå…è®¸myorg.comç­¾åè€…
    ctlog:
      url: https://rekor.sigstore.dev
```

**æµ‹è¯•ç­–ç•¥**:

```bash
# å°è¯•éƒ¨ç½²æœªç­¾åé•œåƒ (åº”è¯¥å¤±è´¥)
kubectl run test --image=docker.io/myorg/unsigned:latest

# é”™è¯¯:
# Error: admission webhook "policy.sigstore.dev" denied the request: 
# validation failed: failed to verify signature for docker.io/myorg/unsigned:latest
```

---

### Sigstore 2025æ–°ç‰¹æ€§

#### 1. **Trusted Root (ä¿¡ä»»æ ¹)**

```bash
# ä½¿ç”¨Trusted RootéªŒè¯ (2025æ–°å¢)
cosign verify $IMAGE \
  --use-trusted-root \
  --trusted-root-url=https://tuf.sigstore.dev
```

#### 2. **ç§æœ‰Sigstoreå®ä¾‹**

```bash
# éƒ¨ç½²ç§æœ‰Fulcio + Rekor
helm install sigstore sigstore/sigstore-scaffolding \
  --namespace sigstore-system --create-namespace \
  --set fulcio.enabled=true \
  --set rekor.enabled=true \
  --set ctlog.enabled=true
```

#### 3. **Sigstore Java/Python/Goå®¢æˆ·ç«¯**

```python
# Pythonç¤ºä¾‹
from sigstore.verify import Verifier

verifier = Verifier()
result = verifier.verify(
    image="docker.io/myorg/myapp:v1.0.0",
    certificate_identity="user@example.com",
    certificate_oidc_issuer="https://github.com/login/oauth"
)
```

---

## SBOMè½¯ä»¶ç‰©æ–™æ¸…å•

### SBOMæ¦‚è¿°

**SBOM** (Software Bill of Materialsï¼Œè½¯ä»¶ç‰©æ–™æ¸…å•) æ˜¯è½¯ä»¶ä¸­æ‰€æœ‰ç»„ä»¶å’Œä¾èµ–çš„**å®Œæ•´æ¸…å•**ã€‚

**é‡è¦æ€§**:

- ğŸ” **ä¾›åº”é“¾å¯è§æ€§**: çŸ¥é“è½¯ä»¶ä¸­æœ‰ä»€ä¹ˆ
- ğŸ› **æ¼æ´ç®¡ç†**: å¿«é€Ÿå®šä½å—å½±å“ç»„ä»¶
- ğŸ“‹ **åˆè§„è¦æ±‚**: ç¾å›½æ”¿åºœå¼ºåˆ¶è¦æ±‚ (Executive Order 14028)

**SBOMæ ¼å¼**:

- **SPDX** (Software Package Data Exchange) - Linux Foundation
- **CycloneDX** - OWASP

---

### Syftç”ŸæˆSBOM

**Syft** æ˜¯ **Anchore** å¼€æºçš„SBOMç”Ÿæˆå·¥å…·ã€‚

```bash
#!/bin/bash
# generate-sbom.sh - ç”Ÿæˆå®¹å™¨é•œåƒSBOM

set -e

echo "=== ç”ŸæˆSBOM ==="

IMAGE="docker.io/myorg/myapp:v1.0.0"

# 1. å®‰è£…Syft
echo "1. å®‰è£…Syft..."
curl -sSfL https://raw.githubusercontent.com/anchore/syft/main/install.sh | sh -s -- -b /usr/local/bin

# 2. ç”ŸæˆSBOM (SPDXæ ¼å¼)
echo "2. ç”ŸæˆSBOM (SPDX)..."
syft $IMAGE -o spdx-json > sbom-spdx.json

# 3. ç”ŸæˆSBOM (CycloneDXæ ¼å¼)
echo "3. ç”ŸæˆSBOM (CycloneDX)..."
syft $IMAGE -o cyclonedx-json > sbom-cyclonedx.json

# 4. ç”ŸæˆSBOM (äººç±»å¯è¯»æ ¼å¼)
echo "4. ç”ŸæˆSBOM (è¡¨æ ¼)..."
syft $IMAGE -o table

# 5. å°†SBOMé™„åŠ åˆ°é•œåƒ (Cosign)
echo "5. å°†SBOMé™„åŠ åˆ°é•œåƒ..."
cosign attach sbom --sbom sbom-spdx.json $IMAGE

echo ""
echo "=== SBOMç”Ÿæˆå®Œæˆ ==="
```

**SBOMç¤ºä¾‹è¾“å‡º** (ç®€åŒ–):

```text
NAME                 VERSION      TYPE
nginx                1.25.3       apk
openssl              3.1.4        apk
zlib                 1.3          apk
pcre2                10.42        apk
alpine-baselayout    3.4.3        apk
...
```

**CycloneDX JSONç¤ºä¾‹**:

```json
{
  "bomFormat": "CycloneDX",
  "specVersion": "1.5",
  "version": 1,
  "metadata": {
    "timestamp": "2025-10-20T10:00:00Z",
    "component": {
      "type": "container",
      "name": "myapp",
      "version": "v1.0.0"
    }
  },
  "components": [
    {
      "type": "library",
      "name": "nginx",
      "version": "1.25.3",
      "purl": "pkg:apk/alpine/nginx@1.25.3",
      "licenses": [{"license": {"id": "BSD-2-Clause"}}]
    }
  ]
}
```

---

### SBOMéªŒè¯ä¸å®¡è®¡

```bash
# éªŒè¯SBOMçœŸå®æ€§ (Cosign)
cosign verify-attestation $IMAGE \
  --type cyclonedx \
  --certificate-identity-regexp='.*@myorg.com' \
  --certificate-oidc-issuer=https://github.com/login/oauth

# ä¸‹è½½é™„åŠ çš„SBOM
cosign download sbom $IMAGE > sbom.json

# åˆ†æSBOMä¸­çš„æ¼æ´ (Grype)
grype sbom:./sbom.json
```

---

## SLSAä¾›åº”é“¾ç­‰çº§

### SLSAæ¦‚è¿°

**SLSA** (Supply chain Levels for Software Artifactsï¼Œè½¯ä»¶ä¾›åº”é“¾çº§åˆ«) æ˜¯ä¸€ä¸ª**å®‰å…¨æ¡†æ¶**ï¼Œå®šä¹‰äº†è½¯ä»¶ä¾›åº”é“¾çš„**æˆç†Ÿåº¦ç­‰çº§**ã€‚

**å®˜ç½‘**: https://slsa.dev/  
**å‘èµ·æ–¹**: Googleã€Linux Foundation

**æ ¸å¿ƒç›®æ ‡**:

- ğŸ”’ **é˜²æ­¢ç¯¡æ”¹**: ç¡®ä¿è½¯ä»¶åœ¨æ„å»ºå’Œå‘å¸ƒè¿‡ç¨‹ä¸­æœªè¢«ç¯¡æ”¹
- ğŸ“œ **å¯å®¡è®¡**: æä¾›å®Œæ•´çš„æ„å»ºè¯æ˜
- ğŸ¯ **æ ‡å‡†åŒ–**: ç»Ÿä¸€çš„å®‰å…¨æ ‡å‡†

---

### SLSAç­‰çº§è¦æ±‚

| ç­‰çº§ | è¦æ±‚ | è¯´æ˜ |
|------|------|------|
| **SLSA 0** | æ— è¦æ±‚ | åŸºçº¿ (ä¸å®‰å…¨) |
| **SLSA 1** | æ„å»ºè¯æ˜ | ç”Ÿæˆå¹¶ç­¾åæ„å»ºå…ƒæ•°æ® |
| **SLSA 2** | ç‰ˆæœ¬æ§åˆ¶ + æ‰˜ç®¡æ„å»º | ä»£ç æ‰˜ç®¡åœ¨Gitï¼Œä½¿ç”¨CI/CDæ„å»º |
| **SLSA 3** | å¼ºåŒ–æ„å»ºå¹³å° | é˜²ç¯¡æ”¹æ„å»ºç¯å¢ƒï¼Œå®¡è®¡æ—¥å¿— |
| **SLSA 4** | åŒæ–¹å®¡æŸ¥ | ä»£ç å’Œæ„å»ºåŒæ–¹å®¡æŸ¥ (æœ€é«˜çº§åˆ«) |

---

### å®ç°SLSA 3çº§

**GitHub Actions SLSA 3ç¤ºä¾‹**:

```yaml
# .github/workflows/slsa3-build.yaml
name: SLSA 3 Build

on:
  push:
    tags:
      - 'v*'

permissions:
  id-token: write  # OIDC token
  contents: read
  packages: write

jobs:
  build:
    runs-on: ubuntu-latest
    outputs:
      image-digest: ${{ steps.build.outputs.digest }}
    steps:
    - uses: actions/checkout@v4
    
    - name: Build image
      id: build
      run: |
        docker build -t ghcr.io/${{ github.repository }}:${{ github.ref_name }} .
        docker push ghcr.io/${{ github.repository }}:${{ github.ref_name }}
        echo "digest=$(docker inspect --format='{{.RepoDigests}}' ghcr.io/${{ github.repository }}:${{ github.ref_name }} | cut -d'@' -f2)" >> $GITHUB_OUTPUT

  provenance:
    needs: build
    permissions:
      id-token: write
      actions: read
      packages: write
    uses: slsa-framework/slsa-github-generator/.github/workflows/generator_container_slsa3.yml@v1.9.0
    with:
      image: ghcr.io/${{ github.repository }}
      digest: ${{ needs.build.outputs.image-digest }}
      registry-username: ${{ github.actor }}
    secrets:
      registry-password: ${{ secrets.GITHUB_TOKEN }}
```

**SLSA Provenance (æ¥æºè¯æ˜)**:

```json
{
  "_type": "https://in-toto.io/Statement/v0.1",
  "subject": [
    {
      "name": "ghcr.io/myorg/myapp",
      "digest": {
        "sha256": "abc123..."
      }
    }
  ],
  "predicateType": "https://slsa.dev/provenance/v0.2",
  "predicate": {
    "builder": {
      "id": "https://github.com/slsa-framework/slsa-github-generator/.github/workflows/generator_container_slsa3.yml@v1.9.0"
    },
    "buildType": "https://github.com/slsa-framework/slsa-github-generator/container@v1",
    "invocation": {
      "configSource": {
        "uri": "git+https://github.com/myorg/myapp@refs/tags/v1.0.0",
        "digest": {
          "sha1": "def456..."
        },
        "entryPoint": ".github/workflows/slsa3-build.yaml"
      }
    },
    "metadata": {
      "buildInvocationId": "123456789",
      "buildStartedOn": "2025-10-20T10:00:00Z",
      "buildFinishedOn": "2025-10-20T10:05:00Z",
      "completeness": {
        "parameters": true,
        "environment": false,
        "materials": true
      },
      "reproducible": false
    },
    "materials": [
      {
        "uri": "git+https://github.com/myorg/myapp@refs/tags/v1.0.0",
        "digest": {
          "sha1": "def456..."
        }
      }
    ]
  }
}
```

---

## GUACè½¯ä»¶ä¾›åº”é“¾å›¾è°±

### GUACæ¦‚è¿°

**GUAC** (Graph for Understanding Artifact Compositionï¼Œç†è§£æ„ä»¶ç»„æˆçš„å›¾è°±) æ˜¯ä¸€ä¸ª**ä¾›åº”é“¾å®‰å…¨å›¾è°±å·¥å…·**ã€‚

**å®˜ç½‘**: https://guac.sh/  
**GitHub**: https://github.com/guacsec/guac  
**å‘èµ·æ–¹**: Googleã€Kusariã€Citi

**æ ¸å¿ƒåŠŸèƒ½**:

- ğŸ“Š **æ„å»ºä¾›åº”é“¾å›¾è°±**: å°†SBOMã€SLSAã€æ¼æ´æ•°æ®å…³è”èµ·æ¥
- ğŸ” **æ·±åº¦æŸ¥è¯¢**: æ‰¾å‡ºå“ªäº›è½¯ä»¶å—æŸä¸ªæ¼æ´å½±å“
- ğŸ¯ **é£é™©è¯„ä¼°**: è¯„ä¼°ä¾›åº”é“¾é£é™©

---

### GUACæ¶æ„

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    GUAC Architecture                       â”‚
â”‚                                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  æ•°æ®æ‘„å– (Ingestors)                               â”‚   â”‚
â”‚  â”‚  - SBOM (Syftã€SPDX)                               â”‚   â”‚
â”‚  â”‚  - SLSA Provenance                                 â”‚   â”‚
â”‚  â”‚  - æ¼æ´æ•°æ® (OSVã€NVDã€Trivy)                      â”‚   â”‚
â”‚  â”‚  - ç­¾åæ•°æ® (Sigstore)                             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                       â†“                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  GUACå›¾æ•°æ®åº“                                       â”‚   â”‚
â”‚  â”‚  - Neo4j / Memgraph                                â”‚   â”‚
â”‚  â”‚  - èŠ‚ç‚¹: è½¯ä»¶åŒ…ã€æ¼æ´ã€æ„å»º                        â”‚   â”‚
â”‚  â”‚  - è¾¹: ä¾èµ–å…³ç³»ã€å½±å“å…³ç³»                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                       â†“                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  GUAC API / UI                                      â”‚   â”‚
â”‚  â”‚  - GraphQLæŸ¥è¯¢                                      â”‚   â”‚
â”‚  â”‚  - å¯è§†åŒ–å›¾è°±                                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### GUACéƒ¨ç½²

```bash
#!/bin/bash
# install-guac.sh - GUACå®‰è£…

set -e

echo "=== å®‰è£…GUAC ==="

# 1. ä½¿ç”¨Docker Composeå¿«é€Ÿå¯åŠ¨
git clone https://github.com/guacsec/guac.git
cd guac

# 2. å¯åŠ¨GUACæœåŠ¡
docker-compose up -d

# æœåŠ¡:
# - GUAC GraphQL API: http://localhost:8080
# - GUAC UI: http://localhost:3000
# - Neo4j: http://localhost:7474

echo "=== GUACå¯åŠ¨å®Œæˆ ==="
echo "è®¿é—®UI: http://localhost:3000"
```

---

### GUACæŸ¥è¯¢ç¤ºä¾‹

**1. æŸ¥æ‰¾å—CVEå½±å“çš„æ‰€æœ‰é•œåƒ**

```graphql
query FindAffectedImages {
  vulnerabilities(vulnID: "CVE-2024-12345") {
    vulnerability {
      vulnerabilityIDs {
        vulnerabilityID
      }
    }
    packages {
      package {
        namespaces {
          namespace
          names {
            name
            versions {
              version
            }
          }
        }
      }
    }
  }
}
```

**2. æŸ¥æ‰¾é•œåƒçš„å®Œæ•´ä¾èµ–æ ‘**

```graphql
query ImageDependencies {
  artifacts(artifactSpec: {
    digest: "sha256:abc123..."
  }) {
    ... on Package {
      namespaces {
        namespace
        names {
          name
          versions {
            version
            dependencies {
              package {
                name
                version
              }
            }
          }
        }
      }
    }
  }
}
```

**3. æŸ¥æ‰¾æœªç­¾åçš„é•œåƒ**

```graphql
query UnsignedImages {
  artifacts {
    ... on Artifact {
      algorithm
      digest
      signatures {
        signature
      }
    }
  }
}
```

---

## VEXæ¼æ´å¯åˆ©ç”¨æ€§äº¤æ¢

### VEXæ¦‚è¿°

**VEX** (Vulnerability Exploitability eXchangeï¼Œæ¼æ´å¯åˆ©ç”¨æ€§äº¤æ¢) æ˜¯ä¸€ç§**æ ‡å‡†æ ¼å¼**ï¼Œç”¨äºæè¿°æ¼æ´çš„**å®é™…å¯åˆ©ç”¨æ€§**ã€‚

**é—®é¢˜åœºæ™¯**:

```text
åœºæ™¯: å®¹å™¨é•œåƒä¸­åŒ…å«OpenSSL 3.0.10

æ¼æ´æ‰«æå™¨æŠ¥å‘Š:
- CVE-2023-12345: CRITICAL (CVSS 9.8)
- å»ºè®®: ç«‹å³å‡çº§

å®é™…æƒ…å†µ:
- è¯¥æ¼æ´ä»…å½±å“OpenSSLçš„XåŠŸèƒ½
- æˆ‘ä»¬çš„åº”ç”¨ä¸ä½¿ç”¨XåŠŸèƒ½
- ç»“è®º: æ¼æ´ä¸å¯åˆ©ç”¨ (False Positive)

é—®é¢˜: å¦‚ä½•å‘Šè¯‰æ‰«æå™¨"è¿™ä¸ªæ¼æ´ä¸å½±å“æˆ‘"ï¼Ÿ
ç­”æ¡ˆ: ä½¿ç”¨VEX
```

---

### VEXæ–‡æ¡£æ ¼å¼

**OpenVEXæ ¼å¼** (CycloneDX VEX):

```json
{
  "@context": "https://openvex.dev/ns/v0.2.0",
  "@id": "https://example.com/vex/2025/001",
  "author": "Security Team <security@example.com>",
  "timestamp": "2025-10-20T10:00:00Z",
  "version": 1,
  "statements": [
    {
      "vulnerability": {
        "name": "CVE-2023-12345"
      },
      "products": [
        {
          "@id": "pkg:oci/myapp@sha256:abc123..."
        }
      ],
      "status": "not_affected",
      "justification": "vulnerable_code_not_present",
      "impact_statement": "The vulnerable OpenSSL X functionality is not compiled in our build."
    },
    {
      "vulnerability": {
        "name": "CVE-2023-67890"
      },
      "products": [
        {
          "@id": "pkg:oci/myapp@sha256:abc123..."
        }
      ],
      "status": "fixed",
      "action_statement": "Upgraded to patched version"
    }
  ]
}
```

**VEXçŠ¶æ€**:

- `not_affected`: ä¸å—å½±å“
- `affected`: å—å½±å“
- `fixed`: å·²ä¿®å¤
- `under_investigation`: è°ƒæŸ¥ä¸­

---

### VEXå®è·µ

```bash
#!/bin/bash
# generate-vex.sh - ç”ŸæˆVEXæ–‡æ¡£

set -e

echo "=== ç”ŸæˆVEXæ–‡æ¡£ ==="

# 1. å®‰è£…vexctl
go install github.com/openvex/vexctl@latest

# 2. åˆ›å»ºVEXæ–‡æ¡£
cat > vex.json <<'EOF'
{
  "@context": "https://openvex.dev/ns/v0.2.0",
  "@id": "https://example.com/vex/2025/001",
  "author": "Security Team",
  "timestamp": "2025-10-20T10:00:00Z",
  "version": 1,
  "statements": [
    {
      "vulnerability": {"name": "CVE-2023-12345"},
      "products": [{"@id": "pkg:oci/myapp@sha256:abc123..."}],
      "status": "not_affected",
      "justification": "vulnerable_code_not_present"
    }
  ]
}
EOF

# 3. é™„åŠ VEXåˆ°é•œåƒ (Cosign)
cosign attach attestation \
  --attestation vex.json \
  --type openvex \
  docker.io/myorg/myapp:v1.0.0

# 4. ä½¿ç”¨VEXè¿‡æ»¤æ‰«æç»“æœ (Trivy)
trivy image --severity HIGH,CRITICAL \
  --vex vex.json \
  docker.io/myorg/myapp:v1.0.0

echo "=== VEXæ–‡æ¡£ç”Ÿæˆå¹¶é™„åŠ å®Œæˆ ==="
```

---

## Trivyå®‰å…¨æ‰«æå¢å¼º

### Trivyæ¦‚è¿°

**Trivy** æ˜¯ **Aqua Security** å¼€æºçš„**å…¨é¢å®‰å…¨æ‰«æå™¨**ã€‚

**å®˜ç½‘**: https://trivy.dev/  
**GitHub**: https://github.com/aquasecurity/trivy

**æ‰«æèƒ½åŠ›**:

- ğŸ³ **å®¹å™¨é•œåƒ**: æ¼æ´ã€é…ç½®é”™è¯¯
- ğŸ“ **æ–‡ä»¶ç³»ç»Ÿ**: æœ¬åœ°ç›®å½•ã€Gitä»“åº“
- â˜¸ï¸ **Kubernetes**: é…ç½®é”™è¯¯ã€CIS Benchmarks
- ğŸ“„ **IaC**: Terraformã€CloudFormationã€Dockerfile
- ğŸ“¦ **SBOM**: ç”Ÿæˆå’Œæ‰«æSBOM
- ğŸ”‘ **å¯†é’¥**: æ£€æµ‹ç¡¬ç¼–ç å¯†é’¥

---

### Trivy 2025æ–°ç‰¹æ€§

#### 1. **VEXæ”¯æŒ**

```bash
# ä½¿ç”¨VEXè¿‡æ»¤è¯¯æŠ¥
trivy image --vex vex.json nginx:latest
```

#### 2. **SBOMæ‰«æ**

```bash
# ç›´æ¥æ‰«æSBOMæ–‡ä»¶
trivy sbom sbom-cyclonedx.json
```

#### 3. **Kubernetes Operator**

```bash
# è‡ªåŠ¨æ‰«æé›†ç¾¤ä¸­çš„æ‰€æœ‰é•œåƒ
helm install trivy-operator aqua/trivy-operator \
  --namespace trivy-system --create-namespace
```

#### 4. **ä¾›åº”é“¾å®‰å…¨**

```bash
# éªŒè¯SLSA Provenance
trivy image --sbom-sources rekor \
  --rekor-url https://rekor.sigstore.dev \
  nginx:latest
```

---

### Trivyå…¨é¢æ‰«æ

```bash
#!/bin/bash
# trivy-comprehensive-scan.sh - Trivyå…¨é¢æ‰«æ

set -e

IMAGE="docker.io/myorg/myapp:v1.0.0"

echo "=== Trivyå…¨é¢æ‰«æ ==="

# 1. æ¼æ´æ‰«æ
echo "1. æ¼æ´æ‰«æ..."
trivy image --severity HIGH,CRITICAL $IMAGE

# 2. é…ç½®é”™è¯¯æ‰«æ
echo "2. é…ç½®é”™è¯¯æ‰«æ..."
trivy image --scanners config $IMAGE

# 3. å¯†é’¥æ³„éœ²æ‰«æ
echo "3. å¯†é’¥æ³„éœ²æ‰«æ..."
trivy image --scanners secret $IMAGE

# 4. è®¸å¯è¯åˆè§„æ‰«æ
echo "4. è®¸å¯è¯åˆè§„æ‰«æ..."
trivy image --scanners license $IMAGE

# 5. ç”ŸæˆSBOM
echo "5. ç”ŸæˆSBOM..."
trivy image --format cyclonedx $IMAGE > sbom.json

# 6. Kubernetesé…ç½®æ‰«æ
echo "6. Kubernetesé…ç½®æ‰«æ..."
trivy k8s --report summary cluster

# 7. IaCæ‰«æ (Terraform)
echo "7. IaCæ‰«æ..."
trivy config ./terraform/

# 8. ç”ŸæˆHTMLæŠ¥å‘Š
echo "8. ç”ŸæˆHTMLæŠ¥å‘Š..."
trivy image --format template --template "@contrib/html.tpl" \
  -o report.html $IMAGE

echo ""
echo "=== Trivyæ‰«æå®Œæˆ ==="
```

---

### Trivy CI/CDé›†æˆ

**GitHub Actions**:

```yaml
# .github/workflows/trivy-scan.yaml
name: Trivy Security Scan

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  trivy:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    
    - name: Build image
      run: docker build -t ${{ github.repository }}:${{ github.sha }} .
    
    - name: Run Trivy vulnerability scanner
      uses: aquasecurity/trivy-action@master
      with:
        image-ref: ${{ github.repository }}:${{ github.sha }}
        format: 'sarif'
        output: 'trivy-results.sarif'
        severity: 'CRITICAL,HIGH'
    
    - name: Upload Trivy results to GitHub Security
      uses: github/codeql-action/upload-sarif@v2
      with:
        sarif_file: 'trivy-results.sarif'
    
    - name: Fail build on CRITICAL vulnerabilities
      uses: aquasecurity/trivy-action@master
      with:
        image-ref: ${{ github.repository }}:${{ github.sha }}
        exit-code: '1'
        severity: 'CRITICAL'
```

---

### Trivy Operator

**è‡ªåŠ¨æ‰«æé›†ç¾¤é•œåƒ**:

```bash
# å®‰è£…Trivy Operator
helm repo add aqua https://aquasecurity.github.io/helm-charts/
helm install trivy-operator aqua/trivy-operator \
  --namespace trivy-system --create-namespace \
  --set="trivy.ignoreUnfixed=true"

# æŸ¥çœ‹æ‰«ææŠ¥å‘Š
kubectl get vulnerabilityreports -A

# æŸ¥çœ‹è¯¦ç»†æŠ¥å‘Š
kubectl describe vulnerabilityreport <report-name> -n <namespace>
```

**VulnerabilityReport CRD**:

```yaml
apiVersion: aquasecurity.github.io/v1alpha1
kind: VulnerabilityReport
metadata:
  name: pod-nginx-7d8f9c5b4-xjk2m
  namespace: default
report:
  vulnerabilities:
  - vulnerabilityID: CVE-2023-12345
    severity: CRITICAL
    score: 9.8
    title: "OpenSSL Remote Code Execution"
    installedVersion: "3.0.10"
    fixedVersion: "3.0.11"
```

---

## Falcoè¿è¡Œæ—¶å®‰å…¨

### Falcoæ¦‚è¿°

**Falco** æ˜¯ **CNCFæ¯•ä¸šé¡¹ç›®**ï¼ŒåŸºäº**eBPF**çš„**è¿è¡Œæ—¶å®‰å…¨ç›‘æ§**å·¥å…·ã€‚

**å®˜ç½‘**: https://falco.org/  
**GitHub**: https://github.com/falcosecurity/falco

**æ ¸å¿ƒåŠŸèƒ½**:

- ğŸ” **å¼‚å¸¸è¡Œä¸ºæ£€æµ‹**: æ£€æµ‹å®¹å™¨å†…å¼‚å¸¸è¡Œä¸º
- ğŸ“Š **ç³»ç»Ÿè°ƒç”¨ç›‘æ§**: åŸºäºeBPFï¼Œä½å¼€é”€
- ğŸš¨ **å®æ—¶å‘Šè­¦**: Slackã€PagerDutyã€Webhook

---

### Falco 2025æ–°ç‰¹æ€§

#### 1. **eBPFåŸç”Ÿ** (é»˜è®¤)

```bash
# Falco 0.37+ é»˜è®¤ä½¿ç”¨eBPF (æ— éœ€å†…æ ¸æ¨¡å—)
helm install falco falcosecurity/falco \
  --namespace falco --create-namespace \
  --set driver.kind=ebpf
```

#### 2. **æ’ä»¶ç”Ÿæ€**

```yaml
# falco.yaml
plugins:
- name: cloudtrail
  library_path: /usr/share/falco/plugins/libcloudtrail.so
  init_config: |
    aws_region: us-east-1
```

---

### Falcoè§„åˆ™ç¤ºä¾‹

```yaml
# falco-rules.yaml
- rule: Shell in Container
  desc: Detect shell spawned inside a container
  condition: >
    spawned_process and
    container and
    proc.name in (bash, sh, zsh)
  output: >
    Shell spawned in container
    (user=%user.name container=%container.name
    image=%container.image.repository:%container.image.tag
    shell=%proc.name parent=%proc.pname cmdline=%proc.cmdline)
  priority: WARNING
  tags: [container, shell, mitre_execution]

- rule: Write below etc
  desc: Detect write to /etc directory
  condition: >
    open_write and
    container and
    fd.name startswith /etc/
  output: >
    File below /etc opened for writing
    (user=%user.name container=%container.name
    file=%fd.name parent=%proc.pname cmdline=%proc.cmdline)
  priority: ERROR
  tags: [filesystem, mitre_persistence]

- rule: Outbound Connection to C2 Server
  desc: Detect connection to known C2 server
  condition: >
    outbound and
    container and
    fd.sip in (malicious_ips)
  output: >
    Outbound connection to suspicious IP
    (user=%user.name container=%container.name
    connection=%fd.name)
  priority: CRITICAL
  tags: [network, mitre_command_and_control]
```

---

## Tetragon eBPFå®‰å…¨

### Tetragonæ¦‚è¿°

**Tetragon** æ˜¯ **Cilium** çš„eBPFå®‰å…¨ç»„ä»¶ï¼Œæä¾›**è¿è¡Œæ—¶æ‰§è¡Œç­–ç•¥**ã€‚

**GitHub**: https://github.com/cilium/tetragon

**æ ¸å¿ƒåŠŸèƒ½**:

- âš¡ **å®æ—¶æ‰§è¡Œç­–ç•¥**: åŸºäºeBPFï¼Œå†…æ ¸çº§æ‰§è¡Œ
- ğŸ”’ **é›¶ä¿¡ä»»æ‰§è¡Œ**: åªå…è®¸é¢„å®šä¹‰çš„è¡Œä¸º
- ğŸ“Š **æ·±åº¦å¯è§‚æµ‹æ€§**: ç³»ç»Ÿè°ƒç”¨ã€æ–‡ä»¶ã€ç½‘ç»œ

---

### Tetragonç­–ç•¥ç¤ºä¾‹

```yaml
# tetragon-policy.yaml
apiVersion: cilium.io/v1alpha1
kind: TracingPolicy
metadata:
  name: prevent-sensitive-file-access
spec:
  lists:
  - name: "sensitive_files"
    type: "files"
    values:
    - "/etc/shadow"
    - "/etc/passwd"
    - "/root/.ssh/id_rsa"
  
  kprobes:
  - call: "security_file_open"
    syscall: false
    args:
    - index: 0
      type: "file"
    selectors:
    - matchArgs:
      - index: 0
        operator: "InList"
        values:
        - "sensitive_files"
      matchActions:
      - action: Block  # é˜»æ­¢è®¿é—®
      - action: Notify  # å‘é€å‘Šè­¦
```

---

## OPA/Kyvernoç­–ç•¥å¼•æ“

### Kyverno 2025æ–°ç‰¹æ€§

**Kyverno** æ˜¯ **CNCFå­µåŒ–é¡¹ç›®**ï¼Œä¸“ä¸ºKubernetesè®¾è®¡çš„**ç­–ç•¥å¼•æ“**ã€‚

**å®˜ç½‘**: https://kyverno.io/

#### 1. **Validate Admission Rules** (1.11+)

```yaml
# validate-admission-rule.yaml
apiVersion: admissionregistration.k8s.io/v1
kind: ValidatingAdmissionPolicy
metadata:
  name: require-labels
spec:
  matchConstraints:
    resourceRules:
    - apiGroups: ["apps"]
      apiVersions: ["v1"]
      resources: ["deployments"]
      operations: ["CREATE", "UPDATE"]
  validations:
  - expression: "has(object.metadata.labels.team)"
    message: "Deployment must have 'team' label"
```

---

### Kyvernoç­–ç•¥ç¤ºä¾‹

**1. å¼ºåˆ¶é•œåƒç­¾åéªŒè¯**

```yaml
# verify-image-signature.yaml
apiVersion: kyverno.io/v1
kind: ClusterPolicy
metadata:
  name: verify-image-signature
spec:
  validationFailureAction: Enforce
  rules:
  - name: verify-signature
    match:
      any:
      - resources:
          kinds:
          - Pod
    verifyImages:
    - imageReferences:
      - "docker.io/myorg/*"
      attestors:
      - entries:
        - keyless:
            subject: "*@myorg.com"
            issuer: "https://github.com/login/oauth"
            rekor:
              url: https://rekor.sigstore.dev
```

**2. ç¦æ­¢ç‰¹æƒå®¹å™¨**

```yaml
# disallow-privileged.yaml
apiVersion: kyverno.io/v1
kind: ClusterPolicy
metadata:
  name: disallow-privileged
spec:
  validationFailureAction: Enforce
  rules:
  - name: check-privileged
    match:
      any:
      - resources:
          kinds:
          - Pod
    validate:
      message: "Privileged containers are not allowed"
      pattern:
        spec:
          containers:
          - =(securityContext):
              =(privileged): false
```

**3. è‡ªåŠ¨æ³¨å…¥Sidecar (Mutation)**

```yaml
# inject-sidecar.yaml
apiVersion: kyverno.io/v1
kind: ClusterPolicy
metadata:
  name: inject-logging-sidecar
spec:
  rules:
  - name: inject-sidecar
    match:
      any:
      - resources:
          kinds:
          - Pod
          namespaces:
          - production
    mutate:
      patchStrategicMerge:
        spec:
          containers:
          - name: log-forwarder
            image: fluent/fluent-bit:latest
            volumeMounts:
            - name: varlog
              mountPath: /var/log
```

---

## é›¶ä¿¡ä»»å®‰å…¨æ¶æ„

### SPIFFE/SPIREèº«ä»½è®¤è¯

**SPIFFE** (Secure Production Identity Framework For Everyone) æ˜¯**é›¶ä¿¡ä»»èº«ä»½æ ‡å‡†**ã€‚

**å®˜ç½‘**: https://spiffe.io/

**æ ¸å¿ƒæ¦‚å¿µ**:

- **SPIFFE ID**: `spiffe://trust-domain/workload-identifier`
- **SVID**: SPIFFE Verifiable Identity Document (X.509è¯ä¹¦æˆ–JWT)
- **SPIRE**: SPIFFE Runtime Environment (å®ç°)

**éƒ¨ç½²SPIRE**:

```bash
# å®‰è£…SPIRE
helm install spire-server spire/spire-server \
  --namespace spire --create-namespace

helm install spire-agent spire/spire-agent \
  --namespace spire
```

---

### mTLSè‡ªåŠ¨åŒ–

**Istio Ambient Mode (æ— Sidecar mTLS)**:

```yaml
# ambient-mtls.yaml
apiVersion: security.istio.io/v1beta1
kind: PeerAuthentication
metadata:
  name: default
  namespace: production
spec:
  mtls:
    mode: STRICT  # å¼ºåˆ¶mTLS
```

---

## å®‰å…¨æœ€ä½³å®è·µ

### é•œåƒå®‰å…¨

#### 1. **ä½¿ç”¨æœ€å°åŒ–åŸºç¡€é•œåƒ**

```dockerfile
# æ¨è: Distroless
FROM gcr.io/distroless/static-debian12:nonroot
COPY --from=builder /app/binary /app

# æˆ–: Alpine
FROM alpine:3.19
RUN apk add --no-cache ca-certificates
COPY --from=builder /app/binary /app
```

#### 2. **å¤šé˜¶æ®µæ„å»º + érootç”¨æˆ·**

```dockerfile
# Dockerfile (å®‰å…¨æœ€ä½³å®è·µ)
FROM golang:1.21 AS builder
WORKDIR /build
COPY . .
RUN CGO_ENABLED=0 go build -o app .

FROM gcr.io/distroless/static-debian12:nonroot
COPY --from=builder /build/app /app
USER nonroot:nonroot
ENTRYPOINT ["/app"]
```

#### 3. **ç­¾åå’ŒéªŒè¯**

```bash
# æ„å»ºã€ç­¾åã€æ¨é€
docker build -t myorg/app:v1.0.0 .
docker push myorg/app:v1.0.0
cosign sign myorg/app:v1.0.0
```

---

### è¿è¡Œæ—¶å®‰å…¨

#### 1. **Pod Security Standards**

```yaml
# pod-security-standards.yaml
apiVersion: v1
kind: Namespace
metadata:
  name: production
  labels:
    pod-security.kubernetes.io/enforce: restricted
    pod-security.kubernetes.io/audit: restricted
    pod-security.kubernetes.io/warn: restricted
```

#### 2. **AppArmor/SELinux**

```yaml
# apparmor-pod.yaml
apiVersion: v1
kind: Pod
metadata:
  name: secure-pod
  annotations:
    container.apparmor.security.beta.kubernetes.io/app: runtime/default
spec:
  securityContext:
    seLinuxOptions:
      level: "s0:c123,c456"
  containers:
  - name: app
    image: myapp:latest
    securityContext:
      allowPrivilegeEscalation: false
      runAsNonRoot: true
      runAsUser: 1000
      capabilities:
        drop:
        - ALL
      seccompProfile:
        type: RuntimeDefault
```

---

### ç½‘ç»œå®‰å…¨

#### 1. **NetworkPolicy**

```yaml
# network-policy-default-deny.yaml
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: default-deny-all
  namespace: production
spec:
  podSelector: {}
  policyTypes:
  - Ingress
  - Egress
---
apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: allow-frontend-to-backend
  namespace: production
spec:
  podSelector:
    matchLabels:
      tier: backend
  policyTypes:
  - Ingress
  ingress:
  - from:
    - podSelector:
        matchLabels:
          tier: frontend
    ports:
    - protocol: TCP
      port: 8080
```

---

### æ•°æ®å®‰å…¨

#### 1. **å¯†é’¥åŠ å¯† (KMS)**

```yaml
# encryption-config.yaml
apiVersion: apiserver.config.k8s.io/v1
kind: EncryptionConfiguration
resources:
- resources:
  - secrets
  providers:
  - kms:
      name: aws-kms
      endpoint: unix:///var/run/kmsplugin/socket.sock
      cachesize: 1000
  - identity: {}
```

#### 2. **External Secrets Operator**

```yaml
# external-secret.yaml
apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: database-credentials
spec:
  refreshInterval: 1h
  secretStoreRef:
    name: aws-secrets-manager
    kind: SecretStore
  target:
    name: database-credentials
    creationPolicy: Owner
  data:
  - secretKey: password
    remoteRef:
      key: prod/database/password
```

---

## å®‰å…¨åˆè§„æ¡†æ¶

### CIS Benchmarks

```bash
# ä½¿ç”¨kube-benchæ£€æŸ¥CIS Kubernetes Benchmark
kubectl apply -f https://raw.githubusercontent.com/aquasecurity/kube-bench/main/job.yaml
kubectl logs -f job/kube-bench
```

### PCI DSS

**PCI DSSåˆè§„è¦æ±‚**:

- âœ… ç½‘ç»œéš”ç¦» (NetworkPolicy)
- âœ… è®¿é—®æ§åˆ¶ (RBAC)
- âœ… æ—¥å¿—å®¡è®¡ (Audit Logs)
- âœ… æ•°æ®åŠ å¯† (KMS)

### SOC 2

**SOC 2åˆè§„è¦æ±‚**:

- âœ… å®‰å…¨ç›‘æ§ (Falco/Tetragon)
- âœ… å˜æ›´ç®¡ç† (GitOps)
- âœ… äº‹ä»¶å“åº” (å‘Šè­¦æµç¨‹)
- âœ… æ•°æ®å¤‡ä»½ (Velero)

---

## å®‰å…¨ç”Ÿäº§æ¡ˆä¾‹

### æ¡ˆä¾‹1ï¼šä¾›åº”é“¾æ”»å‡»é˜²å¾¡

**èƒŒæ™¯**: æŸé‡‘èå…¬å¸é˜²å¾¡ä¾›åº”é“¾æ”»å‡»

**å®‰å…¨æªæ–½**:

1. **é•œåƒç­¾åå¼ºåˆ¶éªŒè¯**:

   ```yaml
   # Kyvernoç­–ç•¥
   apiVersion: kyverno.io/v1
   kind: ClusterPolicy
   metadata:
     name: require-signed-images
   spec:
     validationFailureAction: Enforce
     rules:
     - name: verify-signature
       match:
         any:
         - resources:
             kinds: [Pod]
       verifyImages:
       - imageReferences: ["*"]
         attestors:
         - entries:
           - keyless:
               issuer: "https://github.com/login/oauth"
               rekor:
                 url: https://rekor.sigstore.dev
   ```

2. **SBOMå¼ºåˆ¶ç”Ÿæˆ**:

   ```bash
   # CI/CDæµæ°´çº¿
   syft $IMAGE -o cyclonedx-json > sbom.json
   cosign attach sbom --sbom sbom.json $IMAGE
   ```

3. **æ¼æ´æ‰«æé—¨ç¦**:

   ```bash
   # CI/CDå¤±è´¥æ¡ä»¶
   trivy image --exit-code 1 --severity CRITICAL $IMAGE
   ```

**æ•ˆæœ**:

- âœ… 100%é•œåƒç­¾åç‡
- âœ… 100% SBOMè¦†ç›–ç‡
- âœ… 0ä¸ªCRITICALæ¼æ´è¿›å…¥ç”Ÿäº§

---

### æ¡ˆä¾‹2ï¼šé›¶ä¿¡ä»»å®‰å…¨æ¶æ„

**èƒŒæ™¯**: æŸç”µå•†å…¬å¸å®æ–½é›¶ä¿¡ä»»æ¶æ„

**æ¶æ„**:

```text
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é›¶ä¿¡ä»»æ¶æ„                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  èº«ä»½å±‚ (SPIFFE/SPIRE)                    â”‚  â”‚
â”‚  â”‚  - å·¥ä½œè´Ÿè½½èº«ä»½ (SVID)                     â”‚  â”‚
â”‚  â”‚  - çŸ­æœŸè¯ä¹¦ (1å°æ—¶TTL)                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                     â†“                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ä¼ è¾“å±‚ (Istio Ambient mTLS)              â”‚  â”‚
â”‚  â”‚  - è‡ªåŠ¨mTLS                               â”‚  â”‚
â”‚  â”‚  - æ— Sidecar                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                     â†“                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ç­–ç•¥å±‚ (OPA/Kyverno)                     â”‚  â”‚
â”‚  â”‚  - ç»†ç²’åº¦æˆæƒ                             â”‚  â”‚
â”‚  â”‚  - åŠ¨æ€ç­–ç•¥                               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                     â†“                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ç›‘æ§å±‚ (Falco/Tetragon)                  â”‚  â”‚
â”‚  â”‚  - è¿è¡Œæ—¶è¡Œä¸ºç›‘æ§                         â”‚  â”‚
â”‚  â”‚  - å®æ—¶å‘Šè­¦                               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ•ˆæœ**:

- âœ… 100% mTLSè¦†ç›–ç‡
- âœ… å·¥ä½œè´Ÿè½½èº«ä»½è‡ªåŠ¨åŒ–
- âœ… å®‰å…¨äº‹ä»¶å“åº”æ—¶é—´ <5åˆ†é’Ÿ

---

## å®‰å…¨æœªæ¥è¶‹åŠ¿

### 1. **ä¾›åº”é“¾å®‰å…¨æ ‡å‡†åŒ–**

- âœ… SBOMå¼ºåˆ¶è¦æ±‚ (ç¾å›½EO 14028)
- âœ… SLSA Level 3æˆä¸ºè¡Œä¸šæ ‡å‡†
- âœ… Sigstoreç”Ÿæ€æˆç†Ÿ

### 2. **eBPFé©±åŠ¨å®‰å…¨**

- âœ… å†…æ ¸çº§å®‰å…¨ç­–ç•¥
- âœ… é›¶æ€§èƒ½å¼€é”€
- âœ… è¿è¡Œæ—¶ä¿æŠ¤æ ‡é…

### 3. **AIè¾…åŠ©å®‰å…¨**

- âœ… æ™ºèƒ½æ¼æ´ä¼˜å…ˆçº§
- âœ… å¼‚å¸¸è¡Œä¸ºæ£€æµ‹
- âœ… è‡ªåŠ¨åŒ–å“åº”

### 4. **é›¶ä¿¡ä»»ä¸»æµåŒ–**

- âœ… SPIFFE/SPIREæ ‡å‡†åŒ–
- âœ… Ambient Meshæ— Sidecar
- âœ… å·¥ä½œè´Ÿè½½èº«ä»½æ™®åŠ

---

## ç›¸å…³èµ„æº

### å®˜æ–¹æ–‡æ¡£

- [Sigstoreå®˜ç½‘](https://www.sigstore.dev/)
- [SLSAå®˜ç½‘](https://slsa.dev/)
- [GUACå®˜ç½‘](https://guac.sh/)
- [Trivyå®˜ç½‘](https://trivy.dev/)
- [Falcoå®˜ç½‘](https://falco.org/)

### GitHubä»“åº“

- [Cosign GitHub](https://github.com/sigstore/cosign)
- [Trivy GitHub](https://github.com/aquasecurity/trivy)
- [Kyverno GitHub](https://github.com/kyverno/kyverno)
- [Falco GitHub](https://github.com/falcosecurity/falco)

### å­¦ä¹ èµ„æº

- [CNCF Security TAG](https://github.com/cncf/tag-security)
- [Kubernetes Security Best Practices](https://kubernetes.io/docs/concepts/security/)

---

**æ›´æ–°æ—¶é—´**: 2025-10-20  
**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**çŠ¶æ€**: âœ… **å®Œæˆ - 2025äº‘åŸç”Ÿå®‰å…¨æ ‡å‡†å…¨é¢å¯¹é½**

---

**ğŸ”’ å®‰å…¨æ˜¯äº‘åŸç”Ÿçš„åŸºçŸ³ï¼Œä¾›åº”é“¾å®‰å…¨å’Œé›¶ä¿¡ä»»æ¶æ„æ˜¯2025å¹´çš„é‡ç‚¹ï¼**
