# äº¤æ¢æœºé…ç½®ä¸ä¼˜åŒ–

> **è¿”å›**: [ç½‘ç»œæ¶æ„ç›®å½•](README.md) | [è™šæ‹ŸåŒ–éƒ¨ç½²é¦–é¡µ](../README.md) | [éƒ¨ç½²æŒ‡å—é¦–é¡µ](../../00_ç´¢å¼•å¯¼èˆª/README.md)

---

## ğŸ“‹ ç›®å½•

- [äº¤æ¢æœºé…ç½®ä¸ä¼˜åŒ–](#äº¤æ¢æœºé…ç½®ä¸ä¼˜åŒ–)
  - [ğŸ“‹ ç›®å½•](#-ç›®å½•)
  - [äº¤æ¢æœºåŸºç¡€é…ç½®](#äº¤æ¢æœºåŸºç¡€é…ç½®)
    - [Ciscoäº¤æ¢æœºåŸºç¡€é…ç½®](#ciscoäº¤æ¢æœºåŸºç¡€é…ç½®)
    - [HPE/Arubaäº¤æ¢æœºåŸºç¡€é…ç½®](#hpearubaäº¤æ¢æœºåŸºç¡€é…ç½®)
    - [åä¸ºäº¤æ¢æœºåŸºç¡€é…ç½®](#åä¸ºäº¤æ¢æœºåŸºç¡€é…ç½®)
  - [VLANé…ç½®](#vlané…ç½®)
    - [åˆ›å»ºå’Œç®¡ç†VLAN](#åˆ›å»ºå’Œç®¡ç†vlan)
    - [Accessç«¯å£é…ç½®](#accessç«¯å£é…ç½®)
    - [Trunkç«¯å£é…ç½®](#trunkç«¯å£é…ç½®)
    - [VLANé—´è·¯ç”±é…ç½®](#vlané—´è·¯ç”±é…ç½®)
    - [Private VLANé…ç½®](#private-vlané…ç½®)
  - [é“¾è·¯èšåˆé…ç½®](#é“¾è·¯èšåˆé…ç½®)
    - [LACPé…ç½® (æ¨è)](#lacpé…ç½®-æ¨è)
    - [PAgPé…ç½® (Ciscoç§æœ‰)](#pagpé…ç½®-ciscoç§æœ‰)
    - [Static EtherChannelé…ç½®](#static-etherchannelé…ç½®)
    - [è´Ÿè½½å‡è¡¡é…ç½®](#è´Ÿè½½å‡è¡¡é…ç½®)
    - [HPE/Arubaé“¾è·¯èšåˆ](#hpearubaé“¾è·¯èšåˆ)
    - [åä¸ºé“¾è·¯èšåˆ](#åä¸ºé“¾è·¯èšåˆ)
  - [ç”Ÿæˆæ ‘åè®®é…ç½®](#ç”Ÿæˆæ ‘åè®®é…ç½®)
    - [RSTPé…ç½®](#rstpé…ç½®)
    - [MSTPé…ç½®](#mstpé…ç½®)
    - [HPE/Arubaç”Ÿæˆæ ‘](#hpearubaç”Ÿæˆæ ‘)
  - [QoSé…ç½®](#qosé…ç½®)
    - [åŸºç¡€QoSé…ç½®](#åŸºç¡€qosé…ç½®)
    - [å­˜å‚¨ç½‘ç»œQoS](#å­˜å‚¨ç½‘ç»œqos)
    - [Auto-QoSé…ç½®](#auto-qosé…ç½®)
  - [ç«¯å£å®‰å…¨é…ç½®](#ç«¯å£å®‰å…¨é…ç½®)
    - [åŸºç¡€ç«¯å£å®‰å…¨](#åŸºç¡€ç«¯å£å®‰å…¨)
    - [DHCP Snooping](#dhcp-snooping)
    - [Dynamic ARP Inspection (DAI)](#dynamic-arp-inspection-dai)
    - [IP Source Guard](#ip-source-guard)
  - [é«˜å¯ç”¨é…ç½®](#é«˜å¯ç”¨é…ç½®)
    - [å †å é…ç½® (Cisco StackWise)](#å †å é…ç½®-cisco-stackwise)
    - [VSSé…ç½® (Cisco Virtual Switching System)](#vssé…ç½®-cisco-virtual-switching-system)
    - [VSFé…ç½® (HPE Aruba)](#vsfé…ç½®-hpe-aruba)
    - [CSSé…ç½® (åä¸º)](#cssé…ç½®-åä¸º)
  - [æ€§èƒ½ä¼˜åŒ–](#æ€§èƒ½ä¼˜åŒ–)
    - [Jumbo Frameé…ç½®](#jumbo-frameé…ç½®)
    - [æµé‡ç›‘æ§ (NetFlow/sFlow)](#æµé‡ç›‘æ§-netflowsflow)
    - [ç«¯å£é•œåƒ (SPAN)](#ç«¯å£é•œåƒ-span)
    - [CPUä¿æŠ¤](#cpuä¿æŠ¤)
  - [ç›‘æ§ä¸ç®¡ç†](#ç›‘æ§ä¸ç®¡ç†)
    - [SNMPé…ç½®è¯¦è§£](#snmpé…ç½®è¯¦è§£)
    - [æ—¥å¿—é…ç½®](#æ—¥å¿—é…ç½®)
    - [é…ç½®å¤‡ä»½](#é…ç½®å¤‡ä»½)
  - [æ•…éšœæ’æŸ¥](#æ•…éšœæ’æŸ¥)
  - [ç›¸å…³æ–‡æ¡£](#ç›¸å…³æ–‡æ¡£)

---

## äº¤æ¢æœºåŸºç¡€é…ç½®

### Ciscoäº¤æ¢æœºåŸºç¡€é…ç½®

```cisco
! ========================================
! Ciscoäº¤æ¢æœºåˆå§‹åŒ–é…ç½®
! ========================================

! 1. è¿›å…¥ç‰¹æƒæ¨¡å¼
enable

! 2. è¿›å…¥å…¨å±€é…ç½®æ¨¡å¼
configure terminal

! 3. åŸºç¡€é…ç½®
hostname Core-SW1
no ip domain-lookup
service password-encryption

! 4. é…ç½®ç‰¹æƒå¯†ç 
enable secret Cisco@2025

! 5. é…ç½®Consoleå¯†ç 
line console 0
 password Console@2025
 login
 logging synchronous
 exec-timeout 30 0
 exit

! 6. é…ç½®VTY (Telnet/SSH)
line vty 0 15
 password VTY@2025
 login local
 transport input ssh
 exec-timeout 30 0
 exit

! 7. åˆ›å»ºç®¡ç†ç”¨æˆ·
username admin privilege 15 secret Admin@2025

! 8. é…ç½®SSH
ip domain-name example.com
crypto key generate rsa modulus 2048
ip ssh version 2
ip ssh time-out 60
ip ssh authentication-retries 3

! 9. é…ç½®ç®¡ç†VLAN
vlan 10
 name MGMT-Network
 exit

interface Vlan10
 description Management-Interface
 ip address 192.168.10.10 255.255.255.0
 no shutdown
 exit

! 10. é…ç½®é»˜è®¤ç½‘å…³
ip default-gateway 192.168.10.1

! 11. é…ç½®NTP
ntp server 192.168.10.1 prefer
clock timezone CST 8
clock summer-time CDT recurring

! 12. é…ç½®æ—¥å¿—
logging buffered 51200 informational
logging console warnings
logging trap informational
logging source-interface Vlan10
logging host 192.168.10.100

! 13. é…ç½®SNMP
snmp-server community public RO
snmp-server community private RW
snmp-server location "DC1-Rack-A-U10"
snmp-server contact "admin@example.com"
snmp-server enable traps
snmp-server host 192.168.10.100 version 2c public

! 14. Banneré…ç½®
banner login ^C
========================================
  Authorized Access Only
  Contact: admin@example.com
========================================
^C

! 15. ä¿å­˜é…ç½®
end
write memory

! æˆ–ä½¿ç”¨
copy running-config startup-config
```

### HPE/Arubaäº¤æ¢æœºåŸºç¡€é…ç½®

```bash
# ========================================
# HPE Arubaäº¤æ¢æœºåˆå§‹åŒ–é…ç½®
# ========================================

# è¿›å…¥é…ç½®æ¨¡å¼
configure

# åŸºç¡€é…ç½®
hostname "Core-SW1"
time timezone 480
time daylight-time-rule continental-us-and-canada

# åˆ›å»ºç®¡ç†ç”¨æˆ·
user admin group administrators password plaintext Admin@2025

# é…ç½®SSH
crypto key generate ssh rsa bits 2048
ip ssh version 2

# é…ç½®ç®¡ç†VLAN
vlan 10
   name "MGMT-Network"
   exit

interface vlan 10
   ip address 192.168.10.10/24
   exit

# é…ç½®é»˜è®¤ç½‘å…³
ip route 0.0.0.0/0 192.168.10.1

# é…ç½®NTP
ntp server 192.168.10.1 prefer
ntp enable

# é…ç½®æ—¥å¿—
logging 192.168.10.100
logging facility local7
logging severity info

# é…ç½®SNMP
snmp-server community "public" unrestricted
snmp-server host 192.168.10.100 community "public"
snmp-server location "DC1-Rack-A-U10"
snmp-server contact "admin@example.com"

# Banner
banner motd "Authorized Access Only"

# ä¿å­˜é…ç½®
write memory
```

### åä¸ºäº¤æ¢æœºåŸºç¡€é…ç½®

```huawei
# ========================================
# åä¸ºäº¤æ¢æœºåˆå§‹åŒ–é…ç½®
# ========================================

# è¿›å…¥ç³»ç»Ÿè§†å›¾
system-view

# åŸºç¡€é…ç½®
sysname Core-SW1
clock timezone BJ add 08:00:00

# é…ç½®ç”¨æˆ·
aaa
 local-user admin password irreversible-cipher Admin@2025
 local-user admin privilege level 15
 local-user admin service-type telnet terminal ssh
 quit

# é…ç½®SSH
rsa local-key-pair create
stelnet server enable
ssh user admin authentication-type password
ssh user admin service-type stelnet

# é…ç½®Console
user-interface con 0
 authentication-mode password
 set authentication password cipher Console@2025
 idle-timeout 30 0
 quit

# é…ç½®VTY
user-interface vty 0 4
 authentication-mode aaa
 protocol inbound ssh
 idle-timeout 30 0
 quit

# é…ç½®ç®¡ç†VLAN
vlan 10
 description MGMT-Network
 quit

interface Vlanif10
 description Management-Interface
 ip address 192.168.10.10 255.255.255.0
 quit

# é…ç½®é»˜è®¤è·¯ç”±
ip route-static 0.0.0.0 0.0.0.0 192.168.10.1

# é…ç½®NTP
ntp-service unicast-server 192.168.10.1 prefer
ntp-service enable

# é…ç½®æ—¥å¿—
info-center loghost 192.168.10.100
info-center source default channel loghost log state on level informational

# é…ç½®SNMP
snmp-agent
snmp-agent community read public
snmp-agent sys-info contact admin@example.com
snmp-agent sys-info location DC1-Rack-A-U10
snmp-agent target-host trap address udp-domain 192.168.10.100 params securityname public

# ä¿å­˜é…ç½®
quit
save
```

---

## VLANé…ç½®

### åˆ›å»ºå’Œç®¡ç†VLAN

```cisco
! ========================================
! Cisco VLANé…ç½®
! ========================================

! 1. åˆ›å»ºVLAN
vlan 10
 name MGMT-Network
vlan 11
 name VMware-Management
vlan 20
 name vMotion-Network
vlan 30
 name iSCSI-Storage-A
vlan 31
 name iSCSI-Storage-B
vlan 40
 name Web-Tier
vlan 41
 name App-Tier
vlan 42
 name Database-Tier
vlan 100
 name Office-Network
vlan 999
 name Unused-VLAN

! 2. æŸ¥çœ‹VLAN
show vlan brief
show vlan id 10

! 3. åˆ é™¤VLAN
no vlan 999

! 4. æ‰¹é‡åˆ›å»ºVLAN
vlan 40-49
 name Production-VLANs
```

### Accessç«¯å£é…ç½®

```cisco
! ========================================
! Accessç«¯å£é…ç½® (è¿æ¥æœåŠ¡å™¨/PC)
! ========================================

! æ ‡å‡†Accessé…ç½®
interface GigabitEthernet1/0/1
 description ESXi-Host-1-MGMT
 switchport mode access
 switchport access vlan 11
 spanning-tree portfast
 spanning-tree bpduguard enable
 no shutdown

! å¸¦Voice VLANçš„é…ç½® (IPç”µè¯)
interface GigabitEthernet1/0/10
 description IP-Phone-User-PC
 switchport mode access
 switchport access vlan 100
 switchport voice vlan 220
 spanning-tree portfast
 power inline auto
 no shutdown

! å¸¦Port Securityçš„é…ç½®
interface GigabitEthernet1/0/20
 description Secure-Server
 switchport mode access
 switchport access vlan 42
 switchport port-security
 switchport port-security maximum 2
 switchport port-security violation restrict
 switchport port-security mac-address sticky
 spanning-tree portfast
 no shutdown
```

### Trunkç«¯å£é…ç½®

```cisco
! ========================================
! Trunkç«¯å£é…ç½® (ä¸Šè¡Œé“¾è·¯)
! ========================================

! æ ‡å‡†Trunké…ç½®
interface GigabitEthernet1/0/48
 description Uplink-to-Core-SW1
 switchport trunk encapsulation dot1q
 switchport mode trunk
 switchport trunk allowed vlan 10,11,20,30,31,40-42,100
 switchport trunk native vlan 999
 no shutdown

! ç¦ç”¨DTP (æ¨è)
interface GigabitEthernet1/0/48
 switchport mode trunk
 switchport nonegotiate

! åŠ¨æ€Trunk (ä¸æ¨è)
interface GigabitEthernet1/0/48
 switchport mode dynamic desirable
 ! æˆ–
 switchport mode dynamic auto
```

### VLANé—´è·¯ç”±é…ç½®

```cisco
! ========================================
! L3äº¤æ¢æœºVLANé—´è·¯ç”± (SVI)
! ========================================

! å¯ç”¨IPè·¯ç”±
ip routing

! åˆ›å»ºVLANæ¥å£
interface Vlan10
 description MGMT-Network-Gateway
 ip address 192.168.10.1 255.255.255.0
 ip helper-address 192.168.10.10
 no shutdown

interface Vlan40
 description Web-Tier-Gateway
 ip address 10.100.40.1 255.255.255.0
 ip helper-address 192.168.10.10
 no shutdown

interface Vlan41
 description App-Tier-Gateway
 ip address 10.100.41.1 255.255.255.0
 ip helper-address 192.168.10.10
 no shutdown

interface Vlan42
 description Database-Tier-Gateway
 ip address 10.100.42.1 255.255.255.128
 no ip proxy-arp
 no shutdown

! é…ç½®è®¿é—®æ§åˆ¶åˆ—è¡¨ (ACL)
ip access-list extended RESTRICT-DB
 permit tcp 10.100.41.0 0.0.0.255 10.100.42.0 0.0.0.127 eq 3306
 permit tcp 10.100.41.0 0.0.0.255 10.100.42.0 0.0.0.127 eq 5432
 deny ip any 10.100.42.0 0.0.0.127
 permit ip any any

interface Vlan42
 ip access-group RESTRICT-DB in
```

### Private VLANé…ç½®

```cisco
! ========================================
! Private VLANé…ç½® (ç«¯å£éš”ç¦»)
! ========================================

! 1. åˆ›å»ºPrivate VLAN
vlan 200
 private-vlan primary
vlan 201
 private-vlan isolated
vlan 202
 private-vlan community

! 2. å…³è”Private VLAN
vlan 200
 private-vlan association 201,202

! 3. é…ç½®Promiscuousç«¯å£ (ç½‘å…³)
interface GigabitEthernet1/0/1
 switchport mode private-vlan promiscuous
 switchport private-vlan mapping 200 201,202

! 4. é…ç½®Isolatedç«¯å£
interface range GigabitEthernet1/0/2-10
 switchport mode private-vlan host
 switchport private-vlan host-association 200 201

! 5. é…ç½®Communityç«¯å£
interface range GigabitEthernet1/0/11-20
 switchport mode private-vlan host
 switchport private-vlan host-association 200 202
```

---

## é“¾è·¯èšåˆé…ç½®

### LACPé…ç½® (æ¨è)

```cisco
! ========================================
! Cisco LACP (802.3ad) é…ç½®
! ========================================

! 1. åˆ›å»ºPort-Channelæ¥å£
interface Port-channel1
 description LACP-to-Core-SW1
 switchport trunk encapsulation dot1q
 switchport mode trunk
 switchport trunk allowed vlan 10,11,20,30,31,40-42,100
 switchport trunk native vlan 999

! 2. é…ç½®ç‰©ç†æ¥å£
interface range GigabitEthernet1/0/47-48
 description Member-of-Port-channel1
 switchport trunk encapsulation dot1q
 switchport mode trunk
 switchport trunk allowed vlan 10,11,20,30,31,40-42,100
 switchport trunk native vlan 999
 channel-group 1 mode active
 no shutdown

! 3. éªŒè¯é…ç½®
show etherchannel summary
show etherchannel 1 detail
show interfaces Port-channel1

! 4. L3 Port-Channelé…ç½®
interface Port-channel2
 description L3-Link-to-Core
 no switchport
 ip address 10.10.10.1 255.255.255.252

interface range TenGigabitEthernet1/0/1-2
 description Member-of-Port-channel2
 no switchport
 channel-group 2 mode active
 no shutdown
```

### PAgPé…ç½® (Ciscoç§æœ‰)

```cisco
! ========================================
! PAgPé…ç½® (ä¸æ¨èï¼Œä»…Cisco)
! ========================================

interface Port-channel3
 switchport mode trunk

interface range GigabitEthernet1/0/45-46
 channel-group 3 mode desirable
 ! æˆ–
 channel-group 3 mode auto
```

### Static EtherChannelé…ç½®

```cisco
! ========================================
! é™æ€EtherChannelé…ç½®
! ========================================

interface Port-channel4
 switchport mode trunk

interface range GigabitEthernet1/0/43-44
 channel-group 4 mode on
 no shutdown
```

### è´Ÿè½½å‡è¡¡é…ç½®

```cisco
! ========================================
! EtherChannelè´Ÿè½½å‡è¡¡
! ========================================

! æŸ¥çœ‹å½“å‰è´Ÿè½½å‡è¡¡æ–¹æ³•
show etherchannel load-balance

! é…ç½®è´Ÿè½½å‡è¡¡ç®—æ³•
! å¯é€‰: src-mac, dst-mac, src-dst-mac, src-ip, dst-ip, src-dst-ip, src-port, dst-port, src-dst-port

! æ¨èï¼šåŸºäºæºå’Œç›®æ ‡IP
port-channel load-balance src-dst-ip

! æˆ–åŸºäºæºå’Œç›®æ ‡MAC+IP
port-channel load-balance src-dst-mixed-ip-port
```

### HPE/Arubaé“¾è·¯èšåˆ

```bash
# ========================================
# HPE Aruba LACPé…ç½®
# ========================================

# åˆ›å»ºTrunk
trunk 1/1,1/2 trk1 lacp

# é…ç½®ä¸ºTrunkæ¨¡å¼
interface trk1
   description "LACP to Core"
   vlan trunk native 999
   vlan trunk allowed 10,11,20,30,31,40-42,100
   exit

# éªŒè¯
show lacp
show trunk
```

### åä¸ºé“¾è·¯èšåˆ

```huawei
# ========================================
# åä¸ºEth-Trunké…ç½®
# ========================================

# åˆ›å»ºEth-Trunk
interface Eth-Trunk1
 description LACP-to-Core
 port link-type trunk
 port trunk allow-pass vlan 10 11 20 30 31 40 to 42 100
 port trunk pvid vlan 999
 mode lacp

# æ·»åŠ æˆå‘˜æ¥å£
interface GigabitEthernet1/0/47
 eth-trunk 1
interface GigabitEthernet1/0/48
 eth-trunk 1

# é…ç½®è´Ÿè½½å‡è¡¡
load-balance-profile lacp-profile
 load-balance enhanced dst-ip src-ip
interface Eth-Trunk1
 load-balance enhanced profile lacp-profile

# éªŒè¯
display eth-trunk 1
display lacp statistics eth-trunk 1
```

---

## ç”Ÿæˆæ ‘åè®®é…ç½®

### RSTPé…ç½®

```cisco
! ========================================
! RSTP (Rapid Spanning Tree Protocol) é…ç½®
! ========================================

! 1. å¯ç”¨RSTP
spanning-tree mode rapid-pvst

! 2. é…ç½®æ ¹æ¡¥
! ä¸»æ ¹æ¡¥ (Core-SW1)
spanning-tree vlan 1-4094 priority 4096

! å¤‡ä»½æ ¹æ¡¥ (Core-SW2)
spanning-tree vlan 1-4094 priority 8192

! 3. é…ç½®ç«¯å£ä¼˜å…ˆçº§
interface GigabitEthernet1/0/1
 spanning-tree vlan 10 port-priority 64

! 4. é…ç½®PortFast (ä»…Accessç«¯å£)
interface range GigabitEthernet1/0/1-24
 spanning-tree portfast

! æˆ–å…¨å±€é…ç½®
spanning-tree portfast default

! 5. é…ç½®BPDU Guard (é˜²æ­¢ç¯è·¯)
interface range GigabitEthernet1/0/1-24
 spanning-tree bpduguard enable

! æˆ–å…¨å±€é…ç½®
spanning-tree portfast bpduguard default

! 6. é…ç½®Root Guard (ä¿æŠ¤æ ¹æ¡¥)
interface GigabitEthernet1/0/47
 spanning-tree guard root

! 7. é…ç½®Loop Guard
interface GigabitEthernet1/0/48
 spanning-tree guard loop

! 8. UplinkFast (åŠ é€Ÿæ”¶æ•›)
spanning-tree uplinkfast

! 9. BackboneFast
spanning-tree backbonefast

! 10. éªŒè¯é…ç½®
show spanning-tree
show spanning-tree summary
show spanning-tree vlan 10
show spanning-tree interface GigabitEthernet1/0/1
```

### MSTPé…ç½®

```cisco
! ========================================
! MSTP (Multiple Spanning Tree Protocol) é…ç½®
! ========================================

! 1. å¯ç”¨MSTP
spanning-tree mode mst

! 2. é…ç½®MSTå®ä¾‹
spanning-tree mst configuration
 name COMPANY
 revision 1
 instance 1 vlan 10-19
 instance 2 vlan 20-39
 instance 3 vlan 40-99
 exit

! 3. é…ç½®æ ¹æ¡¥
spanning-tree mst 0 priority 4096
spanning-tree mst 1 priority 4096
spanning-tree mst 2 priority 8192
spanning-tree mst 3 priority 8192

! 4. éªŒè¯é…ç½®
show spanning-tree mst configuration
show spanning-tree mst 0
```

### HPE/Arubaç”Ÿæˆæ ‘

```bash
# ========================================
# HPE Aruba MSTPé…ç½®
# ========================================

# å¯ç”¨MSTP
spanning-tree
spanning-tree mode mstp

# é…ç½®MSTå®ä¾‹
spanning-tree config-name "COMPANY"
spanning-tree config-revision 1
spanning-tree instance 1 vlan 10-19
spanning-tree instance 2 vlan 20-39

# é…ç½®æ ¹æ¡¥
spanning-tree instance 0 priority 4
spanning-tree instance 1 priority 4
spanning-tree instance 2 priority 8

# é…ç½®PortFast
interface 1/1-1/24
   spanning-tree admin-edge-port
   spanning-tree bpdu-protection
   exit

# éªŒè¯
show spanning-tree
show spanning-tree mst-config
```

---

## QoSé…ç½®

### åŸºç¡€QoSé…ç½®

```cisco
! ========================================
! Cisco QoSé…ç½®
! ========================================

! 1. å¯ç”¨QoS
mls qos

! 2. ä¿¡ä»»DSCP (æ¨è)
interface range GigabitEthernet1/0/1-48
 mls qos trust dscp

! 3. ä¿¡ä»»CoS
interface range GigabitEthernet1/0/1-24
 mls qos trust cos

! 4. é…ç½®é˜Ÿåˆ—
! é…ç½®é˜Ÿåˆ—æƒé‡ (WRR - Weighted Round Robin)
mls qos srr-queue output cos-map queue 1 threshold 3 4 5
mls qos srr-queue output cos-map queue 2 threshold 3 2 3
mls qos srr-queue output cos-map queue 3 threshold 3 0 1
mls qos srr-queue output cos-map queue 4 threshold 3 6 7

! é…ç½®é˜Ÿåˆ—å¸¦å®½
mls qos queue-set output 1 threshold 1 100 100 100 100
mls qos queue-set output 1 threshold 2 125 125 100 400
mls qos queue-set output 1 buffers 15 25 40 20

! 5. åˆ†ç±»å’Œæ ‡è®°
! åˆ›å»ºClass Map
class-map match-any VOICE
 match ip dscp ef
class-map match-any VIDEO
 match ip dscp af41 af42 af43
class-map match-any CRITICAL-DATA
 match ip dscp af31 af32 af33
class-map match-any BEST-EFFORT
 match ip dscp default

! åˆ›å»ºPolicy Map
policy-map QOS-POLICY
 class VOICE
  priority percent 30
 class VIDEO
  bandwidth percent 20
 class CRITICAL-DATA
  bandwidth percent 30
 class class-default
  bandwidth percent 20
  random-detect

! åº”ç”¨ç­–ç•¥
interface GigabitEthernet1/0/48
 service-policy output QOS-POLICY

! 6. æµé‡æ•´å½¢
policy-map SHAPE-10M
 class class-default
  shape average 10000000

interface GigabitEthernet1/0/10
 service-policy output SHAPE-10M

! 7. æµé‡ç›‘ç®¡
policy-map POLICE-50M
 class class-default
  police 50000000 conform-action transmit exceed-action drop

interface GigabitEthernet1/0/20
 service-policy input POLICE-50M
```

### å­˜å‚¨ç½‘ç»œQoS

```cisco
! ========================================
! iSCSI/NFSå­˜å‚¨ç½‘ç»œQoS
! ========================================

! 1. åˆ†ç±»å­˜å‚¨æµé‡
class-map match-any ISCSI-TRAFFIC
 match access-group name ISCSI-ACL

ip access-list extended ISCSI-ACL
 permit tcp any any eq 3260
 permit tcp any eq 3260 any

class-map match-any NFS-TRAFFIC
 match access-group name NFS-ACL

ip access-list extended NFS-ACL
 permit tcp any any eq 2049
 permit udp any any eq 2049

! 2. é…ç½®å­˜å‚¨ç­–ç•¥
policy-map STORAGE-QOS
 class ISCSI-TRAFFIC
  set ip dscp af41
  bandwidth percent 40
 class NFS-TRAFFIC
  set ip dscp af31
  bandwidth percent 30
 class class-default
  bandwidth percent 30

! 3. åº”ç”¨åˆ°å­˜å‚¨VLANæ¥å£
interface Vlan30
 service-policy input STORAGE-QOS
interface Vlan31
 service-policy input STORAGE-QOS
```

### Auto-QoSé…ç½®

```cisco
! ========================================
! Auto-QoS (è‡ªåŠ¨QoS)
! ========================================

! VoIPç”µè¯
interface GigabitEthernet1/0/10
 auto qos voip cisco-phone

! VoIPä¿¡ä»»
interface GigabitEthernet1/0/11
 auto qos voip trust

! è§†é¢‘
interface GigabitEthernet1/0/12
 auto qos video cts
 auto qos video ip-camera

! éªŒè¯
show auto qos
show mls qos
```

---

## ç«¯å£å®‰å…¨é…ç½®

### åŸºç¡€ç«¯å£å®‰å…¨

```cisco
! ========================================
! ç«¯å£å®‰å…¨é…ç½®
! ========================================

! 1. åŸºç¡€é…ç½®
interface GigabitEthernet1/0/1
 switchport mode access
 switchport port-security
 switchport port-security maximum 2
 switchport port-security violation restrict
 switchport port-security mac-address sticky

! 2. è¿è§„æ¨¡å¼
! shutdown: å…³é—­ç«¯å£ (é»˜è®¤)
interface GigabitEthernet1/0/2
 switchport port-security violation shutdown

! restrict: é™åˆ¶+è®°å½•
interface GigabitEthernet1/0/3
 switchport port-security violation restrict

! protect: ä»…é™åˆ¶
interface GigabitEthernet1/0/4
 switchport port-security violation protect

! 3. æ‰‹åŠ¨æŒ‡å®šMAC
interface GigabitEthernet1/0/5
 switchport port-security mac-address 0011.2233.4455

! 4. è€åŒ–æ—¶é—´
interface GigabitEthernet1/0/6
 switchport port-security aging time 60
 switchport port-security aging type inactivity

! 5. æ¢å¤err-disabledç«¯å£
errdisable recovery cause psecure-violation
errdisable recovery interval 300

! 6. æŸ¥çœ‹é…ç½®
show port-security
show port-security interface GigabitEthernet1/0/1
show port-security address
```

### DHCP Snooping

```cisco
! ========================================
! DHCP Snoopingé…ç½®
! ========================================

! 1. å…¨å±€å¯ç”¨
ip dhcp snooping
ip dhcp snooping vlan 10,100

! 2. é…ç½®ä¿¡ä»»ç«¯å£
interface GigabitEthernet1/0/48
 description Uplink-Trusted
 ip dhcp snooping trust

! 3. é…ç½®é€Ÿç‡é™åˆ¶
interface range GigabitEthernet1/0/1-24
 ip dhcp snooping limit rate 10

! 4. å¯ç”¨Option 82
ip dhcp snooping information option

! 5. ç»‘å®šæ•°æ®åº“
ip dhcp snooping database tftp://192.168.10.100/dhcp-snooping.db

! 6. éªŒè¯
show ip dhcp snooping
show ip dhcp snooping binding
```

### Dynamic ARP Inspection (DAI)

```cisco
! ========================================
! DAIé…ç½® (ä¾èµ–DHCP Snooping)
! ========================================

! 1. å¯ç”¨DAI
ip arp inspection vlan 10,100

! 2. é…ç½®ä¿¡ä»»ç«¯å£
interface GigabitEthernet1/0/48
 ip arp inspection trust

! 3. éªŒè¯æºMAC
ip arp inspection validate src-mac

! 4. éªŒè¯ç›®æ ‡MAC
ip arp inspection validate dst-mac

! 5. éªŒè¯IPåœ°å€
ip arp inspection validate ip

! 6. æ‰€æœ‰éªŒè¯
ip arp inspection validate src-mac dst-mac ip

! 7. é€Ÿç‡é™åˆ¶
interface range GigabitEthernet1/0/1-24
 ip arp inspection limit rate 15

! 8. é™æ€ARPç»‘å®š
arp access-list STATIC-ARP
 permit ip host 10.100.40.10 mac host 0011.2233.4455
 exit

ip arp inspection filter STATIC-ARP vlan 40

! 9. éªŒè¯
show ip arp inspection
show ip arp inspection statistics
```

### IP Source Guard

```cisco
! ========================================
! IP Source Guardé…ç½®
! ========================================

! 1. åŸºç¡€é…ç½® (ä»…IP)
interface GigabitEthernet1/0/1
 ip verify source

! 2. IP+MACéªŒè¯
interface GigabitEthernet1/0/2
 ip verify source port-security

! 3. é™æ€ç»‘å®š
ip source binding 0011.2233.4455 vlan 10 10.100.40.10 interface GigabitEthernet1/0/3

! 4. éªŒè¯
show ip verify source
show ip source binding
```

---

## é«˜å¯ç”¨é…ç½®

### å †å é…ç½® (Cisco StackWise)

```cisco
! ========================================
! Cisco StackWiseé…ç½®
! ========================================

! 1. æŸ¥çœ‹å †å çŠ¶æ€
show switch

! 2. é…ç½®äº¤æ¢æœºä¼˜å…ˆçº§
switch 1 priority 15
switch 2 priority 14
switch 3 priority 13

! 3. é‡æ–°ç¼–å·äº¤æ¢æœº
switch 2 renumber 3

! 4. é…ç½®å †å å¸¦å®½
! (ç¡¬ä»¶é…ç½®ï¼Œé€šè¿‡å †å çº¿ç¼†)

! 5. éªŒè¯
show switch stack-ports
show switch stack-ring speed
```

### VSSé…ç½® (Cisco Virtual Switching System)

```cisco
! ========================================
! VSSé…ç½® (éœ€è¦6500/4500ç³»åˆ—)
! ========================================

! Switch 1é…ç½®
switch virtual domain 100
 switch 1
 exit

interface Port-channel10
 switch virtual link 1
 no shutdown

interface range TenGigabitEthernet1/1-2
 channel-group 10 mode on
 no shutdown

switch convert mode virtual

! Switch 2é…ç½® (ç±»ä¼¼)
switch virtual domain 100
 switch 2
 exit

! éªŒè¯
show switch virtual
show switch virtual link
```

### VSFé…ç½® (HPE Aruba)

```bash
# ========================================
# HPE Aruba VSFé…ç½®
# ========================================

# é…ç½®VSFé“¾è·¯
vsf member 1
   link 1 1/49
   link 2 1/50
   priority 255
   exit

vsf member 2
   link 1 2/49
   link 2 2/50
   priority 254
   exit

# å¯ç”¨VSF
vsf enable domain 1

# éªŒè¯
show vsf
show vsf link
```

### CSSé…ç½® (åä¸º)

```huawei
# ========================================
# åä¸ºCSS (Cluster Switch System) é…ç½®
# ========================================

# é…ç½®CSS ID
css-mode enable
css css-id 1

# é…ç½®CSSä¼˜å…ˆçº§
css priority 200

# é…ç½®CSSé“¾è·¯
interface Stack-Port 1/1
 port interface XGigabitEthernet 1/0/49 enable
 port interface XGigabitEthernet 1/0/50 enable

# éªŒè¯
display css configuration
display css topology
```

---

## æ€§èƒ½ä¼˜åŒ–

### Jumbo Frameé…ç½®

```cisco
! ========================================
! Jumbo Frame (å·¨å‹å¸§) é…ç½®
! ========================================

! 1. å…¨å±€é…ç½®MTU (Cisco)
system mtu 9000
system mtu jumbo 9000

! 2. æ¥å£çº§MTU (L3æ¥å£)
interface GigabitEthernet1/0/1
 mtu 9000

! 3. éªŒè¯
show system mtu
show interfaces GigabitEthernet1/0/1 | include MTU

! æ³¨æ„ï¼šéœ€è¦é‡å¯äº¤æ¢æœºç”Ÿæ•ˆ
reload
```

```bash
# HPE Aruba
interface 1/1
   mtu 9198
   exit

# åä¸º
system-view
jumboframe enable 9000
interface GigabitEthernet1/0/1
 jumboframe enable 9000
```

### æµé‡ç›‘æ§ (NetFlow/sFlow)

```cisco
! ========================================
! NetFlowé…ç½®
! ========================================

! 1. é…ç½®NetFlowå¯¼å‡ºå™¨
flow exporter NETFLOW-EXPORT
 destination 192.168.10.100
 source Vlan10
 transport udp 9995
 export-protocol netflow-v9

! 2. é…ç½®Flow Monitor
flow monitor NETFLOW-MONITOR
 exporter NETFLOW-EXPORT
 record netflow ipv4 original-input
 cache timeout active 60

! 3. åº”ç”¨åˆ°æ¥å£
interface GigabitEthernet1/0/48
 ip flow monitor NETFLOW-MONITOR input
 ip flow monitor NETFLOW-MONITOR output

! 4. éªŒè¯
show flow monitor NETFLOW-MONITOR cache
show flow exporter NETFLOW-EXPORT statistics
```

```cisco
! ========================================
! sFlowé…ç½® (HPE/Aruba)
! ========================================

sflow 1 destination 192.168.10.100
sflow 1 sampling 512
sflow 1 polling 20

interface 1/48
   sflow 1
   exit

show sflow 1
```

### ç«¯å£é•œåƒ (SPAN)

```cisco
! ========================================
! SPAN (Switched Port Analyzer) é…ç½®
! ========================================

! 1. æœ¬åœ°SPAN
monitor session 1 source interface GigabitEthernet1/0/1 both
monitor session 1 destination interface GigabitEthernet1/0/48

! 2. å¤šæºç«¯å£
monitor session 2 source interface range GigabitEthernet1/0/1-10 rx
monitor session 2 destination interface GigabitEthernet1/0/48

! 3. VLAN SPAN
monitor session 3 source vlan 10 both
monitor session 3 destination interface GigabitEthernet1/0/48

! 4. RSPAN (è¿œç¨‹SPAN)
vlan 900
 name RSPAN-VLAN
 remote-span

monitor session 4 source interface GigabitEthernet1/0/1
monitor session 4 destination remote vlan 900

! åœ¨ç›®æ ‡äº¤æ¢æœº
monitor session 5 source remote vlan 900
monitor session 5 destination interface GigabitEthernet1/0/48

! 5. ERSPAN (å°è£…è¿œç¨‹SPAN)
monitor session 6 type erspan-source
 source interface GigabitEthernet1/0/1
 destination
  erspan-id 6
  ip address 192.168.20.100
  origin ip address 192.168.10.10

! 6. éªŒè¯
show monitor session 1
show monitor session all
```

### CPUä¿æŠ¤

```cisco
! ========================================
! CoPP (Control Plane Policing) é…ç½®
! ========================================

! 1. åˆ†ç±»æ§åˆ¶å¹³é¢æµé‡
class-map match-any ROUTING-PROTOCOLS
 match access-group name ROUTING-ACL
class-map match-any MANAGEMENT
 match access-group name MGMT-ACL

ip access-list extended ROUTING-ACL
 permit ospf any any
 permit tcp any any eq bgp
 permit tcp any eq bgp any

ip access-list extended MGMT-ACL
 permit tcp any any eq 22
 permit udp any any eq snmp

! 2. é…ç½®ç­–ç•¥
policy-map COPP-POLICY
 class ROUTING-PROTOCOLS
  police 8000000 conform-action transmit exceed-action drop
 class MANAGEMENT
  police 1000000 conform-action transmit exceed-action drop
 class class-default
  police 500000 conform-action transmit exceed-action drop

! 3. åº”ç”¨åˆ°æ§åˆ¶å¹³é¢
control-plane
 service-policy input COPP-POLICY

! 4. éªŒè¯
show policy-map control-plane
```

---

## ç›‘æ§ä¸ç®¡ç†

### SNMPé…ç½®è¯¦è§£

```cisco
! ========================================
! å®Œæ•´SNMPé…ç½®
! ========================================

! 1. SNMPv2cé…ç½®
snmp-server community public RO
snmp-server community private RW
snmp-server location "DC1-Rack-A-U10"
snmp-server contact "admin@example.com"
snmp-server chassis-id "Core-SW1"

! 2. SNMP Trapé…ç½®
snmp-server enable traps
snmp-server enable traps snmp authentication linkdown linkup coldstart warmstart
snmp-server enable traps port-security
snmp-server enable traps config
snmp-server enable traps hsrp
snmp-server enable traps vtp
snmp-server enable traps vlancreate
snmp-server enable traps vlandelete
snmp-server enable traps envmon fan shutdown supply temperature status
snmp-server enable traps cpu threshold
snmp-server enable traps memory bufferpeak

! 3. é…ç½®Trapæ¥æ”¶è€…
snmp-server host 192.168.10.100 version 2c public
snmp-server host 192.168.10.101 version 2c public

! 4. SNMPv3é…ç½® (æ¨è)
snmp-server group ADMIN-GROUP v3 priv
snmp-server user admin ADMIN-GROUP v3 auth sha AuthPass@2025 priv aes 128 PrivPass@2025
snmp-server host 192.168.10.100 version 3 priv admin

! 5. è®¿é—®æ§åˆ¶
snmp-server view ALL-VIEW internet included
snmp-server group READONLY v2c access ALL-VIEW

! 6. éªŒè¯
show snmp
show snmp community
show snmp user
show snmp group
```

### æ—¥å¿—é…ç½®

```cisco
! ========================================
! æ—¥å¿—é…ç½®
! ========================================

! 1. æ—¥å¿—ç¼“å†²åŒº
logging buffered 51200 informational

! 2. Consoleæ—¥å¿—
logging console warnings

! 3. SyslogæœåŠ¡å™¨
logging host 192.168.10.100
logging trap informational
logging source-interface Vlan10

! 4. æ—¶é—´æˆ³
service timestamps log datetime msec localtime show-timezone
service timestamps debug datetime msec

! 5. åºåˆ—å·
service sequence-numbers

! 6. æ—¥å¿—çº§åˆ«
! emergencies (0)
! alerts (1)
! critical (2)
! errors (3)
! warnings (4)
! notifications (5)
! informational (6)
! debugging (7)

! 7. æŸ¥çœ‹æ—¥å¿—
show logging
show logging | include ERROR
```

### é…ç½®å¤‡ä»½

```bash
#!/bin/bash
# ========================================
# äº¤æ¢æœºé…ç½®å¤‡ä»½è„šæœ¬
# ========================================

BACKUP_DIR="/backup/switches"
DATE=$(date +%Y%m%d_%H%M%S)
SWITCHES=(
    "192.168.10.10:Core-SW1"
    "192.168.10.11:Core-SW2"
    "192.168.10.20:Dist-SW1"
)

mkdir -p "$BACKUP_DIR/$DATE"

for SWITCH in "${SWITCHES[@]}"; do
    IP="${SWITCH%%:*}"
    NAME="${SWITCH##*:}"
    
    echo "å¤‡ä»½äº¤æ¢æœº: $NAME ($IP)"
    
    # Cisco (SSH)
    sshpass -p 'password' ssh admin@$IP "show running-config" \
        > "$BACKUP_DIR/$DATE/${NAME}_running-config.txt"
    
    sshpass -p 'password' ssh admin@$IP "show startup-config" \
        > "$BACKUP_DIR/$DATE/${NAME}_startup-config.txt"
    
    # æˆ–ä½¿ç”¨TFTP
    # sshpass -p 'password' ssh admin@$IP "copy running-config tftp://192.168.10.100/${NAME}_config"
done

# å‹ç¼©å¤‡ä»½
cd "$BACKUP_DIR"
tar czf "switch-backup-${DATE}.tar.gz" "$DATE"
rm -rf "$DATE"

# æ¸…ç†30å¤©å‰çš„å¤‡ä»½
find "$BACKUP_DIR" -name "switch-backup-*.tar.gz" -mtime +30 -delete

echo "å¤‡ä»½å®Œæˆ: $BACKUP_DIR/switch-backup-${DATE}.tar.gz"
```

---

## æ•…éšœæ’æŸ¥

```yaml
å¸¸è§é—®é¢˜ä¸è¯Šæ–­:
  é—®é¢˜1: ç«¯å£Down
    æ’æŸ¥æ­¥éª¤:
      1. show interface GigabitEthernet1/0/1
      2. show interface status
      3. show logging | include GigabitEthernet1/0/1
      4. show controllers
    
    å¯èƒ½åŸå› :
      - ç‰©ç†è¿æ¥é—®é¢˜
      - ç«¯å£shutdown
      - err-disabled
      - SFPæ¨¡å—æ•…éšœ
    
    è§£å†³:
      interface GigabitEthernet1/0/1
       shutdown
       no shutdown
      
      ! æ¸…é™¤err-disabled
      clear errdisable interface GigabitEthernet1/0/1
  
  é—®é¢˜2: VLANä¸é€š
    æ’æŸ¥æ­¥éª¤:
      1. show vlan brief
      2. show interfaces switchport
      3. show interfaces trunk
      4. show spanning-tree vlan 10
    
    å¯èƒ½åŸå› :
      - VLANæœªåˆ›å»º
      - Trunkæœªå…è®¸VLAN
      - Native VLANä¸åŒ¹é…
      - ç”Ÿæˆæ ‘é˜»å¡
    
    è§£å†³:
      vlan 10
      
      interface GigabitEthernet1/0/48
       switchport trunk allowed vlan add 10
  
  é—®é¢˜3: LACPä¸åå•†
    æ’æŸ¥æ­¥éª¤:
      1. show etherchannel summary
      2. show lacp neighbor
      3. show lacp internal
      4. show logging | include LACP
    
    å¯èƒ½åŸå› :
      - æ¨¡å¼ä¸åŒ¹é…
      - VLANé…ç½®ä¸åŒ
      - STPé…ç½®å†²çª
    
    è§£å†³:
      interface range GigabitEthernet1/0/47-48
       no channel-group 1
       channel-group 1 mode active
  
  é—®é¢˜4: ç”Ÿæˆæ ‘ç¯è·¯
    æ’æŸ¥æ­¥éª¤:
      1. show spanning-tree
      2. show spanning-tree blockedports
      3. show spanning-tree inconsistentports
      4. show logging | include LOOP
    
    å¯èƒ½åŸå› :
      - PortFastè¯¯ç”¨
      - BPDU Guardè§¦å‘
      - å¤šä¸ªæ ¹æ¡¥
    
    è§£å†³:
      spanning-tree vlan 10 priority 4096
      
      interface GigabitEthernet1/0/1
       spanning-tree portfast
       spanning-tree bpduguard enable
  
  é—®é¢˜5: æ€§èƒ½ä¸‹é™
    æ’æŸ¥æ­¥éª¤:
      1. show processes cpu sorted
      2. show processes memory sorted
      3. show interfaces counters errors
      4. show controllers utilization
    
    å¯èƒ½åŸå› :
      - CPUè¿‡è½½
      - å†…å­˜ä¸è¶³
      - é”™è¯¯åŒ…è¿‡å¤š
      - å¹¿æ’­é£æš´
    
    è§£å†³:
      ! æŸ¥æ‰¾é«˜æµé‡æ¥å£
      show interfaces counters rate
      
      ! é™åˆ¶å¹¿æ’­
      interface GigabitEthernet1/0/1
       storm-control broadcast level 10
       storm-control multicast level 10

è¯Šæ–­å‘½ä»¤:
  åŸºç¡€å‘½ä»¤:
    show version
    show running-config
    show startup-config
    show interfaces
    show interfaces status
    show interfaces counters
    show ip interface brief
    show vlan brief
    show spanning-tree
    show etherchannel summary
    show cdp neighbors detail
    show lldp neighbors detail
  
  é«˜çº§å‘½ä»¤:
    show tech-support
    show diagnostic result
    show environment all
    show power inline
    show mac address-table
    show arp
    show ip route
    show processes cpu history
    show logging
  
  è°ƒè¯•å‘½ä»¤ (è°¨æ…ä½¿ç”¨):
    debug spanning-tree events
    debug lacp event
    debug etherchannel
    
    ! å…³é—­è°ƒè¯•
    undebug all
```

---

## ç›¸å…³æ–‡æ¡£

- [ç½‘ç»œæ‹“æ‰‘ä¸VLANè§„åˆ’](01_ç½‘ç»œæ‹“æ‰‘ä¸VLANè§„åˆ’.md)
- [è´Ÿè½½å‡è¡¡ä¸é«˜å¯ç”¨](03_è´Ÿè½½å‡è¡¡ä¸é«˜å¯ç”¨.md)
- [ç½‘ç»œå®‰å…¨ç­–ç•¥](04_ç½‘ç»œå®‰å…¨ç­–ç•¥.md)
- [ç½‘ç»œç›‘æ§ä¸æ•…éšœæ’æŸ¥](05_ç½‘ç»œç›‘æ§ä¸æ•…éšœæ’æŸ¥.md)

---

**æ›´æ–°æ—¶é—´**: 2025-10-19  
**æ–‡æ¡£ç‰ˆæœ¬**: v3.0  
**çŠ¶æ€**: âœ… ç”Ÿäº§å°±ç»ª
