# 存储选型指南

> **返回**: [硬件规范目录](README.md) | [部署指南首页](../../00_索引导航/README.md)

---

## 📋 目录

- [存储选型指南](#存储选型指南)
  - [📋 目录](#-目录)
  - [存储类型对比](#存储类型对比)
    - [四大存储类型](#四大存储类型)
  - [RAID配置建议](#raid配置建议)
    - [RAID级别详解](#raid级别详解)
  - [按环境规模选型](#按环境规模选型)
    - [小型环境 (\<50VM)](#小型环境-50vm)
    - [中型环境 (50-200VM)](#中型环境-50-200vm)
    - [大型环境 (\>200VM)](#大型环境-200vm)
  - [存储控制器选型](#存储控制器选型)
    - [硬件RAID控制器](#硬件raid控制器)
  - [性能与成本平衡](#性能与成本平衡)
    - [ROI分析](#roi分析)
  - [注意事项](#注意事项)
    - [⚠️ 重要提示](#️-重要提示)
    - [📌 选型建议](#-选型建议)
  - [相关文档](#相关文档)

---

## 存储类型对比

### 四大存储类型

```yaml
HDD机械硬盘:
  性能:
    IOPS: 100-200
    延迟: 5-10ms
    顺序读写: 150-250 MB/s
  
  成本:
    价格: ¥0.3/GB
    4TB: ¥1,200
    8TB: ¥2,400
    12TB: ¥3,600
  
  可靠性:
    MTBF: 100-200万小时
    年故障率: 0.5-1%
  
  适用场景:
    ✅ 冷数据存储
    ✅ 归档备份
    ✅ 大容量需求
    ❌ 虚拟化主存储
  
  推荐品牌:
    - 西部数据 (WD Red/Gold)
    - 希捷 (IronWolf/Exos)
    - 东芝 (MG系列)
  
  推荐型号:
    WD Gold 12TB:
      转速: 7200 RPM
      缓存: 256MB
      接口: SATA 6Gb/s
      价格: ¥3,600
      质保: 5年

SATA SSD固态硬盘:
  性能:
    IOPS: 50K-100K
    延迟: 0.5-1ms
    顺序读写: 500-550 MB/s
  
  成本:
    价格: ¥1/GB
    480GB: ¥480
    960GB: ¥960
    1.92TB: ¥1,920
    3.84TB: ¥3,840
  
  可靠性:
    TBW: 300-600 TBW
    质保: 3-5年
  
  适用场景:
    ✅ 标准虚拟化
    ✅ 一般业务应用
    ✅ 成本敏感型
    ⚠️ 高并发场景需考虑NVMe
  
  推荐品牌:
    - 三星 (860/870 EVO/PRO)
    - 英睿达 (MX500)
    - 金士顿 (KC600)
  
  推荐型号:
    三星 870 EVO 1TB:
      接口: SATA 6Gb/s
      顺序读取: 560 MB/s
      顺序写入: 530 MB/s
      随机读取: 98K IOPS
      随机写入: 88K IOPS
      价格: ¥1,000
      质保: 5年
    
    三星 870 PRO 1TB:
      TBW: 600 TBW (更高耐久)
      价格: ¥1,400
      质保: 5年

NVMe SSD (消费级):
  性能:
    IOPS: 500K-1M
    延迟: 0.1-0.2ms
    顺序读写: 3,500-7,000 MB/s
  
  成本:
    价格: ¥2-3/GB
    1TB: ¥2,000-3,000
    2TB: ¥4,000-6,000
  
  可靠性:
    TBW: 600-1,200 TBW
    质保: 5年
  
  适用场景:
    ✅ 高性能虚拟化
    ✅ 数据库服务器
    ✅ 高并发应用
    ✅ 中小型环境
  
  推荐品牌:
    - 三星 (980 PRO, 990 PRO)
    - WD (Black SN850)
    - SK海力士 (P31)
  
  推荐型号:
    三星 980 PRO 2TB:
      接口: PCIe 4.0 x4
      顺序读取: 7,000 MB/s
      顺序写入: 5,100 MB/s
      随机读取: 1,000K IOPS
      随机写入: 1,000K IOPS
      TBW: 1,200 TBW
      价格: ¥2,800
      质保: 5年

企业级NVMe:
  性能:
    IOPS: 1M-2M+
    延迟: 0.05-0.1ms
    顺序读写: 6,000-7,500 MB/s
  
  成本:
    价格: ¥5-10/GB
    1.6TB: ¥8,000-16,000
    3.2TB: ¥16,000-32,000
    6.4TB: ¥32,000-64,000
  
  可靠性:
    DWPD: 3-10 (每天全盘写入次数)
    TBW: 10,000-30,000 TBW
    质保: 5年
  
  适用场景:
    ✅ 关键业务系统
    ✅ 超高性能需求
    ✅ 大型数据中心
    ✅ 7x24小时运行
  
  推荐品牌:
    - Intel (P5800X Optane, P5520)
    - Samsung (PM9A3, PM1733)
    - Micron (7450, 7400)
    - Kioxia (CM6)
  
  推荐型号:
    Intel P5800X 1.6TB (Optane):
      接口: PCIe 4.0 x4
      顺序读取: 7,200 MB/s
      随机读取: 1,500K IOPS
      随机写入: 550K IOPS
      延迟: 超低 (~7μs)
      DWPD: 60 (顶级耐久)
      价格: ¥35,000
      适用: 极致性能场景
    
    Samsung PM9A3 3.84TB:
      接口: PCIe 4.0 x4
      顺序读取: 6,900 MB/s
      随机读取: 1,000K IOPS
      DWPD: 1
      TBW: 7,000 TBW
      价格: ¥12,000
      适用: 标准企业级

存储类型性能对比表:
  | 类型 | IOPS | 延迟 | 顺序读写 | 价格/GB | 适用场景 |
  |------|------|------|----------|---------|----------|
  | HDD | 200 | 10ms | 200MB/s | ¥0.3 | 归档/冷数据 |
  | SATA SSD | 100K | 1ms | 550MB/s | ¥1 | 标准虚拟化 |
  | NVMe | 1M | 0.2ms | 7GB/s | ¥2-3 | 高性能 |
  | 企业NVMe | 2M | 0.05ms | 7GB/s | ¥5-10 | 关键业务 |
```

---

## RAID配置建议

### RAID级别详解

```yaml
RAID 0 (条带化):
  特点:
    数据分布: 条带化到多个磁盘
    冗余: 无
    最少磁盘: 2块
    容量利用率: 100%
    读性能: ★★★★★
    写性能: ★★★★★
    可靠性: ★ (任一磁盘故障全部数据丢失)
  
  适用场景:
    ⚠️ 临时数据
    ⚠️ 可重建数据
    ⚠️ 缓存层
    ❌ 不推荐用于重要数据
  
  计算示例:
    4x 1TB → 4TB可用 (100%)

RAID 1 (镜像):
  特点:
    数据分布: 完全镜像
    冗余: 100%镜像
    最少磁盘: 2块
    容量利用率: 50%
    读性能: ★★★★ (可并发读)
    写性能: ★★★ (需写两份)
    可靠性: ★★★★★ (1块盘可故障)
  
  适用场景:
    ✅ ESXi系统盘
    ✅ 虚拟机系统盘
    ✅ 关键配置数据
    ✅ 小容量高可靠需求
  
  计算示例:
    2x 1TB → 1TB可用 (50%)
  
  推荐配置:
    ESXi系统盘: 2x 480GB SATA SSD (RAID1)
    成本: ¥960
    可用: 480GB

RAID 5 (单校验条带):
  特点:
    数据分布: 条带化+分布式奇偶校验
    冗余: 1块磁盘容量
    最少磁盘: 3块
    容量利用率: (n-1)/n
    读性能: ★★★★
    写性能: ★★ (校验计算开销)
    可靠性: ★★★ (1块盘可故障)
    重建: 较慢，存在风险
  
  适用场景:
    ⚠️ 容量>性能的场景
    ⚠️ 低I/O需求
    ❌ 不推荐用于虚拟化主存储
    ❌ 不推荐用于SSD (写放大)
  
  计算示例:
    5x 4TB → 16TB可用 (80%)
  
  注意:
    ⚠️ 重建时性能严重下降
    ⚠️ 大容量盘重建时间长
    ⚠️ 重建期间第二块盘故障风险

RAID 6 (双校验条带):
  特点:
    数据分布: 条带化+双重分布式校验
    冗余: 2块磁盘容量
    最少磁盘: 4块
    容量利用率: (n-2)/n
    读性能: ★★★★
    写性能: ★★ (更多校验开销)
    可靠性: ★★★★ (2块盘可故障)
  
  适用场景:
    ✅ 大容量HDD阵列
    ✅ 归档存储
    ✅ 备份存储
    ✅ 8块盘以上的场景
  
  计算示例:
    8x 8TB → 48TB可用 (75%)
    12x 12TB → 120TB可用 (83%)
  
  推荐配置:
    冷数据存储: 8x 12TB HDD (RAID6)
    成本: ¥28,800
    可用: 72TB
    容错: 2块盘

RAID 10 (镜像条带):
  特点:
    数据分布: 先镜像再条带
    冗余: 50%
    最少磁盘: 4块
    容量利用率: 50%
    读性能: ★★★★★
    写性能: ★★★★
    可靠性: ★★★★★ (可容忍特定盘故障)
  
  适用场景:
    ✅ 虚拟化数据存储 (首选)
    ✅ 数据库存储
    ✅ 高性能+高可靠需求
    ✅ SSD/NVMe阵列
  
  计算示例:
    4x 2TB → 4TB可用 (50%)
    6x 4TB → 12TB可用 (50%)
    8x 4TB → 16TB可用 (50%)
  
  推荐配置:
    虚拟化主存储: 6x 2TB NVMe (RAID10)
    成本: ¥18,000
    可用: 6TB
    性能: 极高
    可靠性: 极高

RAID配置建议总结:
  ESXi系统盘:
    推荐: RAID 1
    配置: 2x 480GB SATA SSD
    理由: 可靠性最重要
  
  虚拟机主存储:
    推荐: RAID 10
    配置: 6-8x NVMe SSD
    理由: 性能+可靠性平衡
  
  大容量归档:
    推荐: RAID 6
    配置: 8-12x HDD
    理由: 容量+容错平衡
  
  高性能缓存:
    推荐: RAID 0 或 No-RAID
    配置: 2-4x NVMe
    理由: 极致性能，数据可恢复
```

---

## 按环境规模选型

### 小型环境 (<50VM)

```yaml
方案1: 经济型
  系统盘:
    配置: 2x 480GB SATA SSD (RAID1)
    品牌: 三星 870 EVO
    成本: ¥960
    可用: 480GB
  
  数据盘:
    配置: 4x 4TB SATA SSD (RAID10)
    品牌: 三星 870 EVO
    成本: ¥16,000
    可用: 8TB
  
  总容量: 8.5TB
  总成本: ¥16,960
  性能: 标准
  适用: 一般业务、成本敏感

方案2: 性能型
  系统盘:
    配置: 2x 960GB NVMe (RAID1)
    品牌: 三星 980 PRO
    成本: ¥2,800
    可用: 960GB
  
  数据盘:
    配置: 6x 2TB NVMe (RAID10)
    品牌: 三星 980 PRO
    成本: ¥16,800
    可用: 6TB
  
  总容量: 7TB
  总成本: ¥19,600
  性能: 高性能
  适用: 数据库、高性能应用

推荐选择: 方案2 (性能型)
  理由: 价格差异小，性能提升显著
```

### 中型环境 (50-200VM)

```yaml
方案1: 均衡型
  系统盘:
    配置: 2x 960GB NVMe (RAID1)
    品牌: 三星 980 PRO
    成本: ¥2,800
    可用: 960GB
  
  高性能存储:
    配置: 8x 4TB NVMe (RAID10)
    品牌: 三星 980 PRO
    成本: ¥89,600
    可用: 16TB
    用途: 热数据、数据库
  
  标准存储:
    配置: 4x 8TB SATA SSD (RAID10)
    品牌: 三星 870 QVO
    成本: ¥24,000
    可用: 16TB
    用途: 冷数据、归档
  
  总容量: 33TB
  总成本: ¥116,400
  性能: 分层存储

方案2: 全闪存
  系统盘:
    配置: 2x 2TB NVMe (RAID1)
    品牌: 三星 980 PRO
    成本: ¥5,600
    可用: 2TB
  
  数据盘:
    配置: 12x 8TB NVMe (RAID10)
    品牌: WD Black SN850
    成本: ¥230,400
    可用: 48TB
  
  总容量: 50TB
  总成本: ¥236,000
  性能: 极高性能

推荐选择: 方案1 (均衡型)
  理由: 成本合理，性能分层满足不同需求
```

### 大型环境 (>200VM)

```yaml
方案1: 企业级全闪存阵列
  品牌选择:
    Dell EMC PowerStore 500T:
      配置: 25x 7.68TB NVMe
      可用容量: 100TB+
      性能: 2M IOPS
      特性: 重删、压缩、自动分层
      价格: ¥1,200,000
    
    Pure Storage FlashArray//X70:
      配置: 全闪存
      可用容量: 150TB+
      性能: 2.5M IOPS
      特性: 常时重删压缩
      价格: ¥1,500,000
    
    NetApp AFF A400:
      配置: 24x NVMe
      可用容量: 100TB+
      性能: 1.5M IOPS
      特性: ONTAP数据管理
      价格: ¥1,000,000

方案2: 超融合存储 (vSAN)
  节点配置 (每节点):
    缓存层: 2x 1.6TB Intel P5800X (RAID1)
    容量层: 6x 3.84TB Samsung PM9A3 (RAID10)
  
  3节点集群:
    总缓存: 1.6TB × 3 = 4.8TB
    总容量: 11.52TB × 3 = 34.5TB
    成本: ¥360,000 (仅存储)
  
  6节点集群:
    总缓存: 9.6TB
    总容量: 69TB
    成本: ¥720,000

推荐选择: 根据预算和需求
  预算充足: 品牌全闪存阵列 (最佳性能和支持)
  灵活扩展: 超融合vSAN (软件定义，易扩展)
```

---

## 存储控制器选型

### 硬件RAID控制器

```yaml
入门级控制器:
  Broadcom MegaRAID 9361-8i:
    接口: PCIe 3.0 x8
    端口: 8个内部SATA/SAS
    缓存: 1GB DDR3 (带BBU)
    RAID: 0/1/5/6/10/50/60
    性能: 1.2GB/s
    价格: ¥2,500
    适用: SATA SSD阵列

中端控制器:
  Broadcom MegaRAID 9460-16i:
    接口: PCIe 3.1 x8
    端口: 16个内部SAS/SATA
    缓存: 4GB DDR4 (带FBWC)
    RAID: 0/1/5/6/10/50/60
    性能: 12Gb/s per port
    价格: ¥8,000
    适用: 混合阵列

高端控制器:
  Broadcom MegaRAID 9560-16i:
    接口: PCIe 4.0 x8
    端口: 16个SAS/SATA/NVMe
    缓存: 8GB DDR4
    RAID: 全系列
    性能: 24Gb/s per port
    价格: ¥15,000
    适用: NVMe阵列

NVMe专用:
  直通模式 (HBA):
    Broadcom 9500-16i:
      接口: PCIe 4.0 x8
      端口: 16个NVMe
      模式: 直通 (No-RAID)
      价格: ¥5,000
      适用: 软RAID或vSAN

RAID配置建议:
  SATA阵列: 硬件RAID (MegaRAID 9361)
  NVMe阵列: 
    - 方案1: 直通HBA + 软RAID (性能最佳)
    - 方案2: 高端RAID控制器 (易管理)
  
  vSAN环境: 必须使用直通HBA或Pass-through
```

---

## 性能与成本平衡

### ROI分析

```yaml
性能对比 (1000 IOPS环境):
  方案A: HDD阵列
    配置: 10x 4TB HDD (RAID10)
    可用容量: 20TB
    性能: 2,000 IOPS (勉强满足)
    成本: ¥12,000
    成本/TB: ¥600
  
  方案B: SATA SSD阵列
    配置: 4x 4TB SATA SSD (RAID10)
    可用容量: 8TB
    性能: 200,000 IOPS (远超需求)
    成本: ¥16,000
    成本/TB: ¥2,000
  
  方案C: NVMe SSD阵列
    配置: 4x 2TB NVMe (RAID10)
    可用容量: 4TB
    性能: 2,000,000 IOPS (极大超出)
    成本: ¥16,000
    成本/TB: ¥4,000

结论:
  如果只需1000 IOPS:
    ✅ 最佳选择: 方案B (SATA SSD)
    理由: 性能充足，容量适中，成本合理
  
  如果需要100K+ IOPS:
    ✅ 最佳选择: 方案C (NVMe)
    理由: 只有NVMe能满足需求

总成本拥有(TCO) 5年:
  HDD方案:
    硬件: ¥12,000
    电费: ¥3,000 (更高功耗)
    更换: ¥6,000 (故障率高)
    总计: ¥21,000
  
  SSD方案:
    硬件: ¥16,000
    电费: ¥500
    更换: ¥1,000
    总计: ¥17,500
  
  结论: SSD长期成本更低！
```

---

## 注意事项

### ⚠️ 重要提示

1. **虚拟化优先SSD**: HDD无法满足虚拟化IOPS需求
2. **NVMe是趋势**: 价格持续下降，性能卓越
3. **RAID10首选**: 虚拟化存储最佳选择
4. **预留空间**: 建议预留20-30%空间
5. **企业级优先**: 生产环境必须使用企业级SSD
6. **HCL兼容性**: 必须查询存储控制器和磁盘兼容性

### 📌 选型建议

✅ **性能优先**: 虚拟化对IOPS要求极高  
✅ **NVMe推荐**: 价格已接近SATA SSD  
✅ **RAID10标准**: 性能和可靠性最佳平衡  
✅ **企业级必备**: TBW和质保很重要  
✅ **控制器重要**: 缓存和BBU/FBWC必须有  

---

## 相关文档

- [CPU处理器选型](01_CPU处理器选型.md)
- [内存选型指南](02_内存选型.md)
- [完整硬件配置方案](05_完整硬件配置方案.md)
- [存储架构设计](../03_存储架构/)

---

**更新时间**: 2025-10-19  
**文档版本**: v3.0  
**状态**: ✅ 生产就绪
